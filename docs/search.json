[
  {
    "objectID": "modelGrowthInMass.html#get-data",
    "href": "modelGrowthInMass.html#get-data",
    "title": "13  Growth in mass",
    "section": "13.1 Get data",
    "text": "13.1 Get data\n\n13.1.1 Get electrofishing data\n\n\nCode\ncd <- tar_read(cdWB_electro_target) # raw data\ncd1 <- tar_read(cd1_target)\npropNegSRS <- tar_read(propNegSRS_target)\npropNegSRsN <- tar_read(propNegSRsN_target)\n\nindCountsBySpp <- tar_read(indCountsBySpp_target) \nindCounts <- tar_read(indCounts_target) \npropNegLabels <- tar_read(propNegLabels_target)\n\n\n\n\n13.1.2 Get environmental data\n\n\nCode\ndummy=0 # change to force cache update??\nenvIn <- tar_read(envIn_target)\nenvIn_propNeg <- tar_read(envIn_propNeg_target)"
  },
  {
    "objectID": "modelGrowthInMass.html#examine-raw-data",
    "href": "modelGrowthInMass.html#examine-raw-data",
    "title": "13  Growth in mass",
    "section": "13.2 Examine raw data",
    "text": "13.2 Examine raw data\n\n13.2.1 Limit data to consecutive sample captures (cd1)\nPrevious growth models with length used all possible observations for a fish and interpolated missing observations. Here, we are just looking at consecutive captures to estimate growth over just that interval.\n\n\nCode\n# table(as.numeric(cd$sampleNumber), as.numeric(cd$lagSampleNumber), cd$season, cd$year) |> \n#   data.frame() |> \n#   filter(Freq > 0) |> \n#   arrange(Var1, Var2) |> \n#   rename(firstCapt = Var1, secondCapt = Var2, season = Var3, year = Var4) |> \n#   filter(year == 2010)\n\n\n##### in targets\n# cd1 <- cd |> \n#   filter(sampleNumberDiff == 1,\n#          tag %notin% c('1bf20ff490', '1bf20ebe4e')) |> \n#   mutate(negGrowth = grWeight < 0,\n#          month = month(date),\n#          dummy = 1) # change to force cache update\n\n\n\n\n13.2.2 Find outlier growth rates\n\n13.2.2.1 Negative outlier growth\n1bf20ebe4e and 1bf20ff490 have incorrect weights leading to very negative growth rates.\nExclude these tags above. The rest of the quite negative growth fish seem plausible (remember we can’t account for stomach contents or egg loss).\n\n\nCode\ncd |> \n  arrange(grWeightS) |> \n  dplyr::select(tag, species, season, sampleNumber, lagSampleNumber, observedWeight, lagObservedWeight, grWeightS)\n\n\n# A tibble: 24,304 × 8\n   tag        species season sampleNumber lagSampleNu…¹ obser…² lagOb…³ grWeig…⁴\n   <chr>      <chr>    <dbl>        <dbl>         <dbl>   <dbl>   <dbl>    <dbl>\n 1 1bf20ebe4e bnt          3           55            56    46.5     4.3 -0.0320 \n 2 257c67e414 bkt          3           59            60     7.3     4.4 -0.00414\n 3 1bf0fec291 bkt          3           27            28     2.7     1.6 -0.00409\n 4 1bf20ff490 bnt          2           54            55   167.     41.8 -0.00378\n 5 257c67b532 bnt          3           63            64    34      25.5 -0.00371\n 6 00088d1ad4 bnt          3           63            64     4.5     3.6 -0.00330\n 7 257c67db60 bnt          3           63            64    24.2    19.5 -0.00317\n 8 00088d0b59 bnt          3           63            64     3.7     3   -0.00314\n 9 414b684955 ats          3           15            16     5.7     4.3 -0.00289\n10 0009f6ec56 bkt          3           75            76     3.5     2.7 -0.00288\n# … with 24,294 more rows, and abbreviated variable names ¹​lagSampleNumber,\n#   ²​observedWeight, ³​lagObservedWeight, ⁴​grWeightS\n\n\n\n\n13.2.2.2 Positive outlier growth\nLots of very fast growth mostly in the spring. No clear way to exclude fish.\n\n\nCode\ncd1 |> \n  arrange(desc(grWeightS)) |> \n  dplyr::select(tag, species, season, sampleNumber, lagSampleNumber, observedWeight, lagObservedWeight, grWeightS) |> \n  print(n = 20)\n\n\n# A tibble: 24,299 × 8\n   tag        species season sampleNumber lagSampleNum…¹ obser…² lagOb…³ grWei…⁴\n   <chr>      <chr>    <dbl>        <dbl>          <dbl>   <dbl>   <dbl>   <dbl>\n 1 1bf1020623 bkt          1           29             30     1.3    14.4  0.0199\n 2 0009f6eef4 bkt          1           77             78     2.3    10.3  0.0160\n 3 413f4b1845 ats          1           13             14     1.8     8.3  0.0152\n 4 1bf16366cf bnt          1           33             34     2      10.7  0.0142\n 5 410a015165 ats          1           13             14     2.1     9.3  0.0142\n 6 00088d2d2c bkt          1           73             74     1.8     9.2  0.0141\n 7 410a0f0653 ats          1           13             14     2.2    10.9  0.0138\n 8 1bf18b7637 bkt          1           33             34     2.5    13.2  0.0137\n 9 1bf20e4e30 bnt          1           53             54     2.3    12.1  0.0137\n10 1bf1930917 ats          1           37             38     1.9    11.7  0.0136\n11 411a356c36 ats          1           17             18     2       7.8  0.0136\n12 413d675356 ats          1           13             14     2.2    10.3  0.0134\n13 41096c506c ats          1           13             14     2.5    10.4  0.0133\n14 1bf18b7083 bkt          1           33             34     2.3    10.7  0.0133\n15 41097c2230 ats          1           13             14     2.4    11.6  0.0132\n16 1bf18b6cc8 ats          1           33             34     2.7    17    0.0132\n17 410a043a56 ats          1           13             14     2.6    13.2  0.0130\n18 4109740f1b ats          1           13             14     2.4    11.3  0.0130\n19 1bf17f0114 bkt          1           33             34     2.3    10.5  0.0130\n20 1bf18b8453 bkt          1           33             34     2.3    10.1  0.0129\n# … with 24,279 more rows, and abbreviated variable names ¹​lagSampleNumber,\n#   ²​observedWeight, ³​lagObservedWeight, ⁴​grWeightS\n\n\n\n\n\n13.2.3 Raw length, weight data graphs\n\n13.2.3.1 Distribution of growth rates\n\n\nCode\nggplot(cd1, aes(grWeight, color = speciesGG)) +\n  geom_freqpoly(bins = 50) +\n  labs(x = \"Growth in mass (/d)\", y = \"Frequency\") +\n  scale_color_discrete() +\n  facet_wrap(~season)\n\n\n\n\n\n\n\n\n13.2.4 Length vs weight by species\nVery few outliers\n\n\nCode\nplotLenW <- function(d, s){\n  ggplot(d |> filter(species == s), aes(observedLength, observedWeight)) +\n    geom_point(alpha = 0.5, size = 1) +\n    scale_x_log10() +\n    scale_y_log10() +\n    ggtitle(s) +\n    labs(x = \"Length (mm)\", y = \"Mass (mg)\") +\n    scale_color_discrete() +\n    facet_grid(riverGG~year, scales = 'free')\n}\n\nplotLenW(cd1, \"bkt\")\n\n\n\n\n\nCode\nplotLenW(cd1, \"bnt\")\n\n\n\n\n\nCode\nplotLenW(cd1, \"ats\")\n\n\n\n\n\n\n\n13.2.5 Weight vs weight at next sample\n\n\nCode\nplotWW <- function(d, s){\n  ggplot(d |> filter(species == s), aes(observedWeight, lagObservedWeight, color = seasonGG)) +\n    geom_point(alpha = 0.15) +\n    guides(color = guide_legend(override.aes = list(alpha = 1))) +\n    ggtitle(s) +\n    labs(y = \"mass (mg)\", y = \"Mass (mg) at next sample\") +\n    scale_color_discrete() +\n    facet_wrap(~riverGG, scales = 'free')\n}\n\nplotWW(cd1, \"bkt\")\n\n\n\n\n\nCode\nplotWW(cd1, \"bnt\")\n\n\n\n\n\nCode\nplotWW(cd1, \"ats\")"
  },
  {
    "objectID": "modelGrowthInMass.html#two-growth-models",
    "href": "modelGrowthInMass.html#two-growth-models",
    "title": "13  Growth in mass",
    "section": "13.3 Two growth models",
    "text": "13.3 Two growth models\n\n13.3.1 Size-adjusted growth model\n\n13.3.1.1 Get l-w relationships for size-adjusted growth model\nHere, we will explore size-independent growth in mass, see Sigourney, D. B., B H Letcher, M. Obedzinski, and R. A. Cunjak. “Size-Independent Growth in Fishes: Patterns, Models and Metrics.” Journal of Fish Biology 72, no. 10 (2008): 2435–55. https://doi.org/10.1111/j.1095-8649.2008.01830.x. Size-independent growth (grWeightS) is calculated in getDataElectro_targets.R file using addSizeIndGrowthWeight().\ngrWeightS uses the slope of log(observedWeight) ~ log(grWeight) for each river and season and species to adjust growth.\nA simple linear models shows we need to get separate slopes for each river and season and species.\n\n\nCode\nggplot(cd1 |> filter(grWeight > 0), \n       aes(log(observedWeight), log(grWeight), color = riverGG)) +\n  geom_point(alpha = 0.05)  +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(y = \"Log of mass (mg)\", x = \"Log of growth in mass\") +\n  scale_color_discrete() +\n  facet_grid(seasonGG~speciesGG)\n\n\n\n\n\nCode\nmod0 <- lm(log(grWeight) ~ log(observedWeight), data = cd1 |> filter(grWeight > 0))\nmod1 <- lm(log(grWeight) ~ log(observedWeight) * river, data = cd1 |> filter(grWeight > 0))\nmod2 <- lm(log(grWeight) ~ log(observedWeight) * river * factor(season), data = cd1 |> filter(grWeight > 0))\nmod3 <- lm(log(grWeight) ~ log(observedWeight) * factor(season), data = cd1 |> filter(grWeight > 0))\nmod4 <- lm(log(grWeight) ~ log(observedWeight) * river * factor(season) * species, data = cd1 |> filter(grWeight > 0))\n\nAIC(mod0,mod1,mod2,mod3,mod4) |> arrange(AIC)\n\n\n     df      AIC\nmod4 73 43939.97\nmod2 33 47554.54\nmod3  9 48050.71\nmod1  9 64666.62\nmod0  3 64751.39\n\n\n\n\n\n13.3.2 Compare size-adjusted and instantaneous growth\nDifferences don’t seem big enough to warrant the extra complexity from the s-adjusted growth metric\n\n\nCode\nggplot(cd1, aes(grWeight, grWeightS, color = riverGG)) +\n  geom_point(alpha = 0.05)  +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_abline(intercept = 0, slope = 1) +\n  labs(y = \"Gowth in mass\", x = \"Size-adjusted growth in mass\") +\n  scale_color_discrete() +\n  facet_grid(seasonGG~speciesGG)\n\n\n\n\n\nCode\nggplot(cd1 |> \n         dplyr::select(observedWeight, grWeight, grWeightS, seasonGG, speciesGG) |> \n         pivot_longer(cols = c(grWeight, grWeightS)),\n       \n       aes(log(observedWeight), value, color = name)) +\n  geom_point(alpha = 0.05 )  +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  labs(y = \"Log of mass (mg)\", x = \"Growth in mass\") +\n  scale_color_discrete() +\n  facet_grid(seasonGG~speciesGG)"
  },
  {
    "objectID": "modelGrowthInMass.html#compare-growth-in-length-and-mass",
    "href": "modelGrowthInMass.html#compare-growth-in-length-and-mass",
    "title": "13  Growth in mass",
    "section": "13.4 Compare growth in length and mass",
    "text": "13.4 Compare growth in length and mass\n\n13.4.1 Growth rate in length vs size-independent growth rate in mass\n\n\nCode\nggplot(cd1, aes(grLength, grWeightS)) +\n  geom_point(aes(size = observedWeight), alpha = 0.02) +\n  guides(size = guide_legend(override.aes = list(alpha = 1))) +\n  labs(x = \"Growth in length\", y = \"Size-adjusted growth in mass\") +\n  scale_color_discrete() +\n  facet_grid(seasonGG~speciesGG)\n\n\n\n\n\n\n\n13.4.2 Growth rate in length vs ‘instantaneous’ growth rate in mass\n\n\nCode\nggplot(cd1, aes(grLength, grWeight)) +\n  geom_point(aes(size = observedWeight), alpha = 0.02) +\n  guides(size = guide_legend(override.aes = list(alpha = 1))) +\n  labs(x = \"Growth in length\", y = \"Growth in mass\") +\n  scale_color_discrete() +\n  facet_grid(seasonGG~speciesGG)\n\n\n\n\n\nCode\nggplot(cd1 |> filter(species==\"bnt\", season ==2), aes(grLength, grWeight, color = factor(year))) +\n  geom_point( alpha = 1) +\n  geom_smooth(method=\"lm\", se=FALSE) +\n  guides(size = guide_legend(override.aes = list(alpha = 1))) +\n  labs(x = \"Growth in length\", y = \"Growth in mass\") +\n  scale_color_discrete() \n\n\n\n\n\nCode\n#  facet_wrap(~year)"
  },
  {
    "objectID": "modelGrowthInMass.html#flow-and-temperature-growth-models",
    "href": "modelGrowthInMass.html#flow-and-temperature-growth-models",
    "title": "13  Growth in mass",
    "section": "13.5 Flow and temperature growth models",
    "text": "13.5 Flow and temperature growth models\n\n13.5.1 Mean flow effect on growth?\nMaybe in Jimmy for bnt, or for ats\n\n\nCode\nplotFlowGR <- function(d, r){\nggplot(d |> filter(river == r), aes(meanFlowByRiver, grWeight, color = speciesGG)) +\n  geom_point(alpha = 0.05)  +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  geom_smooth(se = FALSE) +\n  geom_smooth(method = \"lm\", se =FALSE, formula = y~poly(x,2)) +\n  labs(x = \"Mean flow\", y = \"Growth in mass\") +\n  scale_color_discrete() +\n  ggtitle(r) +\n  facet_grid(seasonGG~speciesGG)#, scales = 'free')\n}\n\nplotFlowGR(cd1, \"west brook\")\n\n\n\n\n\nCode\nplotFlowGR(cd1, \"wb jimmy\")\n\n\n\n\n\nCode\nplotFlowGR(cd1, \"wb mitchell\")\n\n\n\n\n\nCode\nplotFlowGR(cd1, \"wb obear\")\n\n\n\n\n\n\n\n13.5.2 Mean temperature effect on growth?\nMaybe in Jimmy for bnt, or for ats\n\n\nCode\nplotTempGR <- function(d, s){\n  ggplot(d |> filter(seasonGG == s), aes(meanTemperature, grWeight, color = speciesGG)) +\n    geom_point(alpha = 0.5)  +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    geom_smooth(se = FALSE) +\n    geom_smooth(method = \"lm\", se =FALSE, formula = y~poly(x,2)) +\n    labs(x = \"Mean temperature (c)\", y = \"Growth in mass\") +\n    scale_color_discrete() +\n    ggtitle(s) +\n    facet_grid(speciesGG~riverGG)#, scales = 'free')\n}\n\nplotTempGR(cd1, \"Spring\")\n\n\n\n\n\nCode\nplotTempGR(cd1, \"Summer\")\n\n\n\n\n\nCode\nplotTempGR(cd1, \"Autumn\")\n\n\n\n\n\nCode\nplotTempGR(cd1, \"Winter\")"
  },
  {
    "objectID": "modelGrowthInMass.html#negative-vs-positive-growth",
    "href": "modelGrowthInMass.html#negative-vs-positive-growth",
    "title": "13  Growth in mass",
    "section": "13.6 Negative vs positive growth",
    "text": "13.6 Negative vs positive growth\n\n13.6.1 Proportion of fish with negative growth by species/river/season\n\n\nCode\nggplot(cd1 |> filter(!is.na(negGrowth)), aes(negGrowth)) +\n  geom_bar() +\n  facet_grid(seasonGG~speciesGG+riverGG, scales = \"free\")\n\n\n\n\n\nCode\nggplot(propNegSRS |> filter(n > 50), aes(seasonGG, propNeg, color = riverGG, group = riverGG)) +\n  geom_point(aes(size = n)) +\n  geom_line() +\n  labs(x = \"Season\", y = \"Proportion of fish with negative growth in mass\") +\n  scale_color_discrete() +\n  facet_wrap(~speciesGG)\n\n\n\n\n\n\n\n13.6.2 Proportion of fish with negative growth by species/river/sampleNumber\nBreak down season by year\n\n\nCode\nggplot(propNegSRsN |> filter(n > 10), aes(year, propNeg, color = riverGG)) +\n  geom_point(aes(size = n)) +\n  geom_line() +\n  labs(x = \"Year\", y = \"Proportion of fish with negative growth in mass\") +\n  scale_color_discrete() +\n  facet_grid(seasonGG~speciesGG)"
  },
  {
    "objectID": "modelGrowthInMass.html#environmental-effects-on-proportion-of-fish-with-negative-growth",
    "href": "modelGrowthInMass.html#environmental-effects-on-proportion-of-fish-with-negative-growth",
    "title": "13  Growth in mass",
    "section": "13.7 Environmental effects on proportion of fish with negative growth",
    "text": "13.7 Environmental effects on proportion of fish with negative growth\n\n13.7.1 Proportion of fish with negative growth by flow\n\n\nCode\nggplot(propNegSRsN |> filter(n > 10, riverGG == \"West Brook\"), aes(mF, propNeg, color = riverGG)) +\n  geom_point(aes(size = n)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  scale_y_continuous(\"Proportion of fish with negative growth in mass\") +\n  scale_x_log10(\"Mean flow\") +\n  scale_color_discrete() +\n  ggtitle(\"West Brook\") +\n  facet_grid(seasonGG~speciesGG)\n\n\n\n\n\nCode\nggplot(propNegSRsN |> filter(n > 10, riverGG != \"West Brook\"), aes(mF, propNeg, color = riverGG)) +\n  geom_point(aes(size = n)) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  scale_y_continuous(\"Proportion of fish with negative growth in mass\") +\n  scale_x_log10(\"Mean flow\") +\n  scale_color_discrete() +\n  ggtitle(\"Tributaries\") +\n  facet_grid(seasonGG~speciesGG)\n\n\n\n\n\n\n\n13.7.2 Proportion of fish with negative growth by temperature\n\n\nCode\nplotNegGrowth_temp <- function(d, s){\n  ggplot(d |> filter(n > 10, seasonGG == s), aes(mT, propNeg, color = riverGG)) +\n    geom_point(aes(size = n)) +\n    geom_smooth(method = \"lm\", se = FALSE) +\n    scale_y_continuous(\"Proportion of fish with negative growth in mass\") +\n    scale_x_continuous(\"Mean temperature (C)\") +\n    scale_color_discrete() +\n    ggtitle(s) +\n    facet_grid(riverGG~speciesGG)\n}\nplotNegGrowth_temp(propNegSRsN, \"Spring\")\n\n\n\n\n\nCode\nplotNegGrowth_temp(propNegSRsN, \"Summer\")\n\n\n\n\n\nCode\nplotNegGrowth_temp(propNegSRsN, \"Autumn\")\n\n\n\n\n\nCode\nplotNegGrowth_temp(propNegSRsN, \"Winter\")\n\n\n\n\n\n\n\n13.7.3 F/T cycle graphs\n\n13.7.3.1 Mean flow and temperature\n\n\nCode\nplot_mT_mF <- function(s, plotText){\n  ggplot(propNegSRsN |> filter(n > 25, speciesGG == s), aes(mT, mF_log10, color = factor(seasonGG))) +\n    geom_point(aes(size = propNeg)) +\n    {if(plotText) geom_text(aes(label = year), vjust = 0, nudge_y = -0.075, check_overlap = FALSE, size = 3)} +\n    ggtitle(s) +\n    labs(x = \"Mean temperature (C)\", y = \"log10 of mean Flow\") +\n    scale_color_discrete() +\n    facet_wrap(~riverGG, scales = \"free\")\n}\n\nplot_mT_mF(\"Brook trout\", FALSE)\n\n\n\n\n\nCode\nplot_mT_mF(\"Brown trout\", FALSE)\n\n\n\n\n\nCode\nplot_mT_mF(\"Atlantic salmon\", FALSE)\n\n\n\n\n\n\n\n13.7.3.2 Mean flow and temperature with year labels\n\n\nCode\nplot_mT_mF(\"Brook trout\", TRUE)\n\n\n\n\n\nCode\nplot_mT_mF(\"Brown trout\", TRUE)\n\n\n\n\n\nCode\nplot_mT_mF(\"Atlantic salmon\", TRUE)\n\n\n\n\n\nMean flow and temperature values for each season and year for the West Brook\nNot very informative\n\n\nCode\nggplot(propNegSRsN |> filter(n > 10, riverGG == 'West Brook') |> arrange(riverGG, speciesGG, year, seasonGG), aes(mT, mF_log10)) +\n  geom_line() +\n  geom_point(aes(color = factor(seasonGG))) +\n  facet_wrap(~year)\n\n\n\n\n\nYearly temperature/flow cycles of daily data\n\n\nCode\nplotMerged <- function(d, r, minYear = 2000, maxYear = 2017){\n  ggplot(d |> filter(riverGG == r, year %in% c(minYear:maxYear)), \n         aes(temperature, log10(flowByRiverm3s), color = seasonGG, group = seasonGG)) +\n    geom_point() +\n    geom_smooth(se = FALSE) +\n    #geom_line() +\n    labs(x = \"Temperature (C)\", y = \"log10 of Flow\") +\n    scale_color_discrete() +\n    ggtitle(r) +\n    facet_wrap(~year, scales = 'free')\n}\n# this plots f/t for all three species - good for filling in gaps\nplotMerged(envIn_propNeg, \"West Brook\", 2000, 2017)\n\n\n\n\n\nCode\nplotMerged(envIn_propNeg, \"Open Large\", 2002, 2017)\n\n\n\n\n\nCode\nplotMerged(envIn_propNeg, \"Open Small\", 2002, 2017)\n\n\n\n\n\nCode\nplotMerged(envIn_propNeg, \"Isolated Small\", 2002, 2017)\n\n\n\n\n\nSmooths of temperature/flow cycles of daily data by season\n\n\nCode\nplotMergedBySeason <- function(d, r, minYear = 2000, maxYear = 2017) {\n  ggplot(d |> filter(riverGG == r, year %in% c(minYear:maxYear), !is.na(seasonGG)), \n         aes(temperature, log10(flowByRiverm3s), \n             color = factor(year), group = year\n             )\n         ) +\n    #geom_point() +\n    geom_smooth(se = FALSE) +\n    labs(x = \"Temperature (C)\", y = \"log10 of Flow\") +\n    scale_color_discrete() +\n    ggtitle(r) +\n    facet_wrap(~seasonGG, scales = 'free')\n}\n\nplotMergedBySeason(envIn_propNeg, \"West Brook\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeason(envIn_propNeg, \"Open Large\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeason(envIn_propNeg, \"Open Small\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeason(envIn_propNeg, \"Isolated Small\", 2002, 2017)\n\n\n\n\n\nSmooths of temperature/flow cycles of daily data by season with line width = proportion of negative growth\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nPlot F/T cycles by river, season, species with label for propNeg and conspecific and all-species abundances\n\n\nCode\nplotMergedBySeasonByEverything <- function(d, d2, r, s, spp, minYear = 2000, maxYear = 2017){\n  ggplot(d |> \n           filter(riverGG == r,\n                  year %in% c(minYear:maxYear), \n                  !is.na(seasonGG), \n                  seasonGG == s, \n                  speciesGG == spp), \n         aes(temperature, log10(flowByRiverm3s))\n         ) +\n    geom_smooth(se = FALSE, color = \"darkgrey\") +\n    geom_point(aes(color = yday)) +\n    geom_text(aes(\n      x = minTemp + 3.0, \n      y = log10(minFlow) - 1, \n      label = paste(\"propNeg=\",round(propNeg, 2)) \n      #size = propNeg\n      ), \n        data = d2|> \n          filter(riverGG == r, \n                 year %in% c(minYear:maxYear),\n                 seasonGG == s, \n                 speciesGG == spp)\n        ) +\n    geom_text(aes(\n      x = minTemp + 3.0,\n      y = log10(minFlow) - 0.3,\n      label = paste(paste(\"nIndAllSpp=\", nInd), paste(\"nIndBySpp=\", nIndBySpp), sep = \"\\n\")\n      ),\n        data = d2|>\n          filter(riverGG == r,\n                 year %in% c(minYear:maxYear),\n                 seasonGG == s,\n                 speciesGG == spp)\n        ) +\n    labs(x = \"Temperature (c)\", y = \"log10 Flow\") +\n    ggtitle(paste(r, s, spp, sep = \", \")) +\n  facet_wrap(~year)\n}\n\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Spring\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Summer\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Autumn\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Winter\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Spring\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Summer\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Autumn\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Winter\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Spring\", \"Atlantic salmon\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Summer\", \"Atlantic salmon\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Autumn\", \"Atlantic salmon\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"West Brook\", \"Winter\", \"Atlantic salmon\", 2002, 2017)\n\n\n\n\n\nCode\n# Open large\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Large\", \"Spring\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Large\", \"Summer\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Large\", \"Autumn\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Large\", \"Winter\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Large\", \"Spring\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Large\", \"Summer\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Large\", \"Autumn\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Large\", \"Winter\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\n# Open small\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Small\", \"Spring\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Small\", \"Summer\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Small\", \"Autumn\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Small\", \"Winter\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Small\", \"Spring\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Small\", \"Summer\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Small\", \"Autumn\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Open Small\", \"Winter\", \"Brown trout\", 2002, 2017)\n\n\n\n\n\nCode\n# Isolated small\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Isolated Small\", \"Spring\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Isolated Small\", \"Summer\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Isolated Small\", \"Autumn\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\nCode\nplotMergedBySeasonByEverything(envIn_propNeg, propNegLabels, \"Isolated Small\", \"Winter\", \"Brook trout\", 2000, 2017)\n\n\n\n\n\n\n\nCode\nggplot(propNegSRsN |> filter(n > 10, riverGG==\"West Brook\", speciesGG == \"Brook trout\"), \n       aes(year, propNeg, color = factor(seasonGG))) +\n  geom_point(aes(size = n)) +\n  geom_line() +\n  ggtitle(\"West brook\") +\n  labs(x = \"Year\", y = \"Proportion of fish with negative growth in mass\") +\n  scale_color_discrete() \n\n\n\n\n\nCode\n  #facet_wrap(~season)"
  },
  {
    "objectID": "modelGrowthInMass.html#logistic-models-for-environmental-effects-on-propneg",
    "href": "modelGrowthInMass.html#logistic-models-for-environmental-effects-on-propneg",
    "title": "13  Growth in mass",
    "section": "13.8 Logistic models for environmental effects on propNeg",
    "text": "13.8 Logistic models for environmental effects on propNeg\n\n13.8.1 Standardize flow and temperature\n\n\nCode\n# getZ <- function(d){\n#   list(\n#     mean = mean(d, na.rm = TRUE),\n#     sd = sd(d, na.rm = TRUE)\n#   )\n# }\n# fZ <- getZ(cd1$meanFlowByRiver)\n# fT <- getZ(cd1$meanTemperature)\n\nz <- cd1 |> \n  group_by(season) |> \n  summarize(fZMean = mean(meanFlowByRiver, na.rm = TRUE),\n            fZSd = sd(meanFlowByRiver, na.rm = TRUE),\n            fTMean = mean(meanTemperature, na.rm = TRUE),\n            fTSd = sd(meanTemperature, na.rm = TRUE)\n            )\n\ncd1 <- cd1 |> \n  left_join(z) |> \n  mutate(meanFlowByRiverZ = (meanFlowByRiver - fZMean)/fZSd,\n         meanTempZ = (meanTemperature - fTMean)/fTSd)\n\n\n\n\n13.8.2 Raw data with logistic fit for flow effect\n\n\nCode\nggplot(cd1 |> filter(!is.na(negGrowth)), aes(meanFlowByRiverZ, negGrowth * 1, color = river)) +\n  geom_point(alpha = 0.1) +\n  geom_smooth(method = \"glm\", \n              method.args = list(family = \"binomial\"),\n              se = FALSE) +\n  labs(y = \"Probability of negative growth in mass\", x = \"Mean flow\") +\n  facet_grid(season~species)\n\n\n\n\n\nCode\nggplot(cd1 |> filter(!is.na(negGrowth)), aes(meanFlowByRiverZ, negGrowth * 1, color = river)) +\n  geom_point(alpha = 0.1) +\n  geom_smooth(method = \"glm\", \n              method.args = list(family = \"binomial\"),\n              se = FALSE) +\n  labs(y = \"Probability of negative growth in mass\", x = \"Mean flow\") +\n  facet_grid(season~species+river)\n\n\n\n\n\n\n\n13.8.3 Raw data with logistic fit for temperature effect\n\n\nCode\nggplot(cd1 |> filter(!is.na(negGrowth), meanTempZ > -4), aes(meanTempZ, negGrowth * 1, color = river)) +\n  geom_point(alpha = 0.1) +\n  geom_smooth(method = \"glm\", \n              method.args = list(family = \"binomial\"),\n              se = FALSE) +\n  labs(y = \"Probability of negative growth in mass\", x = \"Mean temperature\") +\n  facet_grid(season~species)"
  },
  {
    "objectID": "modelGrowthInMass.html#logistic-model-for-flow-and-temperature-one-species-at-a-time",
    "href": "modelGrowthInMass.html#logistic-model-for-flow-and-temperature-one-species-at-a-time",
    "title": "13  Growth in mass",
    "section": "13.9 Logistic model for flow and temperature, one species at a time",
    "text": "13.9 Logistic model for flow and temperature, one species at a time\nSpecies occupy different rivers, so an all-species model will have unequal river representation across species and don’t need to predict where species are not.\nNeed to think through whether these models make sense…\n\n\nCode\nrunSppModels <- function(d, speciesIn) {\n  models =\n    tibble(model = \n      c(\n          'negGrowth ~ meanFlowByRiverZ * meanTempZ * river',\n          'negGrowth ~ meanFlowByRiverZ * meanTempZ + river',\n          'negGrowth ~ meanFlowByRiverZ + meanTempZ + river', \n          \n          'negGrowth ~ meanFlowByRiverZ * meanTempZ' , \n          \n          'negGrowth ~ meanFlowByRiverZ * meanTempZ * river * factor(season)',\n          \n          'negGrowth ~ meanFlowByRiverZ + meanTempZ * river * factor(season)', \n          \n          'negGrowth ~ meanFlowByRiverZ * meanTempZ * river * factor(season) * observedWeight' \n        )\n    ) |>\n    mutate(\n      fit = map(model, ~glm(.x, family = \"binomial\", data = d |> filter(species == speciesIn))),\n      glanced = map(fit, broom::glance),\n      tidied = map(fit, broom::tidy)\n    )\n  return(models)\n}\n\n\n\n13.9.1 Predict p(neg growth in mass)\n\n\nCode\npredictSpp <- function(dIn, modIn, speciesIn){\n  d <- dIn |> filter(species == speciesIn)\n  \n  byAIC = modIn |> \n    unnest(glanced) |>\n    arrange(AIC) |>\n    dplyr::select(model, AIC, df.residual, fit, tidied)\n  \n  predDSpp <- expand.grid(\n    meanFlowByRiverZ = seq(-1.5,1.5,0.25), \n    meanTempZ = seq(-1.5,1.5,0.25), \n    river = unique(d$river), \n    season = unique(d$season),\n    observedWeight = seq(min(d$observedWeight, na.rm = TRUE), max(d$observedWeight, na.rm = TRUE), 40)\n    )\n  \n  \n  pred <- add_column(predDSpp, \n                        pred = predict.glm(byAIC[1,]$fit[[1]], predDSpp, type = \"response\")) |> \n             mutate(groupT = paste(river, season, meanTempZ, sep = \"_\"),\n                    groupF = paste(river, season, meanFlowByRiverZ, sep = \"_\"))\n  return(\n    list(\n      pred = pred,\n      byAIC = byAIC\n      )\n  )\n}   \n\n\n\n\n13.9.2 Brook trout\n\n\nCode\nspeciesIn <- \"bkt\"\nmodBKT <- runSppModels(cd1, speciesIn)\npredBKT <- predictSpp(cd1, modBKT, speciesIn)\n\n\nggplot(predBKT$pred |> filter(meanTempZ %in% c(-1.5,0,1.5), meanFlowByRiverZ %in% c(-1.5,0,1.5)), aes(observedWeight, pred, group = groupF)) +\n  geom_line(aes(color = factor(meanFlowByRiverZ))) +\n  labs(y = \"Probability of negative growth in mass\", x = \"Body mass (mg)\") +\n  facet_grid(season~river+meanTempZ)\n\n\n\n\n\n\n\n13.9.3 Brown trout\n\n\nCode\nspeciesIn <- \"bnt\"\n\nmodBNT <- runSppModels(cd1, speciesIn)\npredBNT <- predictSpp(cd1, modBNT, speciesIn)\n\n\nggplot(predBNT$pred |> filter(meanTempZ %in% c(-1.5,0,1.5), meanFlowByRiverZ %in% c(-1.5,0,1.5)), aes(observedWeight, pred, group = groupF)) +\n  geom_line(aes(color = factor(meanFlowByRiverZ))) +\n  labs(y = \"Probability of negative growth in mass\", x = \"Body mass (mg)\") +\n  facet_grid(season~river+meanTempZ)\n\n\n\n\n\n\n\n13.9.4 Atlantic salmon\n\n\nCode\nspeciesIn <- \"ats\"\n\nmodATS <- runSppModels(cd1, speciesIn)\npredATS <- predictSpp(cd1, modATS, speciesIn)\n\n\nggplot(predATS$pred |> filter(meanTempZ %in% c(-1.5,0,1.5), meanFlowByRiverZ %in% c(-1.5,0,1.5)), aes(observedWeight, pred, group = groupF)) +\n  geom_line(aes(color = factor(meanFlowByRiverZ))) +\n  labs(y = \"Probability of negative growth in mass\", x = \"Body mass (mg)\") +\n  facet_grid(season~river+meanTempZ)\n\n\n\n\n\n\n\n13.9.5 Pairs plots"
  },
  {
    "objectID": "modelGrowthInMass.html#deprecated-logistic-models-below",
    "href": "modelGrowthInMass.html#deprecated-logistic-models-below",
    "title": "13  Growth in mass",
    "section": "13.10 Deprecated logistic models below",
    "text": "13.10 Deprecated logistic models below"
  },
  {
    "objectID": "modelGrowthInMass.html#logistic-model-for-flow-and-temperature-all-species",
    "href": "modelGrowthInMass.html#logistic-model-for-flow-and-temperature-all-species",
    "title": "13  Growth in mass",
    "section": "13.11 Logistic model for flow and temperature, all species",
    "text": "13.11 Logistic model for flow and temperature, all species\n\n13.11.1 Model selection\n\n\nCode\nmodSpecies <- c(\"bkt\", \"ats\", \"bnt\")\ncd1Mod <- cd1 |> filter(species == modSpecies)\n\nmodFT0 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ * river * species, family = \"binomial\", data = cd1Mod)\nmodFT1 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ * river + species, family = \"binomial\", data = cd1Mod)\nmodFT2 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ + river + species, family = \"binomial\", data = cd1Mod)\nmodFT3 <- glm(negGrowth ~ meanFlowByRiverZ + meanTempZ + river + species, family = \"binomial\", data = cd1Mod)\nmodFT4 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ + river , family = \"binomial\", data = cd1Mod)\nmodFT5 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ + river , family = \"binomial\", data = cd1Mod)\nmodFT6 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ + species , family = \"binomial\", data = cd1Mod)\nmodFT7 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ, family = \"binomial\", data = cd1Mod)\n\n\nmodFT8 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ * river * factor(season) + species, family = \"binomial\", data = cd1Mod)\nmodFT9 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ * river * factor(season) * species, family = \"binomial\", data = cd1Mod)\nmodFT10 <- glm(negGrowth ~ meanFlowByRiverZ + meanTempZ * river * factor(season) * species, family = \"binomial\", data = cd1Mod)\n\nmodFT11 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ * river * factor(season) * observedWeight + species, family = \"binomial\", data = cd1Mod)\nmodFT12 <- glm(negGrowth ~ meanFlowByRiverZ * meanTempZ * river * factor(season) * species * observedWeight, family = \"binomial\", data = cd1Mod)\n\nAIC(modFT0, modFT1,modFT2, modFT3,modFT4,modFT5, modFT6,modFT7,modFT8,modFT9,modFT10, modFT11, modFT12) |> arrange(AIC)\n\n\n         df        AIC\nmodFT11 130   4781.318\nmodFT8   66   5176.029\nmodFT1   18   6294.744\nmodFT0   36   6312.866\nmodFT2    9   6353.926\nmodFT3    8   6377.385\nmodFT6    6   6432.862\nmodFT4    7   6564.863\nmodFT5    7   6564.863\nmodFT7    4   6726.100\nmodFT9  137  96366.380\nmodFT12 261 107571.651\nmodFT10  71 122906.683\n\n\n\n\n13.11.2 Model results for additive model (not very good)\n\n\nCode\n# https://www.statology.org/logistic-regression-in-r/\n#summary(modFT3)\n#anova(modFT3)\n\npscl::pR2(modFT3)[\"McFadden\"]\n\n\nfitting null model for pseudo-r2\n\n\n  McFadden \n0.06199948 \n\n\nCode\ncaret::varImp(modFT3) |> arrange(desc(Overall))\n\n\n                   Overall\nspeciesbnt       12.320525\nmeanFlowByRiverZ 11.658760\nriverwest brook   4.533210\nspeciesbkt        4.525811\nriverwb mitchell  3.541149\nriverwb obear     2.704749\nmeanTempZ         1.012669\n\n\n\n\n13.11.3 Model results for full interactive model (best model)\n\n\nCode\n# https://www.statology.org/logistic-regression-in-r/\n#summary(modFT11)\n#anova(modFT11)\n\n# full interaction\npscl::pR2(modFT11)[\"McFadden\"]\n\n\nfitting null model for pseudo-r2\n\n\n McFadden \n0.3333216 \n\n\nCode\ncaret::varImp(modFT11) |> arrange(desc(Overall))\n\n\n                                                                                Overall\nspeciesbnt                                                                 1.673957e+01\nspeciesbkt                                                                 8.650975e+00\nmeanFlowByRiverZ:riverwest brook:factor(season)2                           4.750209e-04\nmeanFlowByRiverZ:riverwest brook                                           4.706313e-04\nmeanFlowByRiverZ:riverwest brook:factor(season)3                           4.676677e-04\nmeanFlowByRiverZ:meanTempZ:riverwest brook:factor(season)3                 4.516393e-04\nmeanFlowByRiverZ:riverwest brook:factor(season)4                           4.509459e-04\nmeanFlowByRiverZ:meanTempZ:riverwest brook                                 4.439340e-04\nmeanFlowByRiverZ:meanTempZ:riverwest brook:factor(season)2                 4.273879e-04\nmeanFlowByRiverZ:meanTempZ:riverwest brook:factor(season)4                 4.142384e-04\nriverwest brook:factor(season)2                                            3.861528e-04\nriverwest brook                                                            3.811834e-04\nriverwest brook:factor(season)3                                            3.801010e-04\nriverwest brook:factor(season)4                                            3.622467e-04\nmeanFlowByRiverZ:riverwest brook:factor(season)4:observedWeight            3.275304e-04\nmeanFlowByRiverZ:riverwest brook:factor(season)2:observedWeight            3.083556e-04\nmeanFlowByRiverZ:riverwest brook:observedWeight                            2.981952e-04\nmeanFlowByRiverZ:riverwest brook:factor(season)3:observedWeight            2.975035e-04\nriverwest brook:factor(season)4:observedWeight                             2.585127e-04\nmeanFlowByRiverZ:meanTempZ:riverwest brook:factor(season)2:observedWeight  2.542765e-04\nmeanFlowByRiverZ:meanTempZ:riverwest brook:factor(season)3:observedWeight  2.449268e-04\nmeanFlowByRiverZ:meanTempZ:riverwest brook:observedWeight                  2.444246e-04\nriverwest brook:factor(season)2:observedWeight                             2.424675e-04\nmeanFlowByRiverZ:meanTempZ:riverwest brook:factor(season)4:observedWeight  2.414528e-04\nriverwest brook:observedWeight                                             2.348804e-04\nriverwest brook:factor(season)3:observedWeight                             2.334828e-04\nmeanTempZ:riverwest brook:factor(season)3                                  1.509604e-04\nmeanTempZ:riverwest brook                                                  1.485534e-04\nmeanTempZ:riverwest brook:factor(season)2                                  1.374863e-04\nmeanFlowByRiverZ:riverwb obear:factor(season)4:observedWeight              1.347300e-04\nmeanTempZ:riverwest brook:factor(season)4                                  1.293147e-04\nriverwb obear:factor(season)4:observedWeight                               1.127629e-04\nmeanTempZ:riverwest brook:factor(season)2:observedWeight                   1.022263e-04\nmeanTempZ:riverwest brook:factor(season)3:observedWeight                   9.664372e-05\nmeanTempZ:riverwest brook:observedWeight                                   9.583989e-05\nmeanTempZ:riverwest brook:factor(season)4:observedWeight                   9.294538e-05\nfactor(season)4                                                            5.811218e-05\nmeanFlowByRiverZ:meanTempZ:riverwb mitchell:factor(season)2                4.942564e-05\nfactor(season)3                                                            4.411080e-05\nfactor(season)2                                                            3.966873e-05\nmeanTempZ:riverwb mitchell:factor(season)2                                 3.846244e-05\nmeanFlowByRiverZ:meanTempZ:riverwb obear:factor(season)2                   3.534602e-05\nmeanFlowByRiverZ:riverwb obear:factor(season)2                             3.069680e-05\nmeanTempZ:riverwb obear:factor(season)2                                    2.904493e-05\nmeanFlowByRiverZ:riverwb mitchell:factor(season)2                          2.712741e-05\nmeanFlowByRiverZ:meanTempZ:riverwb obear:factor(season)2:observedWeight    2.688942e-05\nriverwb obear:factor(season)2                                              2.598764e-05\nmeanFlowByRiverZ:factor(season)4:observedWeight                            2.560344e-05\nmeanFlowByRiverZ:meanTempZ:riverwb obear:factor(season)4                   2.450004e-05\nmeanTempZ:riverwb obear:factor(season)2:observedWeight                     2.185656e-05\nriverwb mitchell:factor(season)2                                           2.025643e-05\nmeanFlowByRiverZ:factor(season)4                                           2.016113e-05\nmeanTempZ:riverwb obear:factor(season)4                                    1.931245e-05\nmeanFlowByRiverZ:meanTempZ:riverwb mitchell:factor(season)4                1.842168e-05\nmeanFlowByRiverZ:meanTempZ:factor(season)4                                 1.815922e-05\nmeanFlowByRiverZ:riverwb mitchell:factor(season)2:observedWeight           1.701214e-05\nfactor(season)4:observedWeight                                             1.614829e-05\nmeanTempZ:riverwb mitchell:factor(season)4                                 1.528836e-05\nmeanFlowByRiverZ:riverwb obear:factor(season)4                             1.308437e-05\nmeanFlowByRiverZ:meanTempZ:riverwb mitchell:factor(season)2:observedWeight 1.277844e-05\nriverwb mitchell:factor(season)2:observedWeight                            1.263924e-05\nmeanFlowByRiverZ:meanTempZ:factor(season)2                                 1.239016e-05\nriverwb obear:factor(season)4                                              1.193553e-05\nmeanFlowByRiverZ:riverwb obear:factor(season)2:observedWeight              1.166995e-05\nmeanFlowByRiverZ:meanTempZ:riverwb mitchell:factor(season)3:observedWeight 1.076012e-05\nmeanTempZ:factor(season)4                                                  1.030240e-05\nmeanTempZ:riverwb mitchell:factor(season)3:observedWeight                  9.603197e-06\nmeanFlowByRiverZ:meanTempZ:riverwb mitchell:factor(season)3                9.276399e-06\nriverwb obear:factor(season)2:observedWeight                               9.214154e-06\nmeanFlowByRiverZ:meanTempZ:factor(season)3                                 9.149945e-06\nmeanFlowByRiverZ:riverwb mitchell:factor(season)4                          8.923302e-06\nmeanTempZ:factor(season)2                                                  8.855183e-06\nmeanTempZ:riverwb mitchell:factor(season)2:observedWeight                  8.781201e-06\nmeanTempZ:riverwb mitchell:factor(season)3                                 8.677518e-06\nmeanFlowByRiverZ:factor(season)2                                           8.267091e-06\nmeanFlowByRiverZ:meanTempZ:riverwb obear:factor(season)4:observedWeight    8.179262e-06\nmeanFlowByRiverZ:riverwb obear:factor(season)3                             7.965424e-06\nfactor(season)3:observedWeight                                             7.264917e-06\nmeanFlowByRiverZ:meanTempZ:riverwb mitchell                                7.169858e-06\nmeanTempZ:riverwb mitchell                                                 7.098904e-06\nmeanTempZ:factor(season)4:observedWeight                                   7.042696e-06\nmeanFlowByRiverZ:meanTempZ:riverwb obear:factor(season)3:observedWeight    6.899535e-06\nmeanTempZ:factor(season)3                                                  6.858889e-06\nmeanFlowByRiverZ:meanTempZ:factor(season)2:observedWeight                  6.840304e-06\nmeanTempZ:riverwb mitchell:factor(season)4:observedWeight                  6.452451e-06\nmeanTempZ:riverwb mitchell:observedWeight                                  6.446486e-06\nmeanFlowByRiverZ:meanTempZ:riverwb mitchell:observedWeight                 6.403117e-06\nmeanFlowByRiverZ:factor(season)3:observedWeight                            6.366233e-06\nriverwb obear:factor(season)3                                              6.303099e-06\nmeanFlowByRiverZ:meanTempZ:riverwb obear:factor(season)3                   6.170406e-06\nmeanFlowByRiverZ:meanTempZ:riverwb mitchell:factor(season)4:observedWeight 6.164839e-06\nmeanFlowByRiverZ:meanTempZ:factor(season)4:observedWeight                  5.536261e-06\nmeanTempZ:riverwb obear:factor(season)3:observedWeight                     5.475057e-06\nmeanFlowByRiverZ:factor(season)2:observedWeight                            5.184155e-06\nmeanFlowByRiverZ:observedWeight                                            5.153746e-06\nriverwb mitchell:observedWeight                                            5.029894e-06\nmeanFlowByRiverZ:riverwb mitchell:observedWeight                           4.904199e-06\nmeanTempZ:riverwb obear:factor(season)3                                    4.836748e-06\nobservedWeight                                                             4.742662e-06\nriverwb mitchell                                                           4.734585e-06\nmeanFlowByRiverZ:riverwb mitchell                                          4.662791e-06\nriverwb mitchell:factor(season)4:observedWeight                            4.479157e-06\nriverwb mitchell:factor(season)4                                           3.855573e-06\nmeanFlowByRiverZ:meanTempZ                                                 3.853198e-06\nmeanTempZ:factor(season)2:observedWeight                                   3.825444e-06\nmeanTempZ                                                                  3.527527e-06\nmeanFlowByRiverZ:riverwb mitchell:factor(season)4:observedWeight           3.457951e-06\nriverwb mitchell:factor(season)3:observedWeight                            3.415030e-06\nmeanTempZ:riverwb obear:factor(season)4:observedWeight                     3.244786e-06\nmeanFlowByRiverZ:riverwb mitchell:factor(season)3                          3.236770e-06\nmeanTempZ:observedWeight                                                   3.065670e-06\nmeanTempZ:factor(season)3:observedWeight                                   2.850841e-06\nmeanFlowByRiverZ:meanTempZ:observedWeight                                  2.466296e-06\nmeanFlowByRiverZ:meanTempZ:factor(season)3:observedWeight                  2.217918e-06\nmeanFlowByRiverZ                                                           1.953296e-06\nmeanFlowByRiverZ:riverwb mitchell:factor(season)3:observedWeight           1.948282e-06\nfactor(season)2:observedWeight                                             1.812569e-06\nmeanFlowByRiverZ:riverwb obear:observedWeight                              1.420795e-06\nriverwb obear:observedWeight                                               1.274026e-06\nmeanFlowByRiverZ:factor(season)3                                           1.163685e-06\nmeanFlowByRiverZ:meanTempZ:riverwb obear                                   1.150821e-06\nmeanTempZ:riverwb obear                                                    9.753423e-07\nmeanTempZ:riverwb obear:observedWeight                                     6.401919e-07\nriverwb obear                                                              6.289383e-07\nmeanFlowByRiverZ:riverwb obear                                             5.791225e-07\nmeanFlowByRiverZ:meanTempZ:riverwb obear:observedWeight                    5.562427e-07\nriverwb obear:factor(season)3:observedWeight                               4.946289e-07\nriverwb mitchell:factor(season)3                                           2.349372e-07\nmeanFlowByRiverZ:riverwb obear:factor(season)3:observedWeight              1.471642e-07\n\n\n\n\n13.11.4 Precict p(neg growth in mass)\n\n\nCode\npredD <- expand.grid(\n  meanFlowByRiverZ = seq(-1.5,1.5,0.25), \n  meanTempZ = seq(-1.5,1.5,0.25), \n  river = unique(cd1$river), \n  species = unique(cd1$species), \n  season = unique(cd1$season),\n  observedWeight = seq(min(cd1$observedWeight, na.rm = TRUE), max(cd1$observedWeight, na.rm = TRUE), 40)\n  )\n\n\npred <- add_column(predD, \n                   pred = predict.glm(modFT11, predD, type = \"response\")) |> \n        mutate(groupT = paste(river, species, season, meanTempZ, sep = \"_\"),\n               groupF = paste(river, species, season, meanFlowByRiverZ, sep = \"_\"))\n\n\n\n\n13.11.5 Plot predictions\n\n\nCode\nggplot(pred |> filter(meanTempZ %in% c(-1.5,0,1.5), observedWeight == 161.3), aes(meanFlowByRiverZ, pred, group= groupT)) +\n  geom_line(aes(color = factor(meanTempZ))) +\n  labs(y = \"Probability of negative growth in mass\", x = \"Mean flow\") +\n  facet_grid(season~species+river)"
  }
]