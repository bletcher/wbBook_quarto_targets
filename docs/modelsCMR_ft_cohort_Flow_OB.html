<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The West Brook story - 12&nbsp; Flow effects on survival (phi) models with cohort structure - O’Bear only</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./modelsCMR_Flow_4Rivers.html" rel="next">
<link href="./modelsCMR_ft_Flow_OB.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models with cohort structure - O’Bear only</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The West Brook story</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vizTargets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Visualize targets</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Get data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getData.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Get data info</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataEnv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Get environmental data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataElectro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Get electrofishing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataCMR.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Create Capture-Recapture data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataWanding.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Get wanding data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataAntenna.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Get antenna data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">All data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataAll.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">All data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">General models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelYOY.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Young-of-year size model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelFlow.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Flow model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Capture-recpature models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelsCMR_ft_Flow_OB.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - O’Bear only</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelsCMR_ft_cohort_Flow_OB.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models with cohort structure - O’Bear only</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelsCMR_Flow_4Rivers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - 4 rivers</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#model-phit_pt-flow-tt_ob_flow" id="toc-model-phit_pt-flow-tt_ob_flow" class="nav-link active" data-scroll-target="#model-phit_pt-flow-tt_ob_flow"><span class="toc-section-number">12.0.1</span>  Model phiT_pT flow (tt_OB_flow)</a></li>
  <li><a href="#model-phit_pt-flow-byriver-tt_ob_flowbyriver" id="toc-model-phit_pt-flow-byriver-tt_ob_flowbyriver" class="nav-link" data-scroll-target="#model-phit_pt-flow-byriver-tt_ob_flowbyriver"><span class="toc-section-number">12.0.2</span>  Model phiT_pT flow ByRiver (tt_OB_flowByRiver)</a></li>
  <li><a href="#survival-comparison" id="toc-survival-comparison" class="nav-link" data-scroll-target="#survival-comparison"><span class="toc-section-number">12.0.3</span>  Survival comparison</a></li>
  <li><a href="#flow_yoyseason-predictions" id="toc-flow_yoyseason-predictions" class="nav-link" data-scroll-target="#flow_yoyseason-predictions"><span class="toc-section-number">12.0.4</span>  Flow_YOYSeason predictions</a></li>
  <li><a href="#flow_yoyseasoncohort-predictions" id="toc-flow_yoyseasoncohort-predictions" class="nav-link" data-scroll-target="#flow_yoyseasoncohort-predictions"><span class="toc-section-number">12.0.5</span>  Flow_YOYSeasonCohort predictions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models with cohort structure - O’Bear only</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Phi model structure:<br>
logit(phi[t,i]) &lt;-<br>
betaInt[ isYOY[i,t],season[t],cohort[i]] +<br>
betaFlow[1,isYOY[i,t],season[t]] * flow[i,t] +<br>
betaFlow[2,isYOY[i,t],season[t]] * temp[i,t] +<br>
betaFlow[3,isYOY[i,t],season[t]] * temp[i,t] * flow[i,t]</p>
<p>logit(p[t,i]) &lt;- betaP[isYOY[i,t],season[t-1],cohort[i]]</p>
<p>The goal of this modelling exercise is to evaluate the effect of new tributary-specific stream flow estimates on survival of brook trout and brown trout. We will compare survival across the WB and tributaries with flow input data as 1) single flow estimate for all locations (historical approach) and 2) hindcasted flows for each tributary based on new tributary-specific flows which are available since 2000.</p>
<p>The goal is to find the best structure for the survival model, then compare survival estimates with tributary-specific flow to estimates with common flow across locations.</p>
<p>Structure options include [species, cohort, season, isYOY, flow, flow^2]</p>
<div class="cell">

</div>
<section id="model-phit_pt-flow-tt_ob_flow" class="level3" data-number="12.0.1">
<h3 data-number="12.0.1" class="anchored" data-anchor-id="model-phit_pt-flow-tt_ob_flow"><span class="header-section-number">12.0.1</span> Model phiT_pT flow (tt_OB_flow)</h3>
<p>Cohort-dependent estimates of phi and p with flow and temperature hierarchical effects</p>
<section id="retrieve-model-results" class="level4" data-number="12.0.1.1">
<h4 data-number="12.0.1.1" class="anchored" data-anchor-id="retrieve-model-results"><span class="header-section-number">12.0.1.1</span> Retrieve model results</h4>
<p>Model is run using targets in R/modelCMR_tt_ft_cohort_OB.R</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following https://oliviergimenez.github.io/bayesian-cr-workshop/worksheets/4_demo.html</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  out_flow <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(tt_modelOut_ft_cohort_OB_flow )</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCplot</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc, <span class="at">round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"var"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         var   mean    sd   2.5%    50% 97.5% Rhat n.eff
1     betaIntYOYSeason[1, 1]  0.804 0.394  0.065  0.798 1.619 1.00   900
2     betaIntYOYSeason[2, 1] -0.381 0.447 -1.257 -0.399 0.521 1.02   661
3     betaIntYOYSeason[1, 2]  1.413 1.139 -0.867  1.405 3.646 1.00  4000
4     betaIntYOYSeason[2, 2] -0.031 0.307 -0.638 -0.037 0.566 1.00  2559
5     betaIntYOYSeason[1, 3]  1.789 0.426  1.036  1.761 2.694 1.01   471
6     betaIntYOYSeason[2, 3]  1.014 0.343  0.338  1.010 1.693 1.00  1323
7     betaIntYOYSeason[1, 4]  2.442 0.529  1.531  2.398 3.615 1.01   329
8     betaIntYOYSeason[2, 4]  1.561 0.500  0.717  1.516 2.690 1.04   400
9  betaIntYOYSeasonOut[1, 1]  0.685 0.082  0.516  0.690 0.835 1.00   932
10 betaIntYOYSeasonOut[2, 1]  0.410 0.104  0.221  0.402 0.627 1.01   704
11 betaIntYOYSeasonOut[1, 2]  0.757 0.181  0.296  0.803 0.975 1.00  3699
12 betaIntYOYSeasonOut[2, 2]  0.492 0.075  0.346  0.491 0.638 1.00  2559
13 betaIntYOYSeasonOut[1, 3]  0.849 0.052  0.738  0.853 0.937 1.01   522
14 betaIntYOYSeasonOut[2, 3]  0.729 0.066  0.584  0.733 0.845 1.00  1319
15 betaIntYOYSeasonOut[1, 4]  0.912 0.039  0.822  0.917 0.974 1.02   421
16 betaIntYOYSeasonOut[2, 4]  0.816 0.068  0.672  0.820 0.936 1.02   497
   flowData
1      flow
2      flow
3      flow
4      flow
5      flow
6      flow
7      flow
8      flow
9      flow
10     flow
11     flow
12     flow
13     flow
14     flow
15     flow
16     flow</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] var      mean     sd       2.5%     50%      97.5%    Rhat     n.eff   
[9] flowData
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlow"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 var   mean    sd   2.5%    50%  97.5% Rhat n.eff flowData
1  betaFlow[1, 1, 1]  0.234 0.506 -0.806  0.249  1.189 1.00   422     flow
2  betaFlow[2, 1, 1] -1.321 0.381 -2.033 -1.332 -0.559 1.00   173     flow
3  betaFlow[3, 1, 1] -5.163 0.784 -6.710 -5.155 -3.633 1.01   268     flow
4  betaFlow[1, 2, 1] -1.031 0.284 -1.587 -1.025 -0.470 1.00   601     flow
5  betaFlow[2, 2, 1] -2.129 0.372 -2.859 -2.132 -1.402 1.00   422     flow
6  betaFlow[3, 2, 1] -2.803 0.495 -3.784 -2.782 -1.899 1.01   411     flow
7  betaFlow[1, 1, 2]  0.177 1.138 -2.061  0.179  2.440 1.00  2572     flow
8  betaFlow[2, 1, 2] -0.527 1.164 -2.789 -0.534  1.789 1.00  3347     flow
9  betaFlow[3, 1, 2] -2.028 1.155 -4.230 -2.006  0.249 1.00  2042     flow
10 betaFlow[1, 2, 2] -0.318 0.103 -0.517 -0.318 -0.115 1.00   805     flow
11 betaFlow[2, 2, 2] -0.857 0.150 -1.146 -0.856 -0.562 1.01   535     flow
12 betaFlow[3, 2, 2] -0.153 0.165 -0.493 -0.151  0.157 1.01   719     flow
13 betaFlow[1, 1, 3]  0.647 0.458 -0.156  0.605  1.646 1.10   220     flow
14 betaFlow[2, 1, 3] -0.305 0.425 -1.299 -0.276  0.415 1.00   387     flow
15 betaFlow[3, 1, 3] -0.956 0.519 -2.129 -0.886 -0.104 1.04   327     flow
16 betaFlow[1, 2, 3]  1.701 0.320  1.046  1.709  2.312 1.04   176     flow
17 betaFlow[2, 2, 3] -0.348 0.181 -0.693 -0.346  0.010 1.01   579     flow
18 betaFlow[3, 2, 3] -2.124 0.380 -2.817 -2.135 -1.317 1.02   244     flow
19 betaFlow[1, 1, 4] -0.289 0.421 -1.088 -0.305  0.592 1.04   283     flow
20 betaFlow[2, 1, 4] -0.167 0.484 -1.113 -0.178  0.818 1.02   277     flow
21 betaFlow[3, 1, 4] -0.811 0.400 -1.661 -0.798 -0.059 1.00   291     flow
22 betaFlow[1, 2, 4] -0.373 0.322 -1.018 -0.372  0.254 1.02   487     flow
23 betaFlow[2, 2, 4]  0.390 0.471 -0.590  0.410  1.318 1.04   185     flow
24 betaFlow[3, 2, 4] -1.248 0.384 -2.005 -1.245 -0.483 1.02   208     flow
25    betaFlowTop[1]  0.076 0.633 -1.144  0.076  1.317 1.00  3304     flow
26    betaFlowTop[2] -0.408 0.634 -1.676 -0.406  0.819 1.00  3722     flow
27    betaFlowTop[3] -1.186 0.639 -2.449 -1.189  0.046 1.00  3403     flow
28 betaFlowYOY[1, 1]  0.168 0.570 -0.939  0.148  1.298 1.01  1328     flow
29 betaFlowYOY[2, 1] -0.530 0.566 -1.637 -0.532  0.584 1.00  1402     flow
30 betaFlowYOY[3, 1] -2.020 0.607 -3.193 -2.016 -0.846 1.01   684     flow
31 betaFlowYOY[1, 2]  0.011 0.485 -0.916  0.009  0.953 1.00  3179     flow
32 betaFlowYOY[2, 2] -0.678 0.490 -1.643 -0.669  0.262 1.00  2204     flow
33 betaFlowYOY[3, 2] -1.498 0.497 -2.446 -1.505 -0.524 1.00  2381     flow</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          var   mean    sd   2.5%    50%  97.5% Rhat n.eff
1            betaInt[1, 1, 1]  1.233 0.503  0.331  1.201  2.313 1.00   520
2            betaInt[2, 1, 1] -0.608 0.521 -1.601 -0.626  0.438 1.01   538
3            betaInt[1, 2, 1]  1.396 1.525 -1.520  1.381  4.399 1.00  4139
4            betaInt[2, 2, 1] -0.534 0.342 -1.156 -0.550  0.225 1.00   563
5            betaInt[1, 3, 1]  1.899 0.977  0.082  1.866  3.916 1.00   930
6            betaInt[2, 3, 1] -1.420 0.651 -2.561 -1.459 -0.062 1.01  1118
7            betaInt[1, 4, 1]  2.705 0.963  1.085  2.629  4.761 1.01  1231
8            betaInt[2, 4, 1]  1.309 0.648  0.422  1.155  2.989 1.04   267
9            betaInt[1, 1, 2] -1.485 0.538 -2.537 -1.493 -0.397 1.00   394
10           betaInt[2, 1, 2]  0.207 0.425 -0.543  0.185  1.100 1.00  1119
11           betaInt[1, 2, 2]  1.398 1.527 -1.621  1.422  4.448 1.00  4000
12           betaInt[2, 2, 2]  0.101 0.418 -0.615  0.060  1.025 1.01   694
13           betaInt[1, 3, 2]  0.992 1.445 -1.597  1.008  3.723 1.00   549
14           betaInt[2, 3, 2] -0.140 0.391 -0.859 -0.155  0.659 1.02   582
15           betaInt[1, 4, 2]  3.586 0.820  2.044  3.557  5.268 1.00   611
16           betaInt[2, 4, 2]  2.544 0.534  1.556  2.527  3.634 1.03   458
17           betaInt[1, 1, 3]  1.095 0.534  0.161  1.047  2.279 1.00  1062
18           betaInt[2, 1, 3] -2.271 0.612 -3.429 -2.279 -1.059 1.00   585
19           betaInt[1, 2, 3]  1.416 1.534 -1.576  1.396  4.421 1.00  4231
20           betaInt[2, 2, 3]  0.002 0.238 -0.449 -0.005  0.480 1.00  1526
21           betaInt[1, 3, 3]  1.419 1.008 -0.427  1.366  3.511 1.01  1117
22           betaInt[2, 3, 3]  1.417 0.449  0.615  1.382  2.405 1.00  1411
23           betaInt[1, 4, 3]  2.555 0.648  1.381  2.507  3.960 1.01   294
24           betaInt[2, 4, 3]  3.565 0.781  2.080  3.564  5.129 1.02   546
25           betaInt[1, 1, 4]  1.254 0.957 -0.496  1.228  3.186 1.00  1063
26           betaInt[2, 1, 4] -1.394 1.337 -3.679 -1.517  1.396 1.01   755
27           betaInt[1, 2, 4]  1.408 1.498 -1.545  1.406  4.363 1.00  4000
28           betaInt[2, 2, 4]  0.312 0.602 -0.698  0.249  1.713 1.00  1621
29           betaInt[1, 3, 4]  2.181 0.751  0.771  2.156  3.745 1.01  1222
30           betaInt[2, 3, 4] -0.156 0.657 -1.154 -0.251  1.494 1.00  1288
31           betaInt[1, 4, 4]  2.824 0.752  1.370  2.806  4.314 1.00   535
32           betaInt[2, 4, 4]  0.006 1.240 -1.682 -0.299  3.071 1.02   502
33           betaInt[1, 1, 5]  0.727 1.097 -1.377  0.708  2.878 1.00  2709
34           betaInt[2, 1, 5] -0.531 1.130 -2.723 -0.546  1.684 1.00  1918
35           betaInt[1, 2, 5]  1.442 1.512 -1.484  1.451  4.397 1.00  3439
36           betaInt[2, 2, 5] -0.319 0.554 -1.222 -0.372  0.991 1.00  1149
37           betaInt[1, 3, 5]  1.780 0.651  0.773  1.680  3.299 1.00  2080
38           betaInt[2, 3, 5]  2.892 0.770  1.307  2.902  4.331 1.03   208
39           betaInt[1, 4, 5]  1.363 0.865  0.098  1.207  3.555 1.01   420
40           betaInt[2, 4, 5] -0.482 0.810 -1.858 -0.530  1.305 1.02   872
41           betaInt[1, 1, 6]  1.117 0.984 -0.733  1.094  3.039 1.00  2880
42           betaInt[2, 1, 6] -1.371 1.064 -3.242 -1.423  0.874 1.01   677
43           betaInt[1, 2, 6]  1.410 1.510 -1.520  1.410  4.319 1.00  4000
44           betaInt[2, 2, 6]  0.021 0.420 -0.691 -0.015  0.952 1.01  1311
45           betaInt[1, 3, 6]  2.962 0.848  1.478  2.917  4.802 1.06   285
46           betaInt[2, 3, 6]  0.891 0.542 -0.023  0.835  2.162 1.00  1347
47           betaInt[1, 4, 6]  1.835 1.106 -0.008  1.719  4.269 1.00   769
48           betaInt[2, 4, 6]  0.144 0.887 -1.177 -0.003  2.418 1.03   504
49           betaInt[1, 1, 7] -1.406 0.693 -2.588 -1.465  0.153 1.00   270
50           betaInt[2, 1, 7]  0.540 0.662 -0.624  0.504  1.975 1.01  1349
51           betaInt[1, 2, 7]  1.418 1.518 -1.584  1.412  4.444 1.00  4023
52           betaInt[2, 2, 7] -1.075 0.517 -2.058 -1.096 -0.018 1.00  1246
53           betaInt[1, 3, 7]  1.915 0.671  0.812  1.831  3.491 1.00  1150
54           betaInt[2, 3, 7]  2.422 0.663  1.208  2.407  3.806 1.00  1982
55           betaInt[1, 4, 7]  2.326 1.096  0.427  2.257  4.647 1.00   777
56           betaInt[2, 4, 7]  1.462 0.861  0.117  1.338  3.423 1.01  1180
57           betaInt[1, 1, 8]  0.491 0.266  0.031  0.466  1.114 1.00   957
58           betaInt[2, 1, 8] -1.012 0.557 -1.954 -1.050  0.194 1.00   864
59           betaInt[1, 2, 8]  1.429 1.517 -1.538  1.427  4.372 1.00  3761
60           betaInt[2, 2, 8] -0.131 0.209 -0.531 -0.134  0.285 1.00   832
61           betaInt[1, 3, 8]  1.884 0.447  1.111  1.852  2.886 1.02   460
62           betaInt[2, 3, 8]  1.161 0.293  0.641  1.146  1.807 1.00  1108
63           betaInt[1, 4, 8]  2.994 0.877  1.526  2.899  4.890 1.01   571
64           betaInt[2, 4, 8]  2.039 0.802  0.748  1.955  3.859 1.01   884
65           betaInt[1, 1, 9]  0.754 1.120 -1.533  0.771  2.880 1.00  2576
66           betaInt[2, 1, 9] -0.313 0.820 -1.823 -0.354  1.432 1.00  1688
67           betaInt[1, 2, 9]  1.396 1.527 -1.575  1.380  4.436 1.00  4000
68           betaInt[2, 2, 9]  0.177 0.522 -0.695  0.134  1.300 1.00  1621
69           betaInt[1, 3, 9]  0.884 0.880 -0.633  0.808  2.903 1.00  1441
70           betaInt[2, 3, 9]  0.928 0.543 -0.085  0.911  2.076 1.00  1653
71           betaInt[1, 4, 9]  2.311 1.110  0.362  2.240  4.616 1.00  1163
72           betaInt[2, 4, 9]  1.255 1.096 -0.656  1.156  3.617 1.01   936
73          betaInt[1, 1, 10]  3.224 0.784  1.656  3.237  4.719 1.00   769
74          betaInt[2, 1, 10] -0.503 1.031 -2.425 -0.544  1.568 1.01  1707
75          betaInt[1, 2, 10]  1.412 1.517 -1.543  1.407  4.330 1.00  4139
76          betaInt[2, 2, 10] -0.026 0.446 -0.842 -0.057  0.927 1.00  2296
77          betaInt[1, 3, 10]  2.608 0.830  1.044  2.581  4.296 1.00  1219
78          betaInt[2, 3, 10]  2.426 0.681  1.121  2.414  3.794 1.00   868
79          betaInt[1, 4, 10]  2.634 0.945  0.937  2.594  4.609 1.02  1223
80          betaInt[2, 4, 10]  1.944 0.873  0.357  1.903  3.810 1.01   956
81          betaInt[1, 1, 11]  0.086 0.595 -0.938  0.036  1.431 1.00   190
82          betaInt[2, 1, 11]  1.447 0.513  0.493  1.442  2.457 1.00  1229
83          betaInt[1, 2, 11]  1.386 1.515 -1.683  1.390  4.379 1.00  4000
84          betaInt[2, 2, 11]  0.140 0.228 -0.276  0.129  0.639 1.00  1008
85          betaInt[1, 3, 11]  2.055 0.462  1.239  2.028  3.040 1.11   228
86          betaInt[2, 3, 11]  0.515 0.310 -0.089  0.511  1.112 1.05   408
87          betaInt[1, 4, 11]  2.809 0.855  1.352  2.731  4.713 1.00   391
88          betaInt[2, 4, 11]  3.596 1.000  1.615  3.600  5.579 1.02   323
89          betaInt[1, 1, 12]  0.823 0.737 -0.490  0.776  2.397 1.00   832
90          betaInt[2, 1, 12]  0.313 0.801 -1.094  0.272  2.073 1.00  2116
91          betaInt[1, 2, 12]  1.437 1.518 -1.564  1.476  4.337 1.00  4000
92          betaInt[2, 2, 12]  0.251 0.458 -0.529  0.205  1.293 1.00  1811
93          betaInt[1, 3, 12]  1.691 0.696  0.433  1.641  3.157 1.01   534
94          betaInt[2, 3, 12]  1.761 0.596  0.706  1.729  3.054 1.00  1280
95          betaInt[1, 4, 12]  3.068 1.014  1.186  3.013  5.240 1.00   388
96          betaInt[2, 4, 12]  2.308 0.840  0.821  2.277  4.052 1.00  1120
97          betaInt[1, 1, 13]  1.925 0.748  0.579  1.882  3.494 1.00  1421
98          betaInt[2, 1, 13] -0.364 1.097 -2.449 -0.374  1.797 1.01  2692
99          betaInt[1, 2, 13]  1.419 1.511 -1.555  1.429  4.440 1.00  3812
100         betaInt[2, 2, 13] -0.026 1.033 -2.032 -0.008  1.922 1.00  3033
101         betaInt[1, 3, 13]  1.300 0.422  0.545  1.280  2.227 1.04   336
102         betaInt[2, 3, 13]  0.984 1.061 -1.072  0.990  3.090 1.00  3765
103         betaInt[1, 4, 13]  1.656 0.760  0.354  1.590  3.317 1.00   508
104         betaInt[2, 4, 13]  1.579 1.128 -0.612  1.557  3.835 1.00  1503
105       betaIntOut[1, 1, 1]  0.763 0.084  0.582  0.769  0.910 1.00   496
106       betaIntOut[2, 1, 1]  0.360 0.115  0.168  0.348  0.608 1.01   504
107       betaIntOut[1, 2, 1]  0.729 0.232  0.179  0.799  0.988 1.00  4174
108       betaIntOut[2, 2, 1]  0.373 0.079  0.239  0.366  0.556 1.00   562
109       betaIntOut[1, 3, 1]  0.834 0.124  0.520  0.866  0.980 1.00  1106
110       betaIntOut[2, 3, 1]  0.212 0.111  0.072  0.189  0.485 1.01  1178
111       betaIntOut[1, 4, 1]  0.915 0.068  0.747  0.933  0.992 1.01  1294
112       betaIntOut[2, 4, 1]  0.769 0.092  0.604  0.760  0.952 1.02   317
113       betaIntOut[1, 1, 2]  0.197 0.084  0.073  0.184  0.402 1.01   384
114       betaIntOut[2, 1, 2]  0.549 0.100  0.367  0.546  0.750 1.00  1072
115       betaIntOut[1, 2, 2]  0.730 0.232  0.165  0.806  0.988 1.00  3857
116       betaIntOut[2, 2, 2]  0.523 0.098  0.351  0.515  0.736 1.01   689
117       betaIntOut[1, 3, 2]  0.668 0.249  0.168  0.733  0.976 1.00   540
118       betaIntOut[2, 3, 2]  0.466 0.094  0.298  0.461  0.659 1.02   583
119       betaIntOut[1, 4, 2]  0.964 0.029  0.885  0.972  0.995 1.01   769
120       betaIntOut[2, 4, 2]  0.919 0.038  0.826  0.926  0.974 1.02   488
121       betaIntOut[1, 1, 3]  0.737 0.094  0.540  0.740  0.907 1.00  1217
122       betaIntOut[2, 1, 3]  0.106 0.061  0.031  0.093  0.257 1.00   625
123       betaIntOut[1, 2, 3]  0.731 0.232  0.171  0.801  0.988 1.00  4000
124       betaIntOut[2, 2, 3]  0.501 0.059  0.390  0.499  0.618 1.00  1525
125       betaIntOut[1, 3, 3]  0.765 0.156  0.395  0.797  0.971 1.01  1029
126       betaIntOut[2, 3, 3]  0.796 0.068  0.649  0.799  0.917 1.00  1326
127       betaIntOut[1, 4, 3]  0.917 0.046  0.799  0.925  0.981 1.00   540
128       betaIntOut[2, 4, 3]  0.964 0.028  0.889  0.972  0.994 1.01   562
129       betaIntOut[1, 1, 4]  0.742 0.160  0.378  0.774  0.960 1.00  1092
130       betaIntOut[2, 1, 4]  0.259 0.220  0.025  0.180  0.802 1.01   765
131       betaIntOut[1, 2, 4]  0.734 0.227  0.176  0.803  0.987 1.00  3862
132       betaIntOut[2, 2, 4]  0.569 0.132  0.332  0.562  0.847 1.00  1620
133       betaIntOut[1, 3, 4]  0.879 0.076  0.684  0.896  0.977 1.00  1474
134       betaIntOut[2, 3, 4]  0.460 0.146  0.240  0.438  0.817 1.00  1294
135       betaIntOut[1, 4, 4]  0.930 0.049  0.797  0.943  0.987 1.01   657
136       betaIntOut[2, 4, 4]  0.483 0.235  0.157  0.426  0.956 1.01   516
137       betaIntOut[1, 1, 5]  0.642 0.209  0.202  0.670  0.947 1.00  2686
138       betaIntOut[2, 1, 5]  0.396 0.220  0.062  0.367  0.843 1.00  1954
139       betaIntOut[1, 2, 5]  0.737 0.228  0.185  0.810  0.988 1.00  3397
140       betaIntOut[2, 2, 5]  0.424 0.127  0.228  0.408  0.729 1.00  1140
141       betaIntOut[1, 3, 5]  0.839 0.074  0.684  0.843  0.964 1.00  1983
142       betaIntOut[2, 3, 5]  0.933 0.054  0.787  0.948  0.987 1.09   230
143       betaIntOut[1, 4, 5]  0.766 0.117  0.524  0.770  0.972 1.04   543
144       betaIntOut[2, 4, 5]  0.391 0.168  0.135  0.370  0.787 1.01   884
145       betaIntOut[1, 1, 6]  0.717 0.173  0.324  0.749  0.954 1.00  2956
146       betaIntOut[2, 1, 6]  0.244 0.180  0.038  0.194  0.706 1.00   812
147       betaIntOut[1, 2, 6]  0.732 0.229  0.179  0.804  0.987 1.00  4000
148       betaIntOut[2, 2, 6]  0.504 0.100  0.334  0.496  0.722 1.01  1335
149       betaIntOut[1, 3, 6]  0.936 0.048  0.814  0.949  0.992 1.07   391
150       betaIntOut[2, 3, 6]  0.697 0.102  0.494  0.697  0.897 1.00  1353
151       betaIntOut[1, 4, 6]  0.818 0.135  0.498  0.848  0.986 1.00  1042
152       betaIntOut[2, 4, 6]  0.522 0.177  0.236  0.499  0.918 1.02   543
153       betaIntOut[1, 1, 7]  0.216 0.120  0.070  0.188  0.538 1.00   299
154       betaIntOut[2, 1, 7]  0.619 0.139  0.349  0.623  0.878 1.01  1355
155       betaIntOut[1, 2, 7]  0.733 0.230  0.170  0.804  0.988 1.00  3843
156       betaIntOut[2, 2, 7]  0.266 0.098  0.113  0.250  0.496 1.00  1335
157       betaIntOut[1, 3, 7]  0.855 0.072  0.692  0.862  0.970 1.00  1179
158       betaIntOut[2, 3, 7]  0.905 0.055  0.770  0.917  0.978 1.00  1813
159       betaIntOut[1, 4, 7]  0.874 0.105  0.605  0.905  0.991 1.00   936
160       betaIntOut[2, 4, 7]  0.781 0.121  0.529  0.792  0.968 1.01  1218
161       betaIntOut[1, 1, 8]  0.618 0.060  0.508  0.615  0.753 1.00   971
162       betaIntOut[2, 1, 8]  0.279 0.111  0.124  0.259  0.548 1.00   886
163       betaIntOut[1, 2, 8]  0.734 0.231  0.177  0.806  0.988 1.00  3799
164       betaIntOut[2, 2, 8]  0.468 0.051  0.370  0.467  0.571 1.00   832
165       betaIntOut[1, 3, 8]  0.860 0.050  0.752  0.864  0.947 1.03   459
166       betaIntOut[2, 3, 8]  0.758 0.052  0.655  0.759  0.859 1.00  1087
167       betaIntOut[1, 4, 8]  0.937 0.045  0.821  0.948  0.993 1.01   530
168       betaIntOut[2, 4, 8]  0.862 0.081  0.679  0.876  0.979 1.00   850
169       betaIntOut[1, 1, 9]  0.647 0.212  0.178  0.684  0.947 1.00  2582
170       betaIntOut[2, 1, 9]  0.430 0.177  0.139  0.412  0.807 1.00  1793
171       betaIntOut[1, 2, 9]  0.729 0.232  0.172  0.799  0.988 1.00  3701
172       betaIntOut[2, 2, 9]  0.540 0.119  0.333  0.533  0.786 1.00  1642
173       betaIntOut[1, 3, 9]  0.680 0.158  0.347  0.692  0.948 1.01  1661
174       betaIntOut[2, 3, 9]  0.705 0.106  0.479  0.713  0.889 1.00  1642
175       betaIntOut[1, 4, 9]  0.872 0.108  0.590  0.904  0.990 1.01  1401
176       betaIntOut[2, 4, 9]  0.733 0.173  0.342  0.761  0.974 1.01  1162
177      betaIntOut[1, 1, 10]  0.950 0.040  0.840  0.962  0.991 1.00   767
178      betaIntOut[2, 1, 10]  0.396 0.208  0.081  0.367  0.827 1.01  1757
179      betaIntOut[1, 2, 10]  0.731 0.232  0.176  0.803  0.987 1.00  4026
180      betaIntOut[2, 2, 10]  0.493 0.106  0.301  0.486  0.717 1.00  2294
181      betaIntOut[1, 3, 10]  0.912 0.066  0.740  0.930  0.987 1.00  1312
182      betaIntOut[2, 3, 10]  0.904 0.059  0.754  0.918  0.978 1.01   906
183      betaIntOut[1, 4, 10]  0.910 0.073  0.718  0.931  0.990 1.05  1107
184      betaIntOut[2, 4, 10]  0.846 0.104  0.588  0.870  0.978 1.00  1048
185      betaIntOut[1, 1, 11]  0.518 0.135  0.281  0.509  0.807 1.00   196
186      betaIntOut[2, 1, 11]  0.798 0.080  0.621  0.809  0.921 1.00  1366
187      betaIntOut[1, 2, 11]  0.729 0.232  0.157  0.801  0.988 1.00  3794
188      betaIntOut[2, 2, 11]  0.534 0.056  0.431  0.532  0.655 1.00  1008
189      betaIntOut[1, 3, 11]  0.878 0.047  0.775  0.884  0.954 1.10   266
190      betaIntOut[2, 3, 11]  0.623 0.071  0.478  0.625  0.753 1.05   408
191      betaIntOut[1, 4, 11]  0.927 0.053  0.794  0.939  0.991 1.00   470
192      betaIntOut[2, 4, 11]  0.959 0.044  0.834  0.973  0.996 1.07   335
193      betaIntOut[1, 1, 12]  0.675 0.142  0.380  0.685  0.917 1.00   659
194      betaIntOut[2, 1, 12]  0.566 0.170  0.251  0.568  0.888 1.01  2149
195      betaIntOut[1, 2, 12]  0.736 0.231  0.173  0.814  0.987 1.00  4000
196      betaIntOut[2, 2, 12]  0.559 0.105  0.371  0.551  0.785 1.00  1864
197      betaIntOut[1, 3, 12]  0.824 0.093  0.607  0.838  0.959 1.01   514
198      betaIntOut[2, 3, 12]  0.839 0.075  0.669  0.849  0.955 1.00  1362
199      betaIntOut[1, 4, 12]  0.935 0.062  0.766  0.953  0.995 1.01   530
200      betaIntOut[2, 4, 12]  0.887 0.079  0.694  0.907  0.983 1.00   897
201      betaIntOut[1, 1, 13]  0.851 0.087  0.641  0.868  0.971 1.00  1333
202      betaIntOut[2, 1, 13]  0.427 0.220  0.080  0.408  0.858 1.01  2681
203      betaIntOut[1, 2, 13]  0.733 0.229  0.174  0.807  0.988 1.00  3911
204      betaIntOut[2, 2, 13]  0.496 0.214  0.116  0.498  0.872 1.00  3086
205      betaIntOut[1, 3, 13]  0.778 0.069  0.633  0.782  0.903 1.04   366
206      betaIntOut[2, 3, 13]  0.691 0.192  0.255  0.729  0.956 1.00  3781
207      betaIntOut[1, 4, 13]  0.816 0.100  0.588  0.831  0.965 1.00   459
208      betaIntOut[2, 4, 13]  0.781 0.169  0.352  0.826  0.979 1.01  1752
209                betaIntTop  0.658 0.624 -0.596  0.656  1.904 1.00  3833
210             betaIntYOY[1]  1.427 0.557  0.334  1.417  2.544 1.00  2693
211             betaIntYOY[2]  0.566 0.486 -0.381  0.572  1.530 1.00  3471
212          betaIntYOYOut[1]  0.793 0.088  0.583  0.805  0.927 1.00  2686
213          betaIntYOYOut[2]  0.631 0.108  0.406  0.639  0.822 1.00  3462
214    betaIntYOYSeason[1, 1]  0.804 0.394  0.065  0.798  1.619 1.00   900
215    betaIntYOYSeason[2, 1] -0.381 0.447 -1.257 -0.399  0.521 1.02   661
216    betaIntYOYSeason[1, 2]  1.413 1.139 -0.867  1.405  3.646 1.00  4000
217    betaIntYOYSeason[2, 2] -0.031 0.307 -0.638 -0.037  0.566 1.00  2559
218    betaIntYOYSeason[1, 3]  1.789 0.426  1.036  1.761  2.694 1.01   471
219    betaIntYOYSeason[2, 3]  1.014 0.343  0.338  1.010  1.693 1.00  1323
220    betaIntYOYSeason[1, 4]  2.442 0.529  1.531  2.398  3.615 1.01   329
221    betaIntYOYSeason[2, 4]  1.561 0.500  0.717  1.516  2.690 1.04   400
222 betaIntYOYSeasonOut[1, 1]  0.685 0.082  0.516  0.690  0.835 1.00   932
223 betaIntYOYSeasonOut[2, 1]  0.410 0.104  0.221  0.402  0.627 1.01   704
224 betaIntYOYSeasonOut[1, 2]  0.757 0.181  0.296  0.803  0.975 1.00  3699
225 betaIntYOYSeasonOut[2, 2]  0.492 0.075  0.346  0.491  0.638 1.00  2559
226 betaIntYOYSeasonOut[1, 3]  0.849 0.052  0.738  0.853  0.937 1.01   522
227 betaIntYOYSeasonOut[2, 3]  0.729 0.066  0.584  0.733  0.845 1.00  1319
228 betaIntYOYSeasonOut[1, 4]  0.912 0.039  0.822  0.917  0.974 1.02   421
229 betaIntYOYSeasonOut[2, 4]  0.816 0.068  0.672  0.820  0.936 1.02   497
    flowData
1       flow
2       flow
3       flow
4       flow
5       flow
6       flow
7       flow
8       flow
9       flow
10      flow
11      flow
12      flow
13      flow
14      flow
15      flow
16      flow
17      flow
18      flow
19      flow
20      flow
21      flow
22      flow
23      flow
24      flow
25      flow
26      flow
27      flow
28      flow
29      flow
30      flow
31      flow
32      flow
33      flow
34      flow
35      flow
36      flow
37      flow
38      flow
39      flow
40      flow
41      flow
42      flow
43      flow
44      flow
45      flow
46      flow
47      flow
48      flow
49      flow
50      flow
51      flow
52      flow
53      flow
54      flow
55      flow
56      flow
57      flow
58      flow
59      flow
60      flow
61      flow
62      flow
63      flow
64      flow
65      flow
66      flow
67      flow
68      flow
69      flow
70      flow
71      flow
72      flow
73      flow
74      flow
75      flow
76      flow
77      flow
78      flow
79      flow
80      flow
81      flow
82      flow
83      flow
84      flow
85      flow
86      flow
87      flow
88      flow
89      flow
90      flow
91      flow
92      flow
93      flow
94      flow
95      flow
96      flow
97      flow
98      flow
99      flow
100     flow
101     flow
102     flow
103     flow
104     flow
105     flow
106     flow
107     flow
108     flow
109     flow
110     flow
111     flow
112     flow
113     flow
114     flow
115     flow
116     flow
117     flow
118     flow
119     flow
120     flow
121     flow
122     flow
123     flow
124     flow
125     flow
126     flow
127     flow
128     flow
129     flow
130     flow
131     flow
132     flow
133     flow
134     flow
135     flow
136     flow
137     flow
138     flow
139     flow
140     flow
141     flow
142     flow
143     flow
144     flow
145     flow
146     flow
147     flow
148     flow
149     flow
150     flow
151     flow
152     flow
153     flow
154     flow
155     flow
156     flow
157     flow
158     flow
159     flow
160     flow
161     flow
162     flow
163     flow
164     flow
165     flow
166     flow
167     flow
168     flow
169     flow
170     flow
171     flow
172     flow
173     flow
174     flow
175     flow
176     flow
177     flow
178     flow
179     flow
180     flow
181     flow
182     flow
183     flow
184     flow
185     flow
186     flow
187     flow
188     flow
189     flow
190     flow
191     flow
192     flow
193     flow
194     flow
195     flow
196     flow
197     flow
198     flow
199     flow
200     flow
201     flow
202     flow
203     flow
204     flow
205     flow
206     flow
207     flow
208     flow
209     flow
210     flow
211     flow
212     flow
213     flow
214     flow
215     flow
216     flow
217     flow
218     flow
219     flow
220     flow
221     flow
222     flow
223     flow
224     flow
225     flow
226     flow
227     flow
228     flow
229     flow</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">&lt;-</span> <span class="fu">runif</span>(out_flow<span class="sc">$</span>runData<span class="sc">$</span>nIter <span class="sc">*</span> out_flow<span class="sc">$</span>runData<span class="sc">$</span>nChains, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"betaIntYOYSeason"</span>, <span class="st">"betaPhiYOYSeason"</span>,<span class="st">"betaPYOYSeason"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntTop", "betaPhiTop","betaFlowTop","betaPTop"  </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaInt", "betaPhi","betaFlow","betaP",</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntOut", "betaPhiOut","betaFlowOut","betaPOut"</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"betaIntYOY"</span>, <span class="st">"betaPhiYOY"</span>,<span class="st">"betaFlowYOY"</span>,<span class="st">"betaPYOY"</span>  </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaInt", "betaPhi","betaFlow","betaP",</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntOut", "betaPhiOut","betaFlowOut","betaPOut"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-9.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-11.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="model-phit_pt-flow-byriver-tt_ob_flowbyriver" class="level3" data-number="12.0.2">
<h3 data-number="12.0.2" class="anchored" data-anchor-id="model-phit_pt-flow-byriver-tt_ob_flowbyriver"><span class="header-section-number">12.0.2</span> Model phiT_pT flow ByRiver (tt_OB_flowByRiver)</h3>
<p>Cohort-dependent estimates of phi and p with flowByRiver and flowByRiver^2 hierarchical effects</p>
<section id="retrieve-model-results-1" class="level4" data-number="12.0.2.1">
<h4 data-number="12.0.2.1" class="anchored" data-anchor-id="retrieve-model-results-1"><span class="header-section-number">12.0.2.1</span> Retrieve model results</h4>
<p>Model is run using targets in R/modelCMR_tt_OB.R</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following https://oliviergimenez.github.io/bayesian-cr-workshop/worksheets/4_demo.html</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  out_flowByRiver <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(tt_modelOut_ft_cohort_OB_flowByRiver)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCplot</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc, <span class="at">round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"var"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         var  mean    sd   2.5%   50% 97.5% Rhat n.eff
1     betaIntYOYSeason[1, 1] 1.250 0.374  0.544 1.243 2.015 1.01   645
2     betaIntYOYSeason[2, 1] 0.897 0.575 -0.169 0.868 2.065 1.10   215
3     betaIntYOYSeason[1, 2] 1.506 1.184 -0.768 1.519 3.791 1.00  2005
4     betaIntYOYSeason[2, 2] 0.448 0.368 -0.251 0.443 1.195 1.06   423
5     betaIntYOYSeason[1, 3] 1.551 0.764  0.003 1.559 3.052 1.03    84
6     betaIntYOYSeason[2, 3] 0.925 0.410  0.155 0.918 1.755 1.00   439
7     betaIntYOYSeason[1, 4] 2.581 0.552  1.539 2.586 3.680 1.00   308
8     betaIntYOYSeason[2, 4] 0.986 0.537  0.073 0.942 2.158 1.00   216
9  betaIntYOYSeasonOut[1, 1] 0.771 0.064  0.633 0.776 0.882 1.01   719
10 betaIntYOYSeasonOut[2, 1] 0.697 0.112  0.458 0.704 0.887 1.08   220
11 betaIntYOYSeasonOut[1, 2] 0.767 0.182  0.317 0.820 0.978 1.00  2463
12 betaIntYOYSeasonOut[2, 2] 0.607 0.085  0.438 0.609 0.768 1.06   435
13 betaIntYOYSeasonOut[1, 3] 0.801 0.116  0.501 0.826 0.955 1.06   108
14 betaIntYOYSeasonOut[2, 3] 0.709 0.081  0.539 0.715 0.853 1.00   493
15 betaIntYOYSeasonOut[1, 4] 0.921 0.041  0.823 0.930 0.975 1.00   298
16 betaIntYOYSeasonOut[2, 4] 0.716 0.099  0.518 0.719 0.896 1.00   278
      flowData
1  flowByRiver
2  flowByRiver
3  flowByRiver
4  flowByRiver
5  flowByRiver
6  flowByRiver
7  flowByRiver
8  flowByRiver
9  flowByRiver
10 flowByRiver
11 flowByRiver
12 flowByRiver
13 flowByRiver
14 flowByRiver
15 flowByRiver
16 flowByRiver</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] var      mean     sd       2.5%     50%      97.5%    Rhat     n.eff   
[9] flowData
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlow"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 var   mean    sd   2.5%    50%  97.5% Rhat n.eff    flowData
1  betaFlow[1, 1, 1]  0.015 0.203 -0.351  0.006  0.433 1.03   318 flowByRiver
2  betaFlow[2, 1, 1] -0.387 0.229 -0.863 -0.383  0.050 1.01   337 flowByRiver
3  betaFlow[3, 1, 1]  0.102 0.144 -0.171  0.106  0.390 1.00   592 flowByRiver
4  betaFlow[1, 2, 1]  0.184 0.422 -0.600  0.157  1.122 1.14   130 flowByRiver
5  betaFlow[2, 2, 1] -0.928 0.332 -1.576 -0.924 -0.302 1.01   414 flowByRiver
6  betaFlow[3, 2, 1]  0.188 0.293 -0.395  0.192  0.745 1.09   360 flowByRiver
7  betaFlow[1, 1, 2] -0.291 1.165 -2.550 -0.284  1.974 1.00  1394 flowByRiver
8  betaFlow[2, 1, 2]  0.628 1.181 -1.727  0.639  2.916 1.00  2473 flowByRiver
9  betaFlow[3, 1, 2]  0.433 1.160 -1.788  0.435  2.726 1.00  2197 flowByRiver
10 betaFlow[1, 2, 2]  0.426 0.238  0.027  0.402  0.917 1.18   122 flowByRiver
11 betaFlow[2, 2, 2] -1.237 0.227 -1.722 -1.223 -0.830 1.13   152 flowByRiver
12 betaFlow[3, 2, 2] -0.285 0.170 -0.674 -0.274  0.018 1.11   183 flowByRiver
13 betaFlow[1, 1, 3] -0.453 0.873 -2.204 -0.447  1.300 1.03    62 flowByRiver
14 betaFlow[2, 1, 3]  0.240 0.757 -1.301  0.249  1.659 1.02   219 flowByRiver
15 betaFlow[3, 1, 3]  1.227 0.877 -0.484  1.236  2.928 1.02   222 flowByRiver
16 betaFlow[1, 2, 3] -0.123 0.270 -0.614 -0.138  0.464 1.03   179 flowByRiver
17 betaFlow[2, 2, 3] -1.085 0.291 -1.715 -1.065 -0.576 1.01   206 flowByRiver
18 betaFlow[3, 2, 3] -0.754 0.259 -1.321 -0.733 -0.294 1.01   207 flowByRiver
19 betaFlow[1, 1, 4] -0.587 0.242 -1.068 -0.585 -0.116 1.03   526 flowByRiver
20 betaFlow[2, 1, 4]  2.728 0.510  1.728  2.731  3.758 1.02   330 flowByRiver
21 betaFlow[3, 1, 4]  0.238 0.390 -0.506  0.238  0.991 1.02   357 flowByRiver
22 betaFlow[1, 2, 4] -0.281 0.229 -0.715 -0.285  0.203 1.06   437 flowByRiver
23 betaFlow[2, 2, 4]  1.328 0.600 -0.116  1.363  2.344 1.01   183 flowByRiver
24 betaFlow[3, 2, 4]  0.244 0.315 -0.379  0.248  0.865 1.00   369 flowByRiver
25    betaFlowTop[1] -0.094 0.638 -1.389 -0.091  1.157 1.00  3445 flowByRiver
26    betaFlowTop[2]  0.104 0.650 -1.169  0.115  1.356 1.00  3203 flowByRiver
27    betaFlowTop[3]  0.114 0.646 -1.151  0.105  1.370 1.00  3669 flowByRiver
28 betaFlowYOY[1, 1] -0.266 0.597 -1.439 -0.264  0.912 1.00   392 flowByRiver
29 betaFlowYOY[2, 1]  0.665 0.592 -0.468  0.649  1.794 1.00  1038 flowByRiver
30 betaFlowYOY[3, 1]  0.422 0.613 -0.767  0.426  1.606 1.00  1124 flowByRiver
31 betaFlowYOY[1, 2]  0.023 0.487 -0.954  0.034  0.964 1.00  1662 flowByRiver
32 betaFlowYOY[2, 2] -0.368 0.500 -1.348 -0.349  0.579 1.00  1180 flowByRiver
33 betaFlowYOY[3, 2] -0.110 0.477 -1.045 -0.107  0.817 1.00  2843 flowByRiver</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">&lt;-</span> <span class="fu">runif</span>(out_flowByRiver<span class="sc">$</span>runData<span class="sc">$</span>nIter <span class="sc">*</span> out_flowByRiver<span class="sc">$</span>runData<span class="sc">$</span>nChains, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>( <span class="st">"betaIntYOY"</span>, <span class="st">"betaPhiYOY"</span>,<span class="st">"betaFlowYOY"</span>,<span class="st">"betaPYOY"</span> ),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># MCMCtrace(object = out_flowByRiver$mcmc,</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           #ISB = FALSE,</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           #exact = TRUE, </span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           params = c("betaInt"),</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           pdf = FALSE, </span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           priors = priors)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="compare-parameter-estimates-of-models-with-flow-and-flowbyriver" class="level4" data-number="12.0.2.2">
<h4 data-number="12.0.2.2" class="anchored" data-anchor-id="compare-parameter-estimates-of-models-with-flow-and-flowbyriver"><span class="header-section-number">12.0.2.2</span> Compare parameter estimates of models with flow and flowByRiver</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(summary_flow, summary_flowByRiver) <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lo =</span> <span class="st">'2.5%'</span>, <span class="at">hi =</span> <span class="st">'97.5%'</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowTop"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiTop"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-8.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(both %&gt;% filter(grepl("betaPOut", var)), aes(color = flowData)) +</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(var, mean), size = 2, position = position_dodge(width = 0.5)) +</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_errorbar( aes(var, ymin = lo, ymax = hi), width = 0.4, position = position_dodge(width = 0.5)) +</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="section" class="level32">
<p class="heading"></p>
</section>
</section>
</section>
<section id="survival-comparison" class="level3" data-number="12.0.3">
<h3 data-number="12.0.3" class="anchored" data-anchor-id="survival-comparison"><span class="header-section-number">12.0.3</span> Survival comparison</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>getBetas <span class="ot">&lt;-</span> <span class="cf">function</span>(d) {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#betaFlow</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  betaFlow <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt</span><span class="sc">\\</span><span class="st">["</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> <span class="st">"flow"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+), ([0-9]+), ([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>)[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">param =</span> tmp<span class="sc">$</span>V1,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">season =</span> tmp<span class="sc">$</span>V3</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  betaFlowYOY <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowYOY"</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> <span class="st">"flow"</span>,</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+), ([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>)[, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">param =</span> tmp<span class="sc">$</span>V1,</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  betaFlowTop <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowTop"</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> <span class="st">"flow"</span>,</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">param =</span> tmp<span class="sc">$</span>V2</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>getBetaIntOuts <span class="ot">&lt;-</span> <span class="cf">function</span>(d, <span class="at">dataType =</span> <span class="st">"flow"</span>) {</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">#betaFlow</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>  betaInt <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntOut</span><span class="sc">\\</span><span class="st">["</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> dataType,</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+), ([0-9]+), ([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>)[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V1,</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>      <span class="at">season =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">cohort =</span> tmp<span class="sc">$</span>V3,</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">varName =</span> <span class="st">"betaInt"</span></span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp) <span class="sc">%&gt;%</span></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(season <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> isYOY <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>  betaIntYOY <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYOut</span><span class="sc">\\</span><span class="st">["</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> dataType,</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>      <span class="at">varName =</span> <span class="st">"betaIntYOY"</span></span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp)</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>  betaIntYOYSeason <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeasonOut</span><span class="sc">\\</span><span class="st">["</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> dataType,</span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+), ([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>)[, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V1,</span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>      <span class="at">season =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>      <span class="at">varName =</span> <span class="st">"betaIntYOYSeason"</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp) <span class="sc">%&gt;%</span></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(season <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> isYOY <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(betaInt, betaIntYOY, betaIntYOYSeason) <span class="sc">%&gt;%</span></span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">cohort =</span> <span class="fu">as.numeric</span>(cohort) <span class="sc">+</span> <span class="dv">2002</span> <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="get-betaintout-estimates" class="level4" data-number="12.0.3.1">
<h4 data-number="12.0.3.1" class="anchored" data-anchor-id="get-betaintout-estimates"><span class="header-section-number">12.0.3.1</span> Get betaIntOut estimates</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>betaIntFlow <span class="ot">&lt;-</span> <span class="fu">getBetaIntOuts</span>(summary_flow, <span class="st">"flow"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>betaIntFlowByRiver <span class="ot">&lt;-</span> <span class="fu">getBetaIntOuts</span>(summary_flowByRiver, <span class="st">"flowByRiver"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>betaInts <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(betaIntFlow, betaIntFlowByRiver) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lo =</span> <span class="st">'2.5%'</span>, <span class="at">hi =</span> <span class="st">'97.5%'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the facet labeller function</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>labelsIntYOY <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Growth year 1"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Growth year 2"</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>labelsIntSeason <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Spring"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Summer"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Autumn"</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Winter"</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>global_labellerInt <span class="ot">&lt;-</span> <span class="fu">labeller</span>(</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">isYOY =</span> labelsIntYOY,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> labelsIntSeason</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="co">#.default = label_both</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(betaInts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(varName <span class="sc">==</span> <span class="st">"betaInt"</span>), <span class="fu">aes</span>(cohort, mean, <span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(cohort, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Cohort"</span>) <span class="sc">+</span>  </span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Suvrival"</span>) <span class="sc">+</span></span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season<span class="sc">~</span>isYOY, <span class="at">labeller =</span> global_labellerInt) <span class="sc">+</span></span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Data source"</span></span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>global_labellerIntYOYSeason <span class="ot">&lt;-</span> <span class="fu">labeller</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">isYOY =</span> labelsIntYOY</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a> <span class="co"># season = labelsIntSeason</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#.default = label_both</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(betaInts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(varName <span class="sc">==</span> <span class="st">"betaIntYOYSeason"</span>), <span class="fu">aes</span>(season, mean, <span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(season, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">"Season"</span>) <span class="sc">+</span>  </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Suvrival"</span>) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>isYOY, <span class="at">labeller =</span> global_labellerIntYOYSeason) <span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Data source"</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(betaInts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(varName <span class="sc">==</span> <span class="st">"betaIntYOY"</span>), <span class="fu">aes</span>(isYOY, mean, <span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(isYOY, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-4-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="section-1" class="level32">
<p class="heading"></p>
</section>
</section>
</section>
<section id="flow_yoyseason-predictions" class="level3" data-number="12.0.4">
<h3 data-number="12.0.4" class="anchored" data-anchor-id="flow_yoyseason-predictions"><span class="header-section-number">12.0.4</span> Flow_YOYSeason predictions</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>getPredictions_FlowYOYSeasonCohort <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaInt</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  predictorsBetaInt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nCohorts</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaInt)){</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    predictorsBetaInt<span class="sc">$</span>betaInt[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaInt[i, <span class="st">"iter"</span>], </span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">paste0</span>(<span class="st">"betaInt["</span>, predictorsBetaInt[i, <span class="st">"isYOY"</span>],</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"season"</span>],</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"cohort"</span>],</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"]"</span>)</span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ## betaPhi</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># predictorsBetaPhi &lt;- expand.grid(</span></span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   iter = seq(1, dim(mcmc$chain1)[1], everyNIters),</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   isYOY = 1:2,</span></span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   season = 1:toSave$myConstants$nSeasons,</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for(i in 1:nrow(predictorsBetaPhi)){</span></span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   predictorsBetaPhi$betaPhi[i] &lt;- mcmc$chain1[[predictorsBetaPhi[i, "iter"], </span></span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                paste0("betaPhi[", predictorsBetaPhi[i, "isYOY"],</span></span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       ", ",       predictorsBetaPhi[i, "season"],</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       ", ",       predictorsBetaPhi[i, "cohort"],</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       "]")</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ]]</span></span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlow <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb35-41"><a href="#cb35-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb35-42"><a href="#cb35-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb35-43"><a href="#cb35-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb35-44"><a href="#cb35-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-45"><a href="#cb35-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-46"><a href="#cb35-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlow)){</span>
<span id="cb35-47"><a href="#cb35-47" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb35-48"><a href="#cb35-48" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[1, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb35-49"><a href="#cb35-49" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb35-50"><a href="#cb35-50" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co">#     ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb35-51"><a href="#cb35-51" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb35-52"><a href="#cb35-52" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb35-53"><a href="#cb35-53" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb35-54"><a href="#cb35-54" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[2, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb35-55"><a href="#cb35-55" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb35-56"><a href="#cb35-56" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb35-57"><a href="#cb35-57" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb35-58"><a href="#cb35-58" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb35-59"><a href="#cb35-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb35-60"><a href="#cb35-60" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb35-61"><a href="#cb35-61" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[3, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb35-62"><a href="#cb35-62" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb35-63"><a href="#cb35-63" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb35-64"><a href="#cb35-64" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb35-65"><a href="#cb35-65" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb35-66"><a href="#cb35-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb35-67"><a href="#cb35-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-68"><a href="#cb35-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-69"><a href="#cb35-69" aria-hidden="true" tabindex="-1"></a>  predictorsAll <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb35-70"><a href="#cb35-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb35-71"><a href="#cb35-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb35-72"><a href="#cb35-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nCohorts,</span>
<span id="cb35-73"><a href="#cb35-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb35-74"><a href="#cb35-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb35-75"><a href="#cb35-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb35-76"><a href="#cb35-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-77"><a href="#cb35-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-78"><a href="#cb35-78" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsAll <span class="sc">%&gt;%</span></span>
<span id="cb35-79"><a href="#cb35-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaInt) <span class="sc">%&gt;%</span></span>
<span id="cb35-80"><a href="#cb35-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaFlow) <span class="sc">%&gt;%</span></span>
<span id="cb35-81"><a href="#cb35-81" aria-hidden="true" tabindex="-1"></a> <span class="co">#   left_join(predictorsBetaPhi) %&gt;%</span></span>
<span id="cb35-82"><a href="#cb35-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaInt <span class="sc">+</span> betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb35-83"><a href="#cb35-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-84"><a href="#cb35-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb35-85"><a href="#cb35-85" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>getPredictions_FlowYOYSeason <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaInt</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  predictorsBetaInt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">#    cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaInt)){</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    predictorsBetaInt<span class="sc">$</span>betaInt[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaInt[i, <span class="st">"iter"</span>], </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">paste0</span>(<span class="st">"betaIntYOYSeason["</span>, predictorsBetaInt[i, <span class="st">"isYOY"</span>],</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"season"</span>],</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#      ", ",       predictorsBetaInt[i, "cohort"],</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"]"</span>)</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   ## betaPhi</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   predictorsBetaPhi &lt;- expand.grid(</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     iter = seq(1, dim(mcmc$chain1)[1], everyNIters),</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     isYOY = 1:2,</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     season = 1:toSave$myConstants$nSeasons</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="co"># #    cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   for(i in 1:nrow(predictorsBetaPhi)){</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     predictorsBetaPhi$betaPhi[i] &lt;- mcmc$chain1[[predictorsBetaPhi[i, "iter"], </span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                  paste0("betaPhiYOYSeason[", predictorsBetaPhi[i, "isYOY"],</span></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         ", ",       predictorsBetaPhi[i, "season"],</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   #      ", ",       predictorsBetaPhi[i, "cohort"],</span></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         "]")</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     ]]</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlow <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlow)){</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[1, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co">#     ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[2, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[3, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>  predictorsAll <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a>   <span class="co"># cohort = 1:toSave$myConstants$nCohorts,</span></span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsAll <span class="sc">%&gt;%</span></span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaInt) <span class="sc">%&gt;%</span></span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaFlow) <span class="sc">%&gt;%</span></span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  left_join(predictorsBetaPhi) %&gt;%</span></span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaInt <span class="sc">+</span> betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>predFlowYOYSeason <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeason</span>(out_flow, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>predFlowByRiverYOYSeason <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeason</span>(out_flowByRiver, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>predBoth <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(predFlowYOYSeason, predFlowByRiverYOYSeason)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="graph-flow-predictions" class="level4" data-number="12.0.4.1">
<h4 data-number="12.0.4.1" class="anchored" data-anchor-id="graph-flow-predictions"><span class="header-section-number">12.0.4.1</span> Graph flow predictions</h4>
<p>Predictions based on flow from the flow extension curve - original approach</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Predictions based on flow from flowByRiver</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowByRiverYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Similar format to to the 2015 paper</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flow <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(temp, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,flow, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(flow)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="section-2" class="level36">
<p class="heading"></p>
</section>
</section>
</section>
<section id="flow_yoyseasoncohort-predictions" class="level3" data-number="12.0.5">
<h3 data-number="12.0.5" class="anchored" data-anchor-id="flow_yoyseasoncohort-predictions"><span class="header-section-number">12.0.5</span> Flow_YOYSeasonCohort predictions</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>predFlowYOYSeasonCohort <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeasonCohort</span>(out_flow, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>predFlowByRiverYOYSeasonCohort <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeasonCohort</span>(out_flowByRiver, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>predBoth <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(predFlowYOYSeasonCohort, predFlowByRiverYOYSeasonCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="graph-flow-predictions-1" class="level4" data-number="12.0.5.1">
<h4 data-number="12.0.5.1" class="anchored" data-anchor-id="graph-flow-predictions-1"><span class="header-section-number">12.0.5.1</span> Graph flow predictions</h4>
<p>Predictions based on flow from the flow extension curve - original approach</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY <span class="sc">+</span> cohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Predictions based on flow from flowByRiver</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowByRiverYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY <span class="sc">+</span> cohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Similar format to to the 2015 paper</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flow <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(temp, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,flow,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(flow)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="section-3" class="level37">
<p class="heading"></p>
</section>
</section>
<section id="flowtop-predictions" class="level4" data-number="12.0.5.2">
<h4 data-number="12.0.5.2" class="anchored" data-anchor-id="flowtop-predictions"><span class="header-section-number">12.0.5.2</span> FlowTop predictions</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predFlowTop &lt;- getPredictionsFlowTop(out_flow, everyNIters = 5) %&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(flowData = "flow") </span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># predFlowByRiverTop &lt;- getPredictionsFlowTop(out_flowByRiver, everyNIters = 5) %&gt;%</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(flowData = "flowByRiver")</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># predTopBoth &lt;- bind_rows(predFlowTop, predFlowByRiverTop)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(predTopBoth, aes(flow, predPhi, group = iter)) +</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~flowData)</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(predTopBoth %&gt;% filter(iter &lt; 100), aes(flow, predPhi, group = iter)) +</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(flowData ~ iter)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>getPredictionsFlowTop <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlowTop <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlowTop)){</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">1</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">2</span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">3</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsBetaFlowTop <span class="sc">%&gt;%</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./modelsCMR_ft_Flow_OB.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - O’Bear only</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./modelsCMR_Flow_4Rivers.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - 4 rivers</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb48" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Flow effects on survival (phi) models with cohort structure - O'Bear only</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>Phi model structure:  </span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>          logit(phi<span class="co">[</span><span class="ot">t,i</span><span class="co">]</span>) &lt;-   </span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>            betaInt<span class="co">[</span><span class="ot">   isYOY[i,t],season[t],cohort[i]</span><span class="co">]</span> +  </span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>            betaFlow<span class="co">[</span><span class="ot">1,isYOY[i,t],season[t]</span><span class="co">]</span> * flow<span class="co">[</span><span class="ot">i,t</span><span class="co">]</span> +  </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>            betaFlow<span class="co">[</span><span class="ot">2,isYOY[i,t],season[t]</span><span class="co">]</span> * temp<span class="co">[</span><span class="ot">i,t</span><span class="co">]</span> +  </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>            betaFlow<span class="co">[</span><span class="ot">3,isYOY[i,t],season[t]</span><span class="co">]</span> * temp<span class="co">[</span><span class="ot">i,t</span><span class="co">]</span> * flow<span class="co">[</span><span class="ot">i,t</span><span class="co">]</span>  </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>logit(p<span class="co">[</span><span class="ot">t,i</span><span class="co">]</span>) &lt;- betaP<span class="co">[</span><span class="ot">isYOY[i,t],season[t-1],cohort[i]</span><span class="co">]</span>  </span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>The goal of this modelling exercise is to evaluate the effect of new tributary-specific stream flow estimates on survival of brook trout and brown trout. We will compare survival across the WB and tributaries with flow input data as 1) single flow estimate for all locations (historical approach) and 2) hindcasted flows for each tributary based on new tributary-specific flows which are available since 2000.</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>The goal is to find the best structure for the survival model, then compare survival estimates with tributary-specific flow to estimates with common flow across locations.</span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>Structure options include</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">species, cohort, season, isYOY, flow, flow^2</span><span class="co">]</span></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r globalModelsNimbleRiver, include=FALSE}</span></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r librariesModelsNimbleRiver, echo = FALSE}</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(getWBData)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nimble)</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nimbleEcology)</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MCMCvis)</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model phiT_pT flow (tt_OB_flow)</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>Cohort-dependent estimates of phi and p with flow and temperature hierarchical effects  </span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Retrieve model results</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>Model is run using targets in R/modelCMR_tt_ft_cohort_OB.R</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r OB_tt_flow}</span></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Following https://oliviergimenez.github.io/bayesian-cr-workshop/worksheets/4_demo.html</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>  out_flow <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(tt_modelOut_ft_cohort_OB_flow )</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCplot</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc)</span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc, <span class="at">round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"var"</span>)</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var))</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var))</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlow"</span>, var))</span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt"</span>, var))</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">&lt;-</span> <span class="fu">runif</span>(out_flow<span class="sc">$</span>runData<span class="sc">$</span>nIter <span class="sc">*</span> out_flow<span class="sc">$</span>runData<span class="sc">$</span>nChains, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc,</span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>(</span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>              <span class="st">"betaIntYOYSeason"</span>, <span class="st">"betaPhiYOYSeason"</span>,<span class="st">"betaPYOYSeason"</span></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntTop", "betaPhiTop","betaFlowTop","betaPTop"  </span></span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaInt", "betaPhi","betaFlow","betaP",</span></span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntOut", "betaPhiOut","betaFlowOut","betaPOut"</span></span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc,</span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>(</span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>              <span class="st">"betaIntYOY"</span>, <span class="st">"betaPhiYOY"</span>,<span class="st">"betaFlowYOY"</span>,<span class="st">"betaPYOY"</span>  </span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaInt", "betaPhi","betaFlow","betaP",</span></span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntOut", "betaPhiOut","betaFlowOut","betaPOut"</span></span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model phiT_pT flow ByRiver (tt_OB_flowByRiver)</span></span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>Cohort-dependent estimates of phi and p with flowByRiver and flowByRiver^2 hierarchical effects  </span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Retrieve model results</span></span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>Model is run using targets in R/modelCMR_tt_OB.R</span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a><span class="in">```{r OB_tt_flowByRiver}</span></span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a><span class="co"># Following https://oliviergimenez.github.io/bayesian-cr-workshop/worksheets/4_demo.html</span></span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>  out_flowByRiver <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(tt_modelOut_ft_cohort_OB_flowByRiver)</span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCplot</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc)</span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc, <span class="at">round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"var"</span>)</span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-101"><a href="#cb48-101" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var))</span>
<span id="cb48-102"><a href="#cb48-102" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var))</span>
<span id="cb48-103"><a href="#cb48-103" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlow"</span>, var))</span>
<span id="cb48-104"><a href="#cb48-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-105"><a href="#cb48-105" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-106"><a href="#cb48-106" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">&lt;-</span> <span class="fu">runif</span>(out_flowByRiver<span class="sc">$</span>runData<span class="sc">$</span>nIter <span class="sc">*</span> out_flowByRiver<span class="sc">$</span>runData<span class="sc">$</span>nChains, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb48-107"><a href="#cb48-107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc,</span>
<span id="cb48-108"><a href="#cb48-108" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb48-109"><a href="#cb48-109" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb48-110"><a href="#cb48-110" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>( <span class="st">"betaIntYOY"</span>, <span class="st">"betaPhiYOY"</span>,<span class="st">"betaFlowYOY"</span>,<span class="st">"betaPYOY"</span> ),</span>
<span id="cb48-111"><a href="#cb48-111" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb48-112"><a href="#cb48-112" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span>
<span id="cb48-113"><a href="#cb48-113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># MCMCtrace(object = out_flowByRiver$mcmc,</span></span>
<span id="cb48-114"><a href="#cb48-114" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           #ISB = FALSE,</span></span>
<span id="cb48-115"><a href="#cb48-115" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           #exact = TRUE, </span></span>
<span id="cb48-116"><a href="#cb48-116" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           params = c("betaInt"),</span></span>
<span id="cb48-117"><a href="#cb48-117" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           pdf = FALSE, </span></span>
<span id="cb48-118"><a href="#cb48-118" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           priors = priors)</span></span>
<span id="cb48-119"><a href="#cb48-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-120"><a href="#cb48-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-121"><a href="#cb48-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-122"><a href="#cb48-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-123"><a href="#cb48-123" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Compare parameter estimates of models with flow and flowByRiver</span></span>
<span id="cb48-126"><a href="#cb48-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-127"><a href="#cb48-127" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(summary_flow, summary_flowByRiver) <span class="sc">%&gt;%</span></span>
<span id="cb48-128"><a href="#cb48-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lo =</span> <span class="st">'2.5%'</span>, <span class="at">hi =</span> <span class="st">'97.5%'</span>)</span>
<span id="cb48-129"><a href="#cb48-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-130"><a href="#cb48-130" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowTop"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-131"><a href="#cb48-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-132"><a href="#cb48-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) </span>
<span id="cb48-133"><a href="#cb48-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-134"><a href="#cb48-134" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiTop"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-135"><a href="#cb48-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-136"><a href="#cb48-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-137"><a href="#cb48-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb48-138"><a href="#cb48-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-139"><a href="#cb48-139" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-140"><a href="#cb48-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-141"><a href="#cb48-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-142"><a href="#cb48-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb48-143"><a href="#cb48-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-144"><a href="#cb48-144" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-145"><a href="#cb48-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-146"><a href="#cb48-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-147"><a href="#cb48-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb48-148"><a href="#cb48-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-149"><a href="#cb48-149" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-150"><a href="#cb48-150" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-151"><a href="#cb48-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-152"><a href="#cb48-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb48-153"><a href="#cb48-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-154"><a href="#cb48-154" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-155"><a href="#cb48-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-156"><a href="#cb48-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-157"><a href="#cb48-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb48-158"><a href="#cb48-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-159"><a href="#cb48-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-160"><a href="#cb48-160" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-161"><a href="#cb48-161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-162"><a href="#cb48-162" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-163"><a href="#cb48-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb48-164"><a href="#cb48-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-165"><a href="#cb48-165" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-166"><a href="#cb48-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-167"><a href="#cb48-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-168"><a href="#cb48-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb48-169"><a href="#cb48-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-170"><a href="#cb48-170" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(both %&gt;% filter(grepl("betaPOut", var)), aes(color = flowData)) +</span></span>
<span id="cb48-171"><a href="#cb48-171" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(var, mean), size = 2, position = position_dodge(width = 0.5)) +</span></span>
<span id="cb48-172"><a href="#cb48-172" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_errorbar( aes(var, ymin = lo, ymax = hi), width = 0.4, position = position_dodge(width = 0.5)) +</span></span>
<span id="cb48-173"><a href="#cb48-173" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1))</span></span>
<span id="cb48-174"><a href="#cb48-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-175"><a href="#cb48-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-176"><a href="#cb48-176" aria-hidden="true" tabindex="-1"></a>################################</span>
<span id="cb48-177"><a href="#cb48-177" aria-hidden="true" tabindex="-1"></a><span class="fu">### Survival comparison</span></span>
<span id="cb48-180"><a href="#cb48-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-181"><a href="#cb48-181" aria-hidden="true" tabindex="-1"></a>getBetas <span class="ot">&lt;-</span> <span class="cf">function</span>(d) {</span>
<span id="cb48-182"><a href="#cb48-182" aria-hidden="true" tabindex="-1"></a>  <span class="co">#betaFlow</span></span>
<span id="cb48-183"><a href="#cb48-183" aria-hidden="true" tabindex="-1"></a>  betaFlow <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb48-184"><a href="#cb48-184" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt</span><span class="sc">\\</span><span class="st">["</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb48-185"><a href="#cb48-185" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb48-186"><a href="#cb48-186" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> <span class="st">"flow"</span>,</span>
<span id="cb48-187"><a href="#cb48-187" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+), ([0-9]+), ([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>)[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb48-188"><a href="#cb48-188" aria-hidden="true" tabindex="-1"></a>      <span class="at">param =</span> tmp<span class="sc">$</span>V1,</span>
<span id="cb48-189"><a href="#cb48-189" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb48-190"><a href="#cb48-190" aria-hidden="true" tabindex="-1"></a>      <span class="at">season =</span> tmp<span class="sc">$</span>V3</span>
<span id="cb48-191"><a href="#cb48-191" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-192"><a href="#cb48-192" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp)</span>
<span id="cb48-193"><a href="#cb48-193" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-194"><a href="#cb48-194" aria-hidden="true" tabindex="-1"></a>  betaFlowYOY <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb48-195"><a href="#cb48-195" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowYOY"</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb48-196"><a href="#cb48-196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb48-197"><a href="#cb48-197" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> <span class="st">"flow"</span>,</span>
<span id="cb48-198"><a href="#cb48-198" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+), ([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>)[, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb48-199"><a href="#cb48-199" aria-hidden="true" tabindex="-1"></a>      <span class="at">param =</span> tmp<span class="sc">$</span>V1,</span>
<span id="cb48-200"><a href="#cb48-200" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb48-201"><a href="#cb48-201" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-202"><a href="#cb48-202" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp)</span>
<span id="cb48-203"><a href="#cb48-203" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-204"><a href="#cb48-204" aria-hidden="true" tabindex="-1"></a>  betaFlowTop <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb48-205"><a href="#cb48-205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowTop"</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb48-206"><a href="#cb48-206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb48-207"><a href="#cb48-207" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> <span class="st">"flow"</span>,</span>
<span id="cb48-208"><a href="#cb48-208" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb48-209"><a href="#cb48-209" aria-hidden="true" tabindex="-1"></a>      <span class="at">param =</span> tmp<span class="sc">$</span>V2</span>
<span id="cb48-210"><a href="#cb48-210" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-211"><a href="#cb48-211" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp)</span>
<span id="cb48-212"><a href="#cb48-212" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-213"><a href="#cb48-213" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-214"><a href="#cb48-214" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-215"><a href="#cb48-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-216"><a href="#cb48-216" aria-hidden="true" tabindex="-1"></a>getBetaIntOuts <span class="ot">&lt;-</span> <span class="cf">function</span>(d, <span class="at">dataType =</span> <span class="st">"flow"</span>) {</span>
<span id="cb48-217"><a href="#cb48-217" aria-hidden="true" tabindex="-1"></a>  <span class="co">#betaFlow</span></span>
<span id="cb48-218"><a href="#cb48-218" aria-hidden="true" tabindex="-1"></a>  betaInt <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb48-219"><a href="#cb48-219" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntOut</span><span class="sc">\\</span><span class="st">["</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb48-220"><a href="#cb48-220" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb48-221"><a href="#cb48-221" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> dataType,</span>
<span id="cb48-222"><a href="#cb48-222" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+), ([0-9]+), ([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>)[, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb48-223"><a href="#cb48-223" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V1,</span>
<span id="cb48-224"><a href="#cb48-224" aria-hidden="true" tabindex="-1"></a>      <span class="at">season =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb48-225"><a href="#cb48-225" aria-hidden="true" tabindex="-1"></a>      <span class="at">cohort =</span> tmp<span class="sc">$</span>V3,</span>
<span id="cb48-226"><a href="#cb48-226" aria-hidden="true" tabindex="-1"></a>      <span class="at">varName =</span> <span class="st">"betaInt"</span></span>
<span id="cb48-227"><a href="#cb48-227" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-228"><a href="#cb48-228" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp) <span class="sc">%&gt;%</span></span>
<span id="cb48-229"><a href="#cb48-229" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(season <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> isYOY <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb48-230"><a href="#cb48-230" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-231"><a href="#cb48-231" aria-hidden="true" tabindex="-1"></a>  betaIntYOY <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb48-232"><a href="#cb48-232" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYOut</span><span class="sc">\\</span><span class="st">["</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb48-233"><a href="#cb48-233" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb48-234"><a href="#cb48-234" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> dataType,</span>
<span id="cb48-235"><a href="#cb48-235" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb48-236"><a href="#cb48-236" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb48-237"><a href="#cb48-237" aria-hidden="true" tabindex="-1"></a>      <span class="at">varName =</span> <span class="st">"betaIntYOY"</span></span>
<span id="cb48-238"><a href="#cb48-238" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-239"><a href="#cb48-239" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp)</span>
<span id="cb48-240"><a href="#cb48-240" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-241"><a href="#cb48-241" aria-hidden="true" tabindex="-1"></a>  betaIntYOYSeason <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb48-242"><a href="#cb48-242" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeasonOut</span><span class="sc">\\</span><span class="st">["</span>, var)) <span class="sc">%&gt;%</span></span>
<span id="cb48-243"><a href="#cb48-243" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb48-244"><a href="#cb48-244" aria-hidden="true" tabindex="-1"></a>      <span class="at">flowData =</span> dataType,</span>
<span id="cb48-245"><a href="#cb48-245" aria-hidden="true" tabindex="-1"></a>      <span class="at">tmp =</span> <span class="fu">str_match</span>(var, <span class="st">"</span><span class="sc">\\</span><span class="st">[([0-9]+), ([0-9]+)</span><span class="sc">\\</span><span class="st">]"</span>)[, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>(),</span>
<span id="cb48-246"><a href="#cb48-246" aria-hidden="true" tabindex="-1"></a>      <span class="at">isYOY =</span> tmp<span class="sc">$</span>V1,</span>
<span id="cb48-247"><a href="#cb48-247" aria-hidden="true" tabindex="-1"></a>      <span class="at">season =</span> tmp<span class="sc">$</span>V2,</span>
<span id="cb48-248"><a href="#cb48-248" aria-hidden="true" tabindex="-1"></a>      <span class="at">varName =</span> <span class="st">"betaIntYOYSeason"</span></span>
<span id="cb48-249"><a href="#cb48-249" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb48-250"><a href="#cb48-250" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>tmp) <span class="sc">%&gt;%</span></span>
<span id="cb48-251"><a href="#cb48-251" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(season <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> isYOY <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb48-252"><a href="#cb48-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-253"><a href="#cb48-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(</span>
<span id="cb48-254"><a href="#cb48-254" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bind_rows</span>(betaInt, betaIntYOY, betaIntYOYSeason) <span class="sc">%&gt;%</span></span>
<span id="cb48-255"><a href="#cb48-255" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">cohort =</span> <span class="fu">as.numeric</span>(cohort) <span class="sc">+</span> <span class="dv">2002</span> <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb48-256"><a href="#cb48-256" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb48-257"><a href="#cb48-257" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-258"><a href="#cb48-258" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-259"><a href="#cb48-259" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-260"><a href="#cb48-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-261"><a href="#cb48-261" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Get betaIntOut estimates</span></span>
<span id="cb48-264"><a href="#cb48-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-265"><a href="#cb48-265" aria-hidden="true" tabindex="-1"></a>betaIntFlow <span class="ot">&lt;-</span> <span class="fu">getBetaIntOuts</span>(summary_flow, <span class="st">"flow"</span>)</span>
<span id="cb48-266"><a href="#cb48-266" aria-hidden="true" tabindex="-1"></a>betaIntFlowByRiver <span class="ot">&lt;-</span> <span class="fu">getBetaIntOuts</span>(summary_flowByRiver, <span class="st">"flowByRiver"</span>)</span>
<span id="cb48-267"><a href="#cb48-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-268"><a href="#cb48-268" aria-hidden="true" tabindex="-1"></a>betaInts <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(betaIntFlow, betaIntFlowByRiver) <span class="sc">%&gt;%</span></span>
<span id="cb48-269"><a href="#cb48-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lo =</span> <span class="st">'2.5%'</span>, <span class="at">hi =</span> <span class="st">'97.5%'</span>)</span>
<span id="cb48-270"><a href="#cb48-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-271"><a href="#cb48-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-274"><a href="#cb48-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-275"><a href="#cb48-275" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the facet labeller function</span></span>
<span id="cb48-276"><a href="#cb48-276" aria-hidden="true" tabindex="-1"></a>labelsIntYOY <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb48-277"><a href="#cb48-277" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Growth year 1"</span>,</span>
<span id="cb48-278"><a href="#cb48-278" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Growth year 2"</span></span>
<span id="cb48-279"><a href="#cb48-279" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-280"><a href="#cb48-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-281"><a href="#cb48-281" aria-hidden="true" tabindex="-1"></a>labelsIntSeason <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb48-282"><a href="#cb48-282" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"Spring"</span>,</span>
<span id="cb48-283"><a href="#cb48-283" aria-hidden="true" tabindex="-1"></a>  <span class="st">"2"</span> <span class="ot">=</span> <span class="st">"Summer"</span>,</span>
<span id="cb48-284"><a href="#cb48-284" aria-hidden="true" tabindex="-1"></a>  <span class="st">"3"</span> <span class="ot">=</span> <span class="st">"Autumn"</span>,</span>
<span id="cb48-285"><a href="#cb48-285" aria-hidden="true" tabindex="-1"></a>  <span class="st">"4"</span> <span class="ot">=</span> <span class="st">"Winter"</span></span>
<span id="cb48-286"><a href="#cb48-286" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-287"><a href="#cb48-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-288"><a href="#cb48-288" aria-hidden="true" tabindex="-1"></a>global_labellerInt <span class="ot">&lt;-</span> <span class="fu">labeller</span>(</span>
<span id="cb48-289"><a href="#cb48-289" aria-hidden="true" tabindex="-1"></a>  <span class="at">isYOY =</span> labelsIntYOY,</span>
<span id="cb48-290"><a href="#cb48-290" aria-hidden="true" tabindex="-1"></a>  <span class="at">season =</span> labelsIntSeason</span>
<span id="cb48-291"><a href="#cb48-291" aria-hidden="true" tabindex="-1"></a>  <span class="co">#.default = label_both</span></span>
<span id="cb48-292"><a href="#cb48-292" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-293"><a href="#cb48-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-294"><a href="#cb48-294" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(betaInts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(varName <span class="sc">==</span> <span class="st">"betaInt"</span>), <span class="fu">aes</span>(cohort, mean, <span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-295"><a href="#cb48-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-296"><a href="#cb48-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(cohort, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-297"><a href="#cb48-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="st">"Cohort"</span>) <span class="sc">+</span>  </span>
<span id="cb48-298"><a href="#cb48-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Suvrival"</span>) <span class="sc">+</span></span>
<span id="cb48-299"><a href="#cb48-299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season<span class="sc">~</span>isYOY, <span class="at">labeller =</span> global_labellerInt) <span class="sc">+</span></span>
<span id="cb48-300"><a href="#cb48-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb48-301"><a href="#cb48-301" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Data source"</span></span>
<span id="cb48-302"><a href="#cb48-302" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb48-303"><a href="#cb48-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-304"><a href="#cb48-304" aria-hidden="true" tabindex="-1"></a>global_labellerIntYOYSeason <span class="ot">&lt;-</span> <span class="fu">labeller</span>(</span>
<span id="cb48-305"><a href="#cb48-305" aria-hidden="true" tabindex="-1"></a>  <span class="at">isYOY =</span> labelsIntYOY</span>
<span id="cb48-306"><a href="#cb48-306" aria-hidden="true" tabindex="-1"></a> <span class="co"># season = labelsIntSeason</span></span>
<span id="cb48-307"><a href="#cb48-307" aria-hidden="true" tabindex="-1"></a>  <span class="co">#.default = label_both</span></span>
<span id="cb48-308"><a href="#cb48-308" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-309"><a href="#cb48-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-310"><a href="#cb48-310" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(betaInts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(varName <span class="sc">==</span> <span class="st">"betaIntYOYSeason"</span>), <span class="fu">aes</span>(season, mean, <span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-311"><a href="#cb48-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-312"><a href="#cb48-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(season, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-313"><a href="#cb48-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="st">"Season"</span>) <span class="sc">+</span>  </span>
<span id="cb48-314"><a href="#cb48-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="st">"Suvrival"</span>) <span class="sc">+</span></span>
<span id="cb48-315"><a href="#cb48-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>isYOY, <span class="at">labeller =</span> global_labellerIntYOYSeason) <span class="sc">+</span></span>
<span id="cb48-316"><a href="#cb48-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(</span>
<span id="cb48-317"><a href="#cb48-317" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Data source"</span></span>
<span id="cb48-318"><a href="#cb48-318" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb48-319"><a href="#cb48-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-320"><a href="#cb48-320" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(betaInts <span class="sc">%&gt;%</span> <span class="fu">filter</span>(varName <span class="sc">==</span> <span class="st">"betaIntYOY"</span>), <span class="fu">aes</span>(isYOY, mean, <span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb48-321"><a href="#cb48-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-322"><a href="#cb48-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(isYOY, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>))</span>
<span id="cb48-323"><a href="#cb48-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-324"><a href="#cb48-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-325"><a href="#cb48-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-326"><a href="#cb48-326" aria-hidden="true" tabindex="-1"></a>################################</span>
<span id="cb48-327"><a href="#cb48-327" aria-hidden="true" tabindex="-1"></a><span class="fu">### Flow_YOYSeason predictions</span></span>
<span id="cb48-328"><a href="#cb48-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-331"><a href="#cb48-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-332"><a href="#cb48-332" aria-hidden="true" tabindex="-1"></a>getPredictions_FlowYOYSeasonCohort <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb48-333"><a href="#cb48-333" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-334"><a href="#cb48-334" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb48-335"><a href="#cb48-335" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaInt</span></span>
<span id="cb48-336"><a href="#cb48-336" aria-hidden="true" tabindex="-1"></a>  predictorsBetaInt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb48-337"><a href="#cb48-337" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb48-338"><a href="#cb48-338" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb48-339"><a href="#cb48-339" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb48-340"><a href="#cb48-340" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nCohorts</span>
<span id="cb48-341"><a href="#cb48-341" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-342"><a href="#cb48-342" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-343"><a href="#cb48-343" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaInt)){</span>
<span id="cb48-344"><a href="#cb48-344" aria-hidden="true" tabindex="-1"></a>    predictorsBetaInt<span class="sc">$</span>betaInt[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaInt[i, <span class="st">"iter"</span>], </span>
<span id="cb48-345"><a href="#cb48-345" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">paste0</span>(<span class="st">"betaInt["</span>, predictorsBetaInt[i, <span class="st">"isYOY"</span>],</span>
<span id="cb48-346"><a href="#cb48-346" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"season"</span>],</span>
<span id="cb48-347"><a href="#cb48-347" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"cohort"</span>],</span>
<span id="cb48-348"><a href="#cb48-348" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"]"</span>)</span>
<span id="cb48-349"><a href="#cb48-349" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb48-350"><a href="#cb48-350" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-351"><a href="#cb48-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-352"><a href="#cb48-352" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ## betaPhi</span></span>
<span id="cb48-353"><a href="#cb48-353" aria-hidden="true" tabindex="-1"></a>  <span class="co"># predictorsBetaPhi &lt;- expand.grid(</span></span>
<span id="cb48-354"><a href="#cb48-354" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   iter = seq(1, dim(mcmc$chain1)[1], everyNIters),</span></span>
<span id="cb48-355"><a href="#cb48-355" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   isYOY = 1:2,</span></span>
<span id="cb48-356"><a href="#cb48-356" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   season = 1:toSave$myConstants$nSeasons,</span></span>
<span id="cb48-357"><a href="#cb48-357" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb48-358"><a href="#cb48-358" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb48-359"><a href="#cb48-359" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb48-360"><a href="#cb48-360" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for(i in 1:nrow(predictorsBetaPhi)){</span></span>
<span id="cb48-361"><a href="#cb48-361" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   predictorsBetaPhi$betaPhi[i] &lt;- mcmc$chain1[[predictorsBetaPhi[i, "iter"], </span></span>
<span id="cb48-362"><a href="#cb48-362" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                paste0("betaPhi[", predictorsBetaPhi[i, "isYOY"],</span></span>
<span id="cb48-363"><a href="#cb48-363" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       ", ",       predictorsBetaPhi[i, "season"],</span></span>
<span id="cb48-364"><a href="#cb48-364" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       ", ",       predictorsBetaPhi[i, "cohort"],</span></span>
<span id="cb48-365"><a href="#cb48-365" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       "]")</span></span>
<span id="cb48-366"><a href="#cb48-366" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ]]</span></span>
<span id="cb48-367"><a href="#cb48-367" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb48-368"><a href="#cb48-368" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-369"><a href="#cb48-369" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb48-370"><a href="#cb48-370" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlow <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb48-371"><a href="#cb48-371" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb48-372"><a href="#cb48-372" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb48-373"><a href="#cb48-373" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb48-374"><a href="#cb48-374" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb48-375"><a href="#cb48-375" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-376"><a href="#cb48-376" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-377"><a href="#cb48-377" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlow)){</span>
<span id="cb48-378"><a href="#cb48-378" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb48-379"><a href="#cb48-379" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[1, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb48-380"><a href="#cb48-380" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb48-381"><a href="#cb48-381" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co">#     ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb48-382"><a href="#cb48-382" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb48-383"><a href="#cb48-383" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb48-384"><a href="#cb48-384" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb48-385"><a href="#cb48-385" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[2, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb48-386"><a href="#cb48-386" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb48-387"><a href="#cb48-387" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb48-388"><a href="#cb48-388" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb48-389"><a href="#cb48-389" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb48-390"><a href="#cb48-390" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-391"><a href="#cb48-391" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb48-392"><a href="#cb48-392" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[3, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb48-393"><a href="#cb48-393" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb48-394"><a href="#cb48-394" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb48-395"><a href="#cb48-395" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb48-396"><a href="#cb48-396" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb48-397"><a href="#cb48-397" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-398"><a href="#cb48-398" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-399"><a href="#cb48-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-400"><a href="#cb48-400" aria-hidden="true" tabindex="-1"></a>  predictorsAll <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb48-401"><a href="#cb48-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb48-402"><a href="#cb48-402" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb48-403"><a href="#cb48-403" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nCohorts,</span>
<span id="cb48-404"><a href="#cb48-404" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb48-405"><a href="#cb48-405" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb48-406"><a href="#cb48-406" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb48-407"><a href="#cb48-407" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-408"><a href="#cb48-408" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-409"><a href="#cb48-409" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsAll <span class="sc">%&gt;%</span></span>
<span id="cb48-410"><a href="#cb48-410" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaInt) <span class="sc">%&gt;%</span></span>
<span id="cb48-411"><a href="#cb48-411" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaFlow) <span class="sc">%&gt;%</span></span>
<span id="cb48-412"><a href="#cb48-412" aria-hidden="true" tabindex="-1"></a> <span class="co">#   left_join(predictorsBetaPhi) %&gt;%</span></span>
<span id="cb48-413"><a href="#cb48-413" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaInt <span class="sc">+</span> betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb48-414"><a href="#cb48-414" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-415"><a href="#cb48-415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb48-416"><a href="#cb48-416" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-417"><a href="#cb48-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-418"><a href="#cb48-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-419"><a href="#cb48-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-420"><a href="#cb48-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-423"><a href="#cb48-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-424"><a href="#cb48-424" aria-hidden="true" tabindex="-1"></a>getPredictions_FlowYOYSeason <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb48-425"><a href="#cb48-425" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-426"><a href="#cb48-426" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb48-427"><a href="#cb48-427" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaInt</span></span>
<span id="cb48-428"><a href="#cb48-428" aria-hidden="true" tabindex="-1"></a>  predictorsBetaInt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb48-429"><a href="#cb48-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb48-430"><a href="#cb48-430" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb48-431"><a href="#cb48-431" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb48-432"><a href="#cb48-432" aria-hidden="true" tabindex="-1"></a><span class="co">#    cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb48-433"><a href="#cb48-433" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-434"><a href="#cb48-434" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-435"><a href="#cb48-435" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaInt)){</span>
<span id="cb48-436"><a href="#cb48-436" aria-hidden="true" tabindex="-1"></a>    predictorsBetaInt<span class="sc">$</span>betaInt[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaInt[i, <span class="st">"iter"</span>], </span>
<span id="cb48-437"><a href="#cb48-437" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">paste0</span>(<span class="st">"betaIntYOYSeason["</span>, predictorsBetaInt[i, <span class="st">"isYOY"</span>],</span>
<span id="cb48-438"><a href="#cb48-438" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"season"</span>],</span>
<span id="cb48-439"><a href="#cb48-439" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#      ", ",       predictorsBetaInt[i, "cohort"],</span></span>
<span id="cb48-440"><a href="#cb48-440" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"]"</span>)</span>
<span id="cb48-441"><a href="#cb48-441" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb48-442"><a href="#cb48-442" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-443"><a href="#cb48-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-444"><a href="#cb48-444" aria-hidden="true" tabindex="-1"></a><span class="co">#   ## betaPhi</span></span>
<span id="cb48-445"><a href="#cb48-445" aria-hidden="true" tabindex="-1"></a><span class="co">#   predictorsBetaPhi &lt;- expand.grid(</span></span>
<span id="cb48-446"><a href="#cb48-446" aria-hidden="true" tabindex="-1"></a><span class="co">#     iter = seq(1, dim(mcmc$chain1)[1], everyNIters),</span></span>
<span id="cb48-447"><a href="#cb48-447" aria-hidden="true" tabindex="-1"></a><span class="co">#     isYOY = 1:2,</span></span>
<span id="cb48-448"><a href="#cb48-448" aria-hidden="true" tabindex="-1"></a><span class="co">#     season = 1:toSave$myConstants$nSeasons</span></span>
<span id="cb48-449"><a href="#cb48-449" aria-hidden="true" tabindex="-1"></a><span class="co"># #    cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb48-450"><a href="#cb48-450" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb48-451"><a href="#cb48-451" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb48-452"><a href="#cb48-452" aria-hidden="true" tabindex="-1"></a><span class="co">#   for(i in 1:nrow(predictorsBetaPhi)){</span></span>
<span id="cb48-453"><a href="#cb48-453" aria-hidden="true" tabindex="-1"></a><span class="co">#     predictorsBetaPhi$betaPhi[i] &lt;- mcmc$chain1[[predictorsBetaPhi[i, "iter"], </span></span>
<span id="cb48-454"><a href="#cb48-454" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                  paste0("betaPhiYOYSeason[", predictorsBetaPhi[i, "isYOY"],</span></span>
<span id="cb48-455"><a href="#cb48-455" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         ", ",       predictorsBetaPhi[i, "season"],</span></span>
<span id="cb48-456"><a href="#cb48-456" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   #      ", ",       predictorsBetaPhi[i, "cohort"],</span></span>
<span id="cb48-457"><a href="#cb48-457" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         "]")</span></span>
<span id="cb48-458"><a href="#cb48-458" aria-hidden="true" tabindex="-1"></a><span class="co">#     ]]</span></span>
<span id="cb48-459"><a href="#cb48-459" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb48-460"><a href="#cb48-460" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-461"><a href="#cb48-461" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb48-462"><a href="#cb48-462" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlow <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb48-463"><a href="#cb48-463" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb48-464"><a href="#cb48-464" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb48-465"><a href="#cb48-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb48-466"><a href="#cb48-466" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb48-467"><a href="#cb48-467" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-468"><a href="#cb48-468" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-469"><a href="#cb48-469" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlow)){</span>
<span id="cb48-470"><a href="#cb48-470" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb48-471"><a href="#cb48-471" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[1, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb48-472"><a href="#cb48-472" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb48-473"><a href="#cb48-473" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co">#     ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb48-474"><a href="#cb48-474" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb48-475"><a href="#cb48-475" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb48-476"><a href="#cb48-476" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb48-477"><a href="#cb48-477" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[2, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb48-478"><a href="#cb48-478" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb48-479"><a href="#cb48-479" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb48-480"><a href="#cb48-480" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb48-481"><a href="#cb48-481" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb48-482"><a href="#cb48-482" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-483"><a href="#cb48-483" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb48-484"><a href="#cb48-484" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[3, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb48-485"><a href="#cb48-485" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb48-486"><a href="#cb48-486" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb48-487"><a href="#cb48-487" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb48-488"><a href="#cb48-488" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb48-489"><a href="#cb48-489" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-490"><a href="#cb48-490" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-491"><a href="#cb48-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-492"><a href="#cb48-492" aria-hidden="true" tabindex="-1"></a>  predictorsAll <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb48-493"><a href="#cb48-493" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb48-494"><a href="#cb48-494" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb48-495"><a href="#cb48-495" aria-hidden="true" tabindex="-1"></a>   <span class="co"># cohort = 1:toSave$myConstants$nCohorts,</span></span>
<span id="cb48-496"><a href="#cb48-496" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb48-497"><a href="#cb48-497" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb48-498"><a href="#cb48-498" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb48-499"><a href="#cb48-499" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-500"><a href="#cb48-500" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-501"><a href="#cb48-501" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsAll <span class="sc">%&gt;%</span></span>
<span id="cb48-502"><a href="#cb48-502" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaInt) <span class="sc">%&gt;%</span></span>
<span id="cb48-503"><a href="#cb48-503" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaFlow) <span class="sc">%&gt;%</span></span>
<span id="cb48-504"><a href="#cb48-504" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  left_join(predictorsBetaPhi) %&gt;%</span></span>
<span id="cb48-505"><a href="#cb48-505" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaInt <span class="sc">+</span> betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb48-506"><a href="#cb48-506" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-507"><a href="#cb48-507" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb48-508"><a href="#cb48-508" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-509"><a href="#cb48-509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-510"><a href="#cb48-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-513"><a href="#cb48-513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-514"><a href="#cb48-514" aria-hidden="true" tabindex="-1"></a>predFlowYOYSeason <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeason</span>(out_flow, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-515"><a href="#cb48-515" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) </span>
<span id="cb48-516"><a href="#cb48-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-517"><a href="#cb48-517" aria-hidden="true" tabindex="-1"></a>predFlowByRiverYOYSeason <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeason</span>(out_flowByRiver, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-518"><a href="#cb48-518" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>)</span>
<span id="cb48-519"><a href="#cb48-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-520"><a href="#cb48-520" aria-hidden="true" tabindex="-1"></a>predBoth <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(predFlowYOYSeason, predFlowByRiverYOYSeason)</span>
<span id="cb48-521"><a href="#cb48-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-522"><a href="#cb48-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-523"><a href="#cb48-523" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Graph flow predictions  </span></span>
<span id="cb48-524"><a href="#cb48-524" aria-hidden="true" tabindex="-1"></a>Predictions based on flow from the flow extension curve - original approach</span>
<span id="cb48-527"><a href="#cb48-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-528"><a href="#cb48-528" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb48-529"><a href="#cb48-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-530"><a href="#cb48-530" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb48-531"><a href="#cb48-531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb48-532"><a href="#cb48-532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb48-533"><a href="#cb48-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb48-534"><a href="#cb48-534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span>
<span id="cb48-535"><a href="#cb48-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-536"><a href="#cb48-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-537"><a href="#cb48-537" aria-hidden="true" tabindex="-1"></a>Predictions based on flow from flowByRiver</span>
<span id="cb48-540"><a href="#cb48-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-541"><a href="#cb48-541" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowByRiverYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb48-542"><a href="#cb48-542" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb48-543"><a href="#cb48-543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb48-544"><a href="#cb48-544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb48-545"><a href="#cb48-545" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span>
<span id="cb48-546"><a href="#cb48-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-547"><a href="#cb48-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-548"><a href="#cb48-548" aria-hidden="true" tabindex="-1"></a>Similar format to to the 2015 paper</span>
<span id="cb48-551"><a href="#cb48-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-552"><a href="#cb48-552" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>)</span>
<span id="cb48-553"><a href="#cb48-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-554"><a href="#cb48-554" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flow <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(temp, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,flow, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb48-555"><a href="#cb48-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(flow)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb48-556"><a href="#cb48-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb48-557"><a href="#cb48-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">alpha =</span> <span class="dv">1</span>))) <span class="sc">+</span></span>
<span id="cb48-558"><a href="#cb48-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span>
<span id="cb48-559"><a href="#cb48-559" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-560"><a href="#cb48-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-561"><a href="#cb48-561" aria-hidden="true" tabindex="-1"></a>####################################</span>
<span id="cb48-562"><a href="#cb48-562" aria-hidden="true" tabindex="-1"></a><span class="fu">### Flow_YOYSeasonCohort predictions</span></span>
<span id="cb48-565"><a href="#cb48-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-566"><a href="#cb48-566" aria-hidden="true" tabindex="-1"></a>predFlowYOYSeasonCohort <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeasonCohort</span>(out_flow, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-567"><a href="#cb48-567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) </span>
<span id="cb48-568"><a href="#cb48-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-569"><a href="#cb48-569" aria-hidden="true" tabindex="-1"></a>predFlowByRiverYOYSeasonCohort <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeasonCohort</span>(out_flowByRiver, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-570"><a href="#cb48-570" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>)</span>
<span id="cb48-571"><a href="#cb48-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-572"><a href="#cb48-572" aria-hidden="true" tabindex="-1"></a>predBoth <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(predFlowYOYSeasonCohort, predFlowByRiverYOYSeasonCohort)</span>
<span id="cb48-573"><a href="#cb48-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-574"><a href="#cb48-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-575"><a href="#cb48-575" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Graph flow predictions  </span></span>
<span id="cb48-576"><a href="#cb48-576" aria-hidden="true" tabindex="-1"></a>Predictions based on flow from the flow extension curve - original approach</span>
<span id="cb48-579"><a href="#cb48-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-580"><a href="#cb48-580" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb48-581"><a href="#cb48-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-582"><a href="#cb48-582" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb48-583"><a href="#cb48-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb48-584"><a href="#cb48-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb48-585"><a href="#cb48-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY <span class="sc">+</span> cohort)</span>
<span id="cb48-586"><a href="#cb48-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-587"><a href="#cb48-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-588"><a href="#cb48-588" aria-hidden="true" tabindex="-1"></a>Predictions based on flow from flowByRiver</span>
<span id="cb48-591"><a href="#cb48-591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-592"><a href="#cb48-592" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowByRiverYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb48-593"><a href="#cb48-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb48-594"><a href="#cb48-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb48-595"><a href="#cb48-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY <span class="sc">+</span> cohort)</span>
<span id="cb48-596"><a href="#cb48-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-597"><a href="#cb48-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-598"><a href="#cb48-598" aria-hidden="true" tabindex="-1"></a>Similar format to to the 2015 paper</span>
<span id="cb48-601"><a href="#cb48-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-602"><a href="#cb48-602" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flow <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(temp, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,flow,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb48-603"><a href="#cb48-603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(flow)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb48-604"><a href="#cb48-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb48-605"><a href="#cb48-605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span>
<span id="cb48-606"><a href="#cb48-606" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-607"><a href="#cb48-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-608"><a href="#cb48-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-609"><a href="#cb48-609" aria-hidden="true" tabindex="-1"></a>#####################################</span>
<span id="cb48-610"><a href="#cb48-610" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FlowTop predictions</span></span>
<span id="cb48-613"><a href="#cb48-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-614"><a href="#cb48-614" aria-hidden="true" tabindex="-1"></a><span class="co"># predFlowTop &lt;- getPredictionsFlowTop(out_flow, everyNIters = 5) %&gt;%</span></span>
<span id="cb48-615"><a href="#cb48-615" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(flowData = "flow") </span></span>
<span id="cb48-616"><a href="#cb48-616" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb48-617"><a href="#cb48-617" aria-hidden="true" tabindex="-1"></a><span class="co"># predFlowByRiverTop &lt;- getPredictionsFlowTop(out_flowByRiver, everyNIters = 5) %&gt;%</span></span>
<span id="cb48-618"><a href="#cb48-618" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(flowData = "flowByRiver")</span></span>
<span id="cb48-619"><a href="#cb48-619" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb48-620"><a href="#cb48-620" aria-hidden="true" tabindex="-1"></a><span class="co"># predTopBoth &lt;- bind_rows(predFlowTop, predFlowByRiverTop)</span></span>
<span id="cb48-621"><a href="#cb48-621" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-622"><a href="#cb48-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-625"><a href="#cb48-625" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-626"><a href="#cb48-626" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(predTopBoth, aes(flow, predPhi, group = iter)) +</span></span>
<span id="cb48-627"><a href="#cb48-627" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb48-628"><a href="#cb48-628" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~flowData)</span></span>
<span id="cb48-629"><a href="#cb48-629" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb48-630"><a href="#cb48-630" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(predTopBoth %&gt;% filter(iter &lt; 100), aes(flow, predPhi, group = iter)) +</span></span>
<span id="cb48-631"><a href="#cb48-631" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb48-632"><a href="#cb48-632" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(flowData ~ iter)</span></span>
<span id="cb48-633"><a href="#cb48-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb48-634"><a href="#cb48-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-635"><a href="#cb48-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-638"><a href="#cb48-638" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb48-639"><a href="#cb48-639" aria-hidden="true" tabindex="-1"></a>getPredictionsFlowTop <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb48-640"><a href="#cb48-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-641"><a href="#cb48-641" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb48-642"><a href="#cb48-642" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-643"><a href="#cb48-643" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb48-644"><a href="#cb48-644" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlowTop <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb48-645"><a href="#cb48-645" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb48-646"><a href="#cb48-646" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb48-647"><a href="#cb48-647" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb48-648"><a href="#cb48-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb48-649"><a href="#cb48-649" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-650"><a href="#cb48-650" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-651"><a href="#cb48-651" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlowTop)){</span>
<span id="cb48-652"><a href="#cb48-652" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb48-653"><a href="#cb48-653" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">1</span></span>
<span id="cb48-654"><a href="#cb48-654" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb48-655"><a href="#cb48-655" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb48-656"><a href="#cb48-656" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">2</span></span>
<span id="cb48-657"><a href="#cb48-657" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb48-658"><a href="#cb48-658" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb48-659"><a href="#cb48-659" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">3</span></span>
<span id="cb48-660"><a href="#cb48-660" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb48-661"><a href="#cb48-661" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-662"><a href="#cb48-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-663"><a href="#cb48-663" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsBetaFlowTop <span class="sc">%&gt;%</span></span>
<span id="cb48-664"><a href="#cb48-664" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb48-665"><a href="#cb48-665" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb48-666"><a href="#cb48-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb48-667"><a href="#cb48-667" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-668"><a href="#cb48-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-669"><a href="#cb48-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>