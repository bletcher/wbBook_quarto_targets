<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The West Brook story - 12&nbsp; Flow effects on survival (phi) models - O’Bear only</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./modelsCMR_Flow_4Rivers.html" rel="next">
<link href="./modelsCMR_ft_Flow_OB.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - O’Bear only</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The West Brook story</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vizTargets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Visualize targets</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Get data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getData.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Get data info</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataEnv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Get environmental data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataElectro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Get electrofishing data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataCMR.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Create Capture-Recapture data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataWanding.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Get wanding data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getDataAntenna.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Get antenna data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">All data</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataAll.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">All data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">General models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelYOY.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Young-of-year size model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelFlow.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Flow model</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Capture-recpature models</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelsCMR_ft_Flow_OB.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - O’Bear only</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelsCMR_ft_cohort_Flow_OB.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - O’Bear only</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modelsCMR_Flow_4Rivers.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - 4 rivers</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#model-phit_pt-flow-tt_ob_flow" id="toc-model-phit_pt-flow-tt_ob_flow" class="nav-link active" data-scroll-target="#model-phit_pt-flow-tt_ob_flow"><span class="toc-section-number">12.0.1</span>  Model phiT_pT flow (tt_OB_flow)</a></li>
  <li><a href="#model-phit_pt-flow-byriver-tt_ob_flowbyriver" id="toc-model-phit_pt-flow-byriver-tt_ob_flowbyriver" class="nav-link" data-scroll-target="#model-phit_pt-flow-byriver-tt_ob_flowbyriver"><span class="toc-section-number">12.0.2</span>  Model phiT_pT flow ByRiver (tt_OB_flowByRiver)</a></li>
  <li><a href="#flow_yoyseason-predictions" id="toc-flow_yoyseason-predictions" class="nav-link" data-scroll-target="#flow_yoyseason-predictions"><span class="toc-section-number">12.0.3</span>  Flow_YOYSeason predictions</a></li>
  <li><a href="#flow_yoyseasoncohort-predictions" id="toc-flow_yoyseasoncohort-predictions" class="nav-link" data-scroll-target="#flow_yoyseasoncohort-predictions"><span class="toc-section-number">12.0.4</span>  Flow_YOYSeasonCohort predictions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title d-none d-lg-block"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - O’Bear only</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The goal of this modelling exercise is to evaluate the effect of new tributary-specific stream flow estimates on survival of brook trout and brown trout. We will compare survival across the WB and tributaries with flow input data as 1) single flow estimate for all locations (historical approach) and 2) hindcasted flows for each tributary based on new tributary-specific flows which are available since 2000.</p>
<p>The goal is to find the best structure for the survival model, then compare survival estimates with tributary-specific flow to estimates with common flow across locations.</p>
<p>Structure options include [species, cohort, season, isYOY, flow, flow^2]</p>
<div class="cell">

</div>
<section id="model-phit_pt-flow-tt_ob_flow" class="level3" data-number="12.0.1">
<h3 data-number="12.0.1" class="anchored" data-anchor-id="model-phit_pt-flow-tt_ob_flow"><span class="header-section-number">12.0.1</span> Model phiT_pT flow (tt_OB_flow)</h3>
<p>Cohort-dependent estimates of phi and p with flow and temperature hierarchical effects</p>
<section id="retrieve-model-results" class="level4" data-number="12.0.1.1">
<h4 data-number="12.0.1.1" class="anchored" data-anchor-id="retrieve-model-results"><span class="header-section-number">12.0.1.1</span> Retrieve model results</h4>
<p>Model is run using targets in R/modelCMR_tt_OB.R</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following https://oliviergimenez.github.io/bayesian-cr-workshop/worksheets/4_demo.html</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  out_flow <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(tt_modelOut_ft_cohort_OB_flow )</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCplot</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc, <span class="at">round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"var"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         var   mean    sd   2.5%    50% 97.5% Rhat n.eff
1     betaIntYOYSeason[1, 1]  0.820 0.392  0.066  0.810 1.613 1.00   963
2     betaIntYOYSeason[2, 1] -0.363 0.444 -1.212 -0.380 0.537 1.00   835
3     betaIntYOYSeason[1, 2]  1.433 1.164 -0.851  1.420 3.709 1.00  3474
4     betaIntYOYSeason[2, 2] -0.036 0.315 -0.666 -0.031 0.575 1.00  2318
5     betaIntYOYSeason[1, 3]  1.783 0.422  1.018  1.758 2.656 1.00   517
6     betaIntYOYSeason[2, 3]  1.031 0.343  0.383  1.026 1.708 1.00  1043
7     betaIntYOYSeason[1, 4]  2.408 0.504  1.515  2.367 3.496 1.01   462
8     betaIntYOYSeason[2, 4]  1.508 0.449  0.671  1.487 2.471 1.00   504
9  betaIntYOYSeasonOut[1, 1]  0.688 0.081  0.517  0.692 0.834 1.00  1004
10 betaIntYOYSeasonOut[2, 1]  0.414 0.104  0.229  0.406 0.631 1.00   841
11 betaIntYOYSeasonOut[1, 2]  0.758 0.183  0.299  0.805 0.976 1.00  3432
12 betaIntYOYSeasonOut[2, 2]  0.491 0.077  0.339  0.492 0.640 1.00  2319
13 betaIntYOYSeasonOut[1, 3]  0.849 0.052  0.735  0.853 0.934 1.00   604
14 betaIntYOYSeasonOut[2, 3]  0.732 0.066  0.595  0.736 0.847 1.00  1135
15 betaIntYOYSeasonOut[1, 4]  0.910 0.039  0.820  0.914 0.971 1.00   594
16 betaIntYOYSeasonOut[2, 4]  0.810 0.066  0.662  0.816 0.922 1.00   602
   flowData
1      flow
2      flow
3      flow
4      flow
5      flow
6      flow
7      flow
8      flow
9      flow
10     flow
11     flow
12     flow
13     flow
14     flow
15     flow
16     flow</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         var   mean    sd   2.5%    50% 97.5% Rhat n.eff
1     betaPhiYOYSeason[1, 1]  0.027 1.739 -3.367  0.050 3.374    1  4337
2     betaPhiYOYSeason[2, 1]  0.005 1.735 -3.415  0.031 3.335    1  4383
3     betaPhiYOYSeason[1, 2]  0.003 1.761 -3.424 -0.032 3.509    1  4000
4     betaPhiYOYSeason[2, 2]  0.008 1.730 -3.379  0.026 3.410    1  4000
5     betaPhiYOYSeason[1, 3] -0.012 1.747 -3.556 -0.025 3.392    1  4252
6     betaPhiYOYSeason[2, 3] -0.026 1.719 -3.309 -0.037 3.364    1  4000
7     betaPhiYOYSeason[1, 4] -0.012 1.735 -3.429 -0.021 3.333    1  4056
8     betaPhiYOYSeason[2, 4]  0.012 1.730 -3.328  0.005 3.340    1  4480
9  betaPhiYOYSeasonOut[1, 1]  0.506 0.293  0.033  0.513 0.967    1  4350
10 betaPhiYOYSeasonOut[2, 1]  0.502 0.292  0.032  0.508 0.966    1  4136
11 betaPhiYOYSeasonOut[1, 2]  0.499 0.295  0.032  0.492 0.971    1  4000
12 betaPhiYOYSeasonOut[2, 2]  0.502 0.293  0.033  0.506 0.968    1  4000
13 betaPhiYOYSeasonOut[1, 3]  0.499 0.292  0.028  0.494 0.967    1  4246
14 betaPhiYOYSeasonOut[2, 3]  0.495 0.293  0.035  0.491 0.967    1  4000
15 betaPhiYOYSeasonOut[1, 4]  0.497 0.294  0.031  0.495 0.966    1  4292
16 betaPhiYOYSeasonOut[2, 4]  0.502 0.293  0.035  0.501 0.966    1  4433
   flowData
1      flow
2      flow
3      flow
4      flow
5      flow
6      flow
7      flow
8      flow
9      flow
10     flow
11     flow
12     flow
13     flow
14     flow
15     flow
16     flow</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlow"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 var   mean    sd   2.5%    50%  97.5% Rhat n.eff flowData
1  betaFlow[1, 1, 1]  0.311 0.503 -0.635  0.296  1.339 1.08   440     flow
2  betaFlow[2, 1, 1] -1.305 0.384 -2.009 -1.315 -0.524 1.01   187     flow
3  betaFlow[3, 1, 1] -5.155 0.793 -6.682 -5.166 -3.567 1.00   308     flow
4  betaFlow[1, 2, 1] -1.036 0.297 -1.627 -1.039 -0.465 1.00   686     flow
5  betaFlow[2, 2, 1] -2.120 0.376 -2.875 -2.117 -1.386 1.00   493     flow
6  betaFlow[3, 2, 1] -2.821 0.491 -3.809 -2.815 -1.891 1.00   439     flow
7  betaFlow[1, 1, 2]  0.177 1.134 -1.982  0.172  2.357 1.00  3419     flow
8  betaFlow[2, 1, 2] -0.574 1.147 -2.799 -0.567  1.705 1.00  3179     flow
9  betaFlow[3, 1, 2] -2.007 1.167 -4.281 -1.978  0.265 1.00  2313     flow
10 betaFlow[1, 2, 2] -0.323 0.098 -0.516 -0.324 -0.128 1.00   806     flow
11 betaFlow[2, 2, 2] -0.853 0.143 -1.144 -0.852 -0.587 1.01   570     flow
12 betaFlow[3, 2, 2] -0.149 0.168 -0.489 -0.145  0.171 1.01   675     flow
13 betaFlow[1, 1, 3]  0.670 0.469 -0.149  0.638  1.643 1.00   202     flow
14 betaFlow[2, 1, 3] -0.313 0.410 -1.304 -0.275  0.363 1.00   454     flow
15 betaFlow[3, 1, 3] -0.933 0.513 -2.091 -0.859 -0.101 1.01   309     flow
16 betaFlow[1, 2, 3]  1.681 0.357  1.012  1.666  2.412 1.02   145     flow
17 betaFlow[2, 2, 3] -0.340 0.180 -0.681 -0.346  0.016 1.01   496     flow
18 betaFlow[3, 2, 3] -2.111 0.407 -2.951 -2.098 -1.326 1.01   152     flow
19 betaFlow[1, 1, 4] -0.263 0.453 -1.061 -0.305  0.775 1.00   269     flow
20 betaFlow[2, 1, 4] -0.197 0.546 -1.246 -0.216  0.896 1.00   227     flow
21 betaFlow[3, 1, 4] -0.768 0.412 -1.604 -0.760  0.006 1.00   285     flow
22 betaFlow[1, 2, 4] -0.368 0.306 -0.963 -0.369  0.228 1.00   521     flow
23 betaFlow[2, 2, 4]  0.372 0.439 -0.545  0.390  1.221 1.00   221     flow
24 betaFlow[3, 2, 4] -1.226 0.351 -1.916 -1.217 -0.541 1.00   221     flow
25    betaFlowTop[1]  0.070 0.631 -1.168  0.079  1.271 1.00  4000     flow
26    betaFlowTop[2] -0.413 0.633 -1.647 -0.416  0.865 1.00  3117     flow
27    betaFlowTop[3] -1.177 0.640 -2.412 -1.176  0.070 1.00  3365     flow
28 betaFlowYOY[1, 1]  0.194 0.574 -0.943  0.193  1.337 1.01  1522     flow
29 betaFlowYOY[2, 1] -0.564 0.564 -1.692 -0.566  0.564 1.00  1054     flow
30 betaFlowYOY[3, 1] -2.001 0.602 -3.158 -2.000 -0.842 1.00   954     flow
31 betaFlowYOY[1, 2]  0.005 0.486 -0.899  0.003  0.968 1.00  1999     flow
32 betaFlowYOY[2, 2] -0.668 0.485 -1.607 -0.669  0.294 1.00  2017     flow
33 betaFlowYOY[3, 2] -1.501 0.488 -2.452 -1.511 -0.552 1.00  2759     flow</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                          var   mean    sd   2.5%    50%  97.5% Rhat n.eff
1            betaInt[1, 1, 1]  1.265 0.520  0.344  1.220  2.364 1.03   504
2            betaInt[2, 1, 1] -0.641 0.527 -1.645 -0.649  0.424 1.00   476
3            betaInt[1, 2, 1]  1.454 1.557 -1.621  1.453  4.507 1.00  4000
4            betaInt[2, 2, 1] -0.531 0.332 -1.136 -0.552  0.160 1.00   566
5            betaInt[1, 3, 1]  1.866 0.953 -0.003  1.848  3.831 1.00  1910
6            betaInt[2, 3, 1] -1.408 0.659 -2.633 -1.445 -0.002 1.00  1108
7            betaInt[1, 4, 1]  2.649 0.947  1.020  2.578  4.697 1.01  1235
8            betaInt[2, 4, 1]  1.298 0.623  0.435  1.167  2.815 1.00   315
9            betaInt[1, 1, 2] -1.446 0.553 -2.509 -1.460 -0.316 1.04   390
10           betaInt[2, 1, 2]  0.224 0.420 -0.528  0.192  1.130 1.00  1288
11           betaInt[1, 2, 2]  1.455 1.538 -1.524  1.435  4.508 1.00  4338
12           betaInt[2, 2, 2]  0.080 0.415 -0.621  0.039  0.988 1.01   702
13           betaInt[1, 3, 2]  0.980 1.484 -1.737  1.015  3.697 1.00   534
14           betaInt[2, 3, 2] -0.104 0.403 -0.861 -0.120  0.737 1.00   590
15           betaInt[1, 4, 2]  3.575 0.842  2.008  3.543  5.305 1.00   746
16           betaInt[2, 4, 2]  2.512 0.525  1.500  2.506  3.575 1.00   529
17           betaInt[1, 1, 3]  1.105 0.545  0.175  1.062  2.308 1.00  1300
18           betaInt[2, 1, 3] -2.246 0.628 -3.457 -2.252 -0.973 1.00   584
19           betaInt[1, 2, 3]  1.443 1.500 -1.556  1.430  4.360 1.00  4000
20           betaInt[2, 2, 3] -0.006 0.240 -0.453 -0.015  0.478 1.00  1652
21           betaInt[1, 3, 3]  1.384 0.968 -0.363  1.350  3.449 1.01  1038
22           betaInt[2, 3, 3]  1.441 0.455  0.632  1.412  2.406 1.00  1517
23           betaInt[1, 4, 3]  2.499 0.629  1.339  2.470  3.805 1.00   524
24           betaInt[2, 4, 3]  3.510 0.754  2.071  3.490  5.025 1.00   578
25           betaInt[1, 1, 4]  1.270 0.935 -0.523  1.248  3.162 1.00  1330
26           betaInt[2, 1, 4] -1.383 1.338 -3.713 -1.493  1.362 1.00   791
27           betaInt[1, 2, 4]  1.405 1.521 -1.594  1.396  4.405 1.00  4000
28           betaInt[2, 2, 4]  0.310 0.588 -0.678  0.246  1.631 1.00  1727
29           betaInt[1, 3, 4]  2.177 0.775  0.729  2.161  3.818 1.00  1208
30           betaInt[2, 3, 4] -0.099 0.733 -1.185 -0.225  1.801 1.01  1185
31           betaInt[1, 4, 4]  2.761 0.760  1.352  2.737  4.337 1.01   606
32           betaInt[2, 4, 4] -0.058 1.220 -1.783 -0.342  2.922 1.00   581
33           betaInt[1, 1, 5]  0.775 1.117 -1.470  0.794  2.940 1.00  2820
34           betaInt[2, 1, 5] -0.484 1.143 -2.705 -0.488  1.736 1.01  2340
35           betaInt[1, 2, 5]  1.452 1.510 -1.523  1.475  4.365 1.00  3577
36           betaInt[2, 2, 5] -0.258 0.572 -1.225 -0.320  1.053 1.00  1160
37           betaInt[1, 3, 5]  1.774 0.651  0.745  1.688  3.317 1.00  2005
38           betaInt[2, 3, 5]  2.864 0.823  1.287  2.863  4.515 1.02   178
39           betaInt[1, 4, 5]  1.341 0.822  0.134  1.192  3.405 1.00   626
40           betaInt[2, 4, 5] -0.546 0.730 -1.834 -0.610  1.043 1.00   859
41           betaInt[1, 1, 6]  1.134 0.998 -0.815  1.128  3.151 1.00  2530
42           betaInt[2, 1, 6] -1.329 1.039 -3.162 -1.397  0.858 1.00   811
43           betaInt[1, 2, 6]  1.444 1.536 -1.610  1.461  4.420 1.00  4000
44           betaInt[2, 2, 6]  0.032 0.425 -0.690 -0.001  0.995 1.00  1286
45           betaInt[1, 3, 6]  2.954 0.832  1.445  2.908  4.669 1.01   323
46           betaInt[2, 3, 6]  0.937 0.584 -0.027  0.872  2.265 1.02  1333
47           betaInt[1, 4, 6]  1.819 1.109 -0.054  1.726  4.266 1.00   851
48           betaInt[2, 4, 6]  0.045 0.798 -1.189 -0.068  2.040 1.00   627
49           betaInt[1, 1, 7] -1.415 0.650 -2.545 -1.472 -0.029 1.00   256
50           betaInt[2, 1, 7]  0.569 0.647 -0.563  0.536  1.986 1.00  1772
51           betaInt[1, 2, 7]  1.432 1.532 -1.583  1.419  4.432 1.00  3520
52           betaInt[2, 2, 7] -1.061 0.514 -2.031 -1.072 -0.016 1.00  1258
53           betaInt[1, 3, 7]  1.924 0.679  0.806  1.854  3.383 1.00  1441
54           betaInt[2, 3, 7]  2.440 0.671  1.254  2.395  3.846 1.00  1839
55           betaInt[1, 4, 7]  2.313 1.047  0.473  2.219  4.468 1.00  1023
56           betaInt[2, 4, 7]  1.413 0.820  0.084  1.321  3.264 1.00  1502
57           betaInt[1, 1, 8]  0.504 0.248  0.063  0.490  1.052 1.01  1114
58           betaInt[2, 1, 8] -0.964 0.580 -1.993 -0.994  0.258 1.00   768
59           betaInt[1, 2, 8]  1.440 1.510 -1.453  1.436  4.425 1.00  3869
60           betaInt[2, 2, 8] -0.131 0.213 -0.541 -0.136  0.301 1.00   818
61           betaInt[1, 3, 8]  1.914 0.455  1.130  1.875  2.957 1.02   507
62           betaInt[2, 3, 8]  1.162 0.291  0.620  1.151  1.777 1.00  1136
63           betaInt[1, 4, 8]  2.952 0.857  1.563  2.847  4.846 1.00   531
64           betaInt[2, 4, 8]  1.999 0.808  0.697  1.913  3.724 1.00   775
65           betaInt[1, 1, 9]  0.779 1.079 -1.366  0.768  2.880 1.00  2396
66           betaInt[2, 1, 9] -0.302 0.822 -1.799 -0.352  1.397 1.00  2047
67           betaInt[1, 2, 9]  1.461 1.544 -1.662  1.443  4.447 1.00  4000
68           betaInt[2, 2, 9]  0.195 0.504 -0.695  0.155  1.286 1.01  1775
69           betaInt[1, 3, 9]  0.870 0.880 -0.697  0.801  2.810 1.00  1397
70           betaInt[2, 3, 9]  0.942 0.554 -0.081  0.925  2.067 1.00  1489
71           betaInt[1, 4, 9]  2.267 1.106  0.309  2.203  4.608 1.00  1075
72           betaInt[2, 4, 9]  1.172 1.017 -0.608  1.099  3.320 1.00  1277
73          betaInt[1, 1, 10]  3.305 0.792  1.839  3.294  4.968 1.03   706
74          betaInt[2, 1, 10] -0.479 1.051 -2.417 -0.528  1.729 1.00  2158
75          betaInt[1, 2, 10]  1.434 1.498 -1.558  1.431  4.339 1.00  4000
76          betaInt[2, 2, 10] -0.043 0.453 -0.864 -0.068  0.942 1.00  2178
77          betaInt[1, 3, 10]  2.581 0.844  0.968  2.573  4.252 1.00  1154
78          betaInt[2, 3, 10]  2.409 0.680  1.142  2.388  3.778 1.00   689
79          betaInt[1, 4, 10]  2.645 0.946  0.869  2.608  4.585 1.00  1047
80          betaInt[2, 4, 10]  1.881 0.850  0.339  1.826  3.726 1.00  1297
81          betaInt[1, 1, 11]  0.100 0.590 -0.937  0.070  1.312 1.00   241
82          betaInt[2, 1, 11]  1.449 0.539  0.452  1.421  2.574 1.00  1313
83          betaInt[1, 2, 11]  1.413 1.517 -1.582  1.425  4.379 1.00  3892
84          betaInt[2, 2, 11]  0.161 0.225 -0.254  0.155  0.631 1.00  1134
85          betaInt[1, 3, 11]  2.067 0.474  1.203  2.038  3.069 1.00   264
86          betaInt[2, 3, 11]  0.489 0.333 -0.148  0.488  1.159 1.01   403
87          betaInt[1, 4, 11]  2.776 0.832  1.331  2.709  4.592 1.00   499
88          betaInt[2, 4, 11]  3.545 0.957  1.617  3.542  5.354 1.01   382
89          betaInt[1, 1, 12]  0.762 0.750 -0.597  0.711  2.413 1.02   791
90          betaInt[2, 1, 12]  0.317 0.822 -1.220  0.280  2.048 1.00  1659
91          betaInt[1, 2, 12]  1.420 1.539 -1.599  1.413  4.451 1.00  4000
92          betaInt[2, 2, 12]  0.228 0.457 -0.541  0.192  1.257 1.00  2116
93          betaInt[1, 3, 12]  1.719 0.696  0.427  1.691  3.191 1.00   441
94          betaInt[2, 3, 12]  1.747 0.593  0.701  1.706  3.018 1.00   968
95          betaInt[1, 4, 12]  3.030 1.012  1.094  3.006  5.081 1.00   605
96          betaInt[2, 4, 12]  2.267 0.828  0.728  2.250  4.027 1.00  1122
97          betaInt[1, 1, 13]  1.985 0.747  0.638  1.935  3.576 1.00  1037
98          betaInt[2, 1, 13] -0.371 1.099 -2.514 -0.368  1.775 1.00  3259
99          betaInt[1, 2, 13]  1.416 1.535 -1.554  1.423  4.413 1.00  4000
100         betaInt[2, 2, 13] -0.035 1.043 -2.038 -0.048  2.118 1.00  2951
101         betaInt[1, 3, 13]  1.329 0.433  0.547  1.309  2.238 1.01   340
102         betaInt[2, 3, 13]  1.027 1.069 -1.032  1.025  3.174 1.00  3465
103         betaInt[1, 4, 13]  1.644 0.772  0.295  1.585  3.266 1.02   470
104         betaInt[2, 4, 13]  1.521 1.097 -0.645  1.545  3.616 1.00  2056
105                betaIntTop  0.646 0.640 -0.638  0.660  1.886 1.01  4000
106             betaIntYOY[1]  1.416 0.576  0.284  1.410  2.551 1.00  3119
107             betaIntYOY[2]  0.551 0.487 -0.395  0.551  1.505 1.00  3635
108    betaIntYOYSeason[1, 1]  0.820 0.392  0.066  0.810  1.613 1.00   963
109    betaIntYOYSeason[2, 1] -0.363 0.444 -1.212 -0.380  0.537 1.00   835
110    betaIntYOYSeason[1, 2]  1.433 1.164 -0.851  1.420  3.709 1.00  3474
111    betaIntYOYSeason[2, 2] -0.036 0.315 -0.666 -0.031  0.575 1.00  2318
112    betaIntYOYSeason[1, 3]  1.783 0.422  1.018  1.758  2.656 1.00   517
113    betaIntYOYSeason[2, 3]  1.031 0.343  0.383  1.026  1.708 1.00  1043
114    betaIntYOYSeason[1, 4]  2.408 0.504  1.515  2.367  3.496 1.01   462
115    betaIntYOYSeason[2, 4]  1.508 0.449  0.671  1.487  2.471 1.00   504
116 betaIntYOYSeasonOut[1, 1]  0.688 0.081  0.517  0.692  0.834 1.00  1004
117 betaIntYOYSeasonOut[2, 1]  0.414 0.104  0.229  0.406  0.631 1.00   841
118 betaIntYOYSeasonOut[1, 2]  0.758 0.183  0.299  0.805  0.976 1.00  3432
119 betaIntYOYSeasonOut[2, 2]  0.491 0.077  0.339  0.492  0.640 1.00  2319
120 betaIntYOYSeasonOut[1, 3]  0.849 0.052  0.735  0.853  0.934 1.00   604
121 betaIntYOYSeasonOut[2, 3]  0.732 0.066  0.595  0.736  0.847 1.00  1135
122 betaIntYOYSeasonOut[1, 4]  0.910 0.039  0.820  0.914  0.971 1.00   594
123 betaIntYOYSeasonOut[2, 4]  0.810 0.066  0.662  0.816  0.922 1.00   602
    flowData
1       flow
2       flow
3       flow
4       flow
5       flow
6       flow
7       flow
8       flow
9       flow
10      flow
11      flow
12      flow
13      flow
14      flow
15      flow
16      flow
17      flow
18      flow
19      flow
20      flow
21      flow
22      flow
23      flow
24      flow
25      flow
26      flow
27      flow
28      flow
29      flow
30      flow
31      flow
32      flow
33      flow
34      flow
35      flow
36      flow
37      flow
38      flow
39      flow
40      flow
41      flow
42      flow
43      flow
44      flow
45      flow
46      flow
47      flow
48      flow
49      flow
50      flow
51      flow
52      flow
53      flow
54      flow
55      flow
56      flow
57      flow
58      flow
59      flow
60      flow
61      flow
62      flow
63      flow
64      flow
65      flow
66      flow
67      flow
68      flow
69      flow
70      flow
71      flow
72      flow
73      flow
74      flow
75      flow
76      flow
77      flow
78      flow
79      flow
80      flow
81      flow
82      flow
83      flow
84      flow
85      flow
86      flow
87      flow
88      flow
89      flow
90      flow
91      flow
92      flow
93      flow
94      flow
95      flow
96      flow
97      flow
98      flow
99      flow
100     flow
101     flow
102     flow
103     flow
104     flow
105     flow
106     flow
107     flow
108     flow
109     flow
110     flow
111     flow
112     flow
113     flow
114     flow
115     flow
116     flow
117     flow
118     flow
119     flow
120     flow
121     flow
122     flow
123     flow</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">&lt;-</span> <span class="fu">runif</span>(out_flow<span class="sc">$</span>runData<span class="sc">$</span>nIter <span class="sc">*</span> out_flow<span class="sc">$</span>runData<span class="sc">$</span>nChains, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>(</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>              <span class="st">"betaIntYOYSeason"</span>, <span class="st">"betaPhiYOYSeason"</span>,<span class="st">"betaPYOYSeason"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntTop", "betaPhiTop","betaFlowTop","betaPTop"  </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaInt", "betaPhi","betaFlow","betaP",</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntOut", "betaPhiOut","betaFlowOut","betaPOut"</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-8.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-9.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"betaIntYOY"</span>, <span class="st">"betaPhiYOY"</span>,<span class="st">"betaFlowYOY"</span>,<span class="st">"betaPYOY"</span>  </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaInt", "betaPhi","betaFlow","betaP",</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntOut", "betaPhiOut","betaFlowOut","betaPOut"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-10.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-11.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-12.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flow-13.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="model-phit_pt-flow-byriver-tt_ob_flowbyriver" class="level3" data-number="12.0.2">
<h3 data-number="12.0.2" class="anchored" data-anchor-id="model-phit_pt-flow-byriver-tt_ob_flowbyriver"><span class="header-section-number">12.0.2</span> Model phiT_pT flow ByRiver (tt_OB_flowByRiver)</h3>
<p>Cohort-dependent estimates of phi and p with flowByRiver and flowByRiver^2 hierarchical effects</p>
<section id="retrieve-model-results-1" class="level4" data-number="12.0.2.1">
<h4 data-number="12.0.2.1" class="anchored" data-anchor-id="retrieve-model-results-1"><span class="header-section-number">12.0.2.1</span> Retrieve model results</h4>
<p>Model is run using targets in R/modelCMR_tt_OB.R</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Following https://oliviergimenez.github.io/bayesian-cr-workshop/worksheets/4_demo.html</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  out_flowByRiver <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(tt_modelOut_ft_cohort_OB_flowByRiver)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCplot</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc, <span class="at">round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"var"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         var  mean    sd   2.5%   50% 97.5% Rhat n.eff
1     betaIntYOYSeason[1, 1] 1.304 0.409  0.539 1.292 2.159 1.01   392
2     betaIntYOYSeason[2, 1] 0.914 0.670 -0.119 0.828 2.637 1.22   153
3     betaIntYOYSeason[1, 2] 1.575 1.156 -0.602 1.548 3.863 1.01  2753
4     betaIntYOYSeason[2, 2] 0.429 0.376 -0.289 0.419 1.185 1.01   438
5     betaIntYOYSeason[1, 3] 1.694 0.816  0.180 1.637 3.372 1.20    69
6     betaIntYOYSeason[2, 3] 0.921 0.404  0.151 0.908 1.741 1.01   450
7     betaIntYOYSeason[1, 4] 2.530 0.563  1.431 2.536 3.630 1.06   266
8     betaIntYOYSeason[2, 4] 0.991 0.533  0.051 0.953 2.147 1.07   284
9  betaIntYOYSeasonOut[1, 1] 0.779 0.067  0.632 0.785 0.896 1.01   416
10 betaIntYOYSeasonOut[2, 1] 0.696 0.117  0.470 0.696 0.933 1.16   207
11 betaIntYOYSeasonOut[1, 2] 0.779 0.172  0.354 0.825 0.979 1.02  2989
12 betaIntYOYSeasonOut[2, 2] 0.602 0.087  0.428 0.603 0.766 1.01   463
13 betaIntYOYSeasonOut[1, 3] 0.818 0.112  0.545 0.837 0.967 1.23    87
14 betaIntYOYSeasonOut[2, 3] 0.708 0.080  0.538 0.713 0.851 1.01   458
15 betaIntYOYSeasonOut[1, 4] 0.917 0.044  0.807 0.927 0.974 1.05   256
16 betaIntYOYSeasonOut[2, 4] 0.717 0.099  0.513 0.722 0.895 1.06   290
      flowData
1  flowByRiver
2  flowByRiver
3  flowByRiver
4  flowByRiver
5  flowByRiver
6  flowByRiver
7  flowByRiver
8  flowByRiver
9  flowByRiver
10 flowByRiver
11 flowByRiver
12 flowByRiver
13 flowByRiver
14 flowByRiver
15 flowByRiver
16 flowByRiver</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         var   mean    sd   2.5%    50% 97.5% Rhat n.eff
1     betaPhiYOYSeason[1, 1]  0.005 1.690 -3.304  0.021 3.299    1  4000
2     betaPhiYOYSeason[2, 1] -0.015 1.746 -3.448 -0.020 3.398    1  4151
3     betaPhiYOYSeason[1, 2]  0.003 1.689 -3.329  0.004 3.336    1  4000
4     betaPhiYOYSeason[2, 2]  0.015 1.739 -3.476  0.034 3.352    1  4000
5     betaPhiYOYSeason[1, 3]  0.052 1.694 -3.262  0.033 3.398    1  4000
6     betaPhiYOYSeason[2, 3]  0.022 1.750 -3.453  0.017 3.433    1  4000
7     betaPhiYOYSeason[1, 4]  0.003 1.700 -3.201 -0.004 3.314    1  4164
8     betaPhiYOYSeason[2, 4]  0.016 1.756 -3.565  0.020 3.374    1  3842
9  betaPhiYOYSeasonOut[1, 1]  0.502 0.288  0.035  0.505 0.964    1  4000
10 betaPhiYOYSeasonOut[2, 1]  0.498 0.295  0.031  0.495 0.968    1  4161
11 betaPhiYOYSeasonOut[1, 2]  0.501 0.289  0.035  0.501 0.966    1  4000
12 betaPhiYOYSeasonOut[2, 2]  0.504 0.292  0.030  0.509 0.966    1  4000
13 betaPhiYOYSeasonOut[1, 3]  0.508 0.290  0.037  0.508 0.968    1  4000
14 betaPhiYOYSeasonOut[2, 3]  0.504 0.294  0.031  0.504 0.969    1  4000
15 betaPhiYOYSeasonOut[1, 4]  0.499 0.291  0.039  0.499 0.965    1  4000
16 betaPhiYOYSeasonOut[2, 4]  0.504 0.293  0.028  0.505 0.967    1  4000
      flowData
1  flowByRiver
2  flowByRiver
3  flowByRiver
4  flowByRiver
5  flowByRiver
6  flowByRiver
7  flowByRiver
8  flowByRiver
9  flowByRiver
10 flowByRiver
11 flowByRiver
12 flowByRiver
13 flowByRiver
14 flowByRiver
15 flowByRiver
16 flowByRiver</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlow"</span>, var))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 var   mean    sd   2.5%    50%  97.5% Rhat n.eff    flowData
1  betaFlow[1, 1, 1]  0.053 0.235 -0.334  0.028  0.581 1.11   214 flowByRiver
2  betaFlow[2, 1, 1] -0.380 0.228 -0.832 -0.375  0.065 1.01   395 flowByRiver
3  betaFlow[3, 1, 1]  0.121 0.159 -0.184  0.118  0.446 1.01   514 flowByRiver
4  betaFlow[1, 2, 1]  0.198 0.493 -0.488  0.111  1.511 1.31   119 flowByRiver
5  betaFlow[2, 2, 1] -0.942 0.358 -1.672 -0.926 -0.274 1.06   304 flowByRiver
6  betaFlow[3, 2, 1]  0.182 0.309 -0.428  0.185  0.770 1.10   282 flowByRiver
7  betaFlow[1, 1, 2] -0.211 1.183 -2.532 -0.192  2.124 1.01  1735 flowByRiver
8  betaFlow[2, 1, 2]  0.613 1.142 -1.634  0.597  2.808 1.00  2024 flowByRiver
9  betaFlow[3, 1, 2]  0.439 1.168 -1.814  0.435  2.715 1.00  3234 flowByRiver
10 betaFlow[1, 2, 2]  0.399 0.215  0.017  0.384  0.869 1.02   189 flowByRiver
11 betaFlow[2, 2, 2] -1.218 0.216 -1.654 -1.210 -0.819 1.03   212 flowByRiver
12 betaFlow[3, 2, 2] -0.266 0.160 -0.595 -0.256  0.026 1.02   294 flowByRiver
13 betaFlow[1, 1, 3] -0.273 0.922 -2.036 -0.340  1.627 1.23    57 flowByRiver
14 betaFlow[2, 1, 3]  0.209 0.726 -1.224  0.213  1.670 1.03   245 flowByRiver
15 betaFlow[3, 1, 3]  1.195 0.830 -0.350  1.171  2.914 1.06   243 flowByRiver
16 betaFlow[1, 2, 3] -0.157 0.272 -0.695 -0.163  0.392 1.00   168 flowByRiver
17 betaFlow[2, 2, 3] -1.059 0.280 -1.637 -1.043 -0.548 1.00   188 flowByRiver
18 betaFlow[3, 2, 3] -0.721 0.251 -1.229 -0.707 -0.250 1.00   146 flowByRiver
19 betaFlow[1, 1, 4] -0.566 0.248 -1.044 -0.562 -0.080 1.01   479 flowByRiver
20 betaFlow[2, 1, 4]  2.678 0.523  1.682  2.669  3.733 1.04   345 flowByRiver
21 betaFlow[3, 1, 4]  0.226 0.371 -0.474  0.224  0.947 1.00   433 flowByRiver
22 betaFlow[1, 2, 4] -0.291 0.226 -0.714 -0.294  0.175 1.08   393 flowByRiver
23 betaFlow[2, 2, 4]  1.436 0.507  0.450  1.440  2.467 1.03   285 flowByRiver
24 betaFlow[3, 2, 4]  0.276 0.307 -0.370  0.290  0.855 1.01   347 flowByRiver
25    betaFlowTop[1] -0.058 0.644 -1.315 -0.048  1.166 1.01  3172 flowByRiver
26    betaFlowTop[2]  0.106 0.635 -1.120  0.103  1.330 1.00  3518 flowByRiver
27    betaFlowTop[3]  0.114 0.628 -1.111  0.098  1.350 1.00  3685 flowByRiver
28 betaFlowYOY[1, 1] -0.213 0.600 -1.402 -0.225  0.965 1.06   374 flowByRiver
29 betaFlowYOY[2, 1]  0.633 0.576 -0.499  0.628  1.780 1.00  1095 flowByRiver
30 betaFlowYOY[3, 1]  0.409 0.577 -0.688  0.410  1.556 1.01  1213 flowByRiver
31 betaFlowYOY[1, 2]  0.013 0.496 -0.938  0.008  0.981 1.01  1296 flowByRiver
32 betaFlowYOY[2, 2] -0.335 0.498 -1.328 -0.335  0.644 1.00  1561 flowByRiver
33 betaFlowYOY[3, 2] -0.085 0.481 -1.030 -0.086  0.856 1.00  2634 flowByRiver</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">&lt;-</span> <span class="fu">runif</span>(out_flowByRiver<span class="sc">$</span>runData<span class="sc">$</span>nIter <span class="sc">*</span> out_flowByRiver<span class="sc">$</span>runData<span class="sc">$</span>nChains, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>( <span class="st">"betaIntYOY"</span>, <span class="st">"betaPhiYOY"</span>,<span class="st">"betaFlowYOY"</span>,<span class="st">"betaPYOY"</span> ),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/OB_tt_flowByRiver-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># MCMCtrace(object = out_flowByRiver$mcmc,</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           #ISB = FALSE,</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           #exact = TRUE, </span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           params = c("betaInt"),</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           pdf = FALSE, </span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           priors = priors)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="compare-parameter-estimates-of-models-with-flow-and-flowbyriver" class="level4" data-number="12.0.2.2">
<h4 data-number="12.0.2.2" class="anchored" data-anchor-id="compare-parameter-estimates-of-models-with-flow-and-flowbyriver"><span class="header-section-number">12.0.2.2</span> Compare parameter estimates of models with flow and flowByRiver</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(summary_flow, summary_flowByRiver) <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lo =</span> <span class="st">'2.5%'</span>, <span class="at">hi =</span> <span class="st">'97.5%'</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowTop"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiTop"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-7.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-1-8.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(both %&gt;% filter(grepl("betaPOut", var)), aes(color = flowData)) +</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(var, mean), size = 2, position = position_dodge(width = 0.5)) +</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_errorbar( aes(var, ymin = lo, ymax = hi), width = 0.4, position = position_dodge(width = 0.5)) +</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>getPredictions_FlowYOYSeasonCohort <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaInt</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  predictorsBetaInt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nCohorts</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaInt)){</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    predictorsBetaInt<span class="sc">$</span>betaInt[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaInt[i, <span class="st">"iter"</span>], </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">paste0</span>(<span class="st">"betaInt["</span>, predictorsBetaInt[i, <span class="st">"isYOY"</span>],</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"season"</span>],</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"cohort"</span>],</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"]"</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ## betaPhi</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># predictorsBetaPhi &lt;- expand.grid(</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   iter = seq(1, dim(mcmc$chain1)[1], everyNIters),</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   isYOY = 1:2,</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   season = 1:toSave$myConstants$nSeasons,</span></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for(i in 1:nrow(predictorsBetaPhi)){</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   predictorsBetaPhi$betaPhi[i] &lt;- mcmc$chain1[[predictorsBetaPhi[i, "iter"], </span></span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                paste0("betaPhi[", predictorsBetaPhi[i, "isYOY"],</span></span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       ", ",       predictorsBetaPhi[i, "season"],</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       ", ",       predictorsBetaPhi[i, "cohort"],</span></span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       "]")</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ]]</span></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlow <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlow)){</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[1, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co">#     ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[2, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[3, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>  predictorsAll <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nCohorts,</span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb30-75"><a href="#cb30-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb30-76"><a href="#cb30-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb30-77"><a href="#cb30-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-78"><a href="#cb30-78" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsAll <span class="sc">%&gt;%</span></span>
<span id="cb30-79"><a href="#cb30-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaInt) <span class="sc">%&gt;%</span></span>
<span id="cb30-80"><a href="#cb30-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaFlow) <span class="sc">%&gt;%</span></span>
<span id="cb30-81"><a href="#cb30-81" aria-hidden="true" tabindex="-1"></a> <span class="co">#   left_join(predictorsBetaPhi) %&gt;%</span></span>
<span id="cb30-82"><a href="#cb30-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaInt <span class="sc">+</span> betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb30-83"><a href="#cb30-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb30-84"><a href="#cb30-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb30-85"><a href="#cb30-85" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>getPredictions_FlowYOYSeason <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaInt</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  predictorsBetaInt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#    cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaInt)){</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    predictorsBetaInt<span class="sc">$</span>betaInt[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaInt[i, <span class="st">"iter"</span>], </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">paste0</span>(<span class="st">"betaIntYOYSeason["</span>, predictorsBetaInt[i, <span class="st">"isYOY"</span>],</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"season"</span>],</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#      ", ",       predictorsBetaInt[i, "cohort"],</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"]"</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="co">#   ## betaPhi</span></span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a><span class="co">#   predictorsBetaPhi &lt;- expand.grid(</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a><span class="co">#     iter = seq(1, dim(mcmc$chain1)[1], everyNIters),</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a><span class="co">#     isYOY = 1:2,</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a><span class="co">#     season = 1:toSave$myConstants$nSeasons</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a><span class="co"># #    cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co">#   for(i in 1:nrow(predictorsBetaPhi)){</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="co">#     predictorsBetaPhi$betaPhi[i] &lt;- mcmc$chain1[[predictorsBetaPhi[i, "iter"], </span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                  paste0("betaPhiYOYSeason[", predictorsBetaPhi[i, "isYOY"],</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         ", ",       predictorsBetaPhi[i, "season"],</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   #      ", ",       predictorsBetaPhi[i, "cohort"],</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         "]")</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="co">#     ]]</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlow <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlow)){</span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[1, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co">#     ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[2, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[3, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>  predictorsAll <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a>   <span class="co"># cohort = 1:toSave$myConstants$nCohorts,</span></span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsAll <span class="sc">%&gt;%</span></span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaInt) <span class="sc">%&gt;%</span></span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaFlow) <span class="sc">%&gt;%</span></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  left_join(predictorsBetaPhi) %&gt;%</span></span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaInt <span class="sc">+</span> betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="section" class="level32">
<p class="heading"></p>
</section>
</section>
</section>
<section id="flow_yoyseason-predictions" class="level3" data-number="12.0.3">
<h3 data-number="12.0.3" class="anchored" data-anchor-id="flow_yoyseason-predictions"><span class="header-section-number">12.0.3</span> Flow_YOYSeason predictions</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>predFlowYOYSeason <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeason</span>(out_flow, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>predFlowByRiverYOYSeason <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeason</span>(out_flowByRiver, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>predBoth <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(predFlowYOYSeason, predFlowByRiverYOYSeason)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="graph-flow-predictions" class="level4" data-number="12.0.3.1">
<h4 data-number="12.0.3.1" class="anchored" data-anchor-id="graph-flow-predictions"><span class="header-section-number">12.0.3.1</span> Graph flow predictions</h4>
<p>Predictions based on flow from the flow extension curve - original approach</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Predictions based on flow from flowByRiver</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowByRiverYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Similar format to to the 2015 paper</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flow <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(temp, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,flow, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(flow)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="section-1" class="level36">
<p class="heading"></p>
</section>
</section>
</section>
<section id="flow_yoyseasoncohort-predictions" class="level3" data-number="12.0.4">
<h3 data-number="12.0.4" class="anchored" data-anchor-id="flow_yoyseasoncohort-predictions"><span class="header-section-number">12.0.4</span> Flow_YOYSeasonCohort predictions</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>predFlowYOYSeasonCohort <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeasonCohort</span>(out_flow, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>predFlowByRiverYOYSeasonCohort <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeasonCohort</span>(out_flowByRiver, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>predBoth <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(predFlowYOYSeasonCohort, predFlowByRiverYOYSeasonCohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="graph-flow-predictions-1" class="level4" data-number="12.0.4.1">
<h4 data-number="12.0.4.1" class="anchored" data-anchor-id="graph-flow-predictions-1"><span class="header-section-number">12.0.4.1</span> Graph flow predictions</h4>
<p>Predictions based on flow from the flow extension curve - original approach</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY <span class="sc">+</span> cohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Predictions based on flow from flowByRiver</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowByRiverYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY <span class="sc">+</span> cohort)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Similar format to to the 2015 paper</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flow <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(temp, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,flow,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(flow)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="modelsCMR_ft_cohort_Flow_OB_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="section-2" class="level37">
<p class="heading"></p>
</section>
</section>
<section id="flowtop-predictions" class="level4" data-number="12.0.4.2">
<h4 data-number="12.0.4.2" class="anchored" data-anchor-id="flowtop-predictions"><span class="header-section-number">12.0.4.2</span> FlowTop predictions</h4>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predFlowTop &lt;- getPredictionsFlowTop(out_flow, everyNIters = 5) %&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(flowData = "flow") </span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># predFlowByRiverTop &lt;- getPredictionsFlowTop(out_flowByRiver, everyNIters = 5) %&gt;%</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(flowData = "flowByRiver")</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co"># predTopBoth &lt;- bind_rows(predFlowTop, predFlowByRiverTop)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(predTopBoth, aes(flow, predPhi, group = iter)) +</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~flowData)</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(predTopBoth %&gt;% filter(iter &lt; 100), aes(flow, predPhi, group = iter)) +</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(flowData ~ iter)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>getPredictionsFlowTop <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlowTop <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlowTop)){</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">1</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">2</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">3</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsBetaFlowTop <span class="sc">%&gt;%</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./modelsCMR_ft_Flow_OB.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - O’Bear only</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./modelsCMR_Flow_4Rivers.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Flow effects on survival (phi) models - 4 rivers</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb43" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Flow effects on survival (phi) models - O'Bear only</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>The goal of this modelling exercise is to evaluate the effect of new tributary-specific stream flow estimates on survival of brook trout and brown trout. We will compare survival across the WB and tributaries with flow input data as 1) single flow estimate for all locations (historical approach) and 2) hindcasted flows for each tributary based on new tributary-specific flows which are available since 2000.</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>The goal is to find the best structure for the survival model, then compare survival estimates with tributary-specific flow to estimates with common flow across locations.</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>Structure options include</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">species, cohort, season, isYOY, flow, flow^2</span><span class="co">]</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="in">```{r globalModelsNimbleRiver, include=FALSE}</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">warning =</span> <span class="cn">FALSE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r librariesModelsNimbleRiver, echo = FALSE}</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(getWBData)</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nimble)</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nimbleEcology)</span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MCMCvis)</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(targets)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model phiT_pT flow (tt_OB_flow)</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>Cohort-dependent estimates of phi and p with flow and temperature hierarchical effects  </span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Retrieve model results</span></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>Model is run using targets in R/modelCMR_tt_OB.R</span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a><span class="in">```{r OB_tt_flow}</span></span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Following https://oliviergimenez.github.io/bayesian-cr-workshop/worksheets/4_demo.html</span></span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>  out_flow <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(tt_modelOut_ft_cohort_OB_flow )</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCplot</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc)</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc, <span class="at">round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"var"</span>)</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var))</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var))</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlow"</span>, var))</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  summary_flow <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt"</span>, var))</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">&lt;-</span> <span class="fu">runif</span>(out_flow<span class="sc">$</span>runData<span class="sc">$</span>nIter <span class="sc">*</span> out_flow<span class="sc">$</span>runData<span class="sc">$</span>nChains, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc,</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>(</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>              <span class="st">"betaIntYOYSeason"</span>, <span class="st">"betaPhiYOYSeason"</span>,<span class="st">"betaPYOYSeason"</span></span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntTop", "betaPhiTop","betaFlowTop","betaPTop"  </span></span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaInt", "betaPhi","betaFlow","betaP",</span></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntOut", "betaPhiOut","betaFlowOut","betaPOut"</span></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flow<span class="sc">$</span>mcmc,</span>
<span id="cb43-64"><a href="#cb43-64" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb43-65"><a href="#cb43-65" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb43-66"><a href="#cb43-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>(</span>
<span id="cb43-67"><a href="#cb43-67" aria-hidden="true" tabindex="-1"></a>              <span class="st">"betaIntYOY"</span>, <span class="st">"betaPhiYOY"</span>,<span class="st">"betaFlowYOY"</span>,<span class="st">"betaPYOY"</span>  </span>
<span id="cb43-68"><a href="#cb43-68" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaInt", "betaPhi","betaFlow","betaP",</span></span>
<span id="cb43-69"><a href="#cb43-69" aria-hidden="true" tabindex="-1"></a>            <span class="co">#  "betaIntOut", "betaPhiOut","betaFlowOut","betaPOut"</span></span>
<span id="cb43-70"><a href="#cb43-70" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb43-71"><a href="#cb43-71" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb43-72"><a href="#cb43-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span>
<span id="cb43-73"><a href="#cb43-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-74"><a href="#cb43-74" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-75"><a href="#cb43-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-76"><a href="#cb43-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-77"><a href="#cb43-77" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model phiT_pT flow ByRiver (tt_OB_flowByRiver)</span></span>
<span id="cb43-78"><a href="#cb43-78" aria-hidden="true" tabindex="-1"></a>Cohort-dependent estimates of phi and p with flowByRiver and flowByRiver^2 hierarchical effects  </span>
<span id="cb43-79"><a href="#cb43-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-80"><a href="#cb43-80" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Retrieve model results</span></span>
<span id="cb43-81"><a href="#cb43-81" aria-hidden="true" tabindex="-1"></a>Model is run using targets in R/modelCMR_tt_OB.R</span>
<span id="cb43-82"><a href="#cb43-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r OB_tt_flowByRiver}</span></span>
<span id="cb43-83"><a href="#cb43-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Following https://oliviergimenez.github.io/bayesian-cr-workshop/worksheets/4_demo.html</span></span>
<span id="cb43-84"><a href="#cb43-84" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb43-85"><a href="#cb43-85" aria-hidden="true" tabindex="-1"></a>  out_flowByRiver <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(tt_modelOut_ft_cohort_OB_flowByRiver)</span>
<span id="cb43-86"><a href="#cb43-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-87"><a href="#cb43-87" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCplot</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc)</span>
<span id="cb43-88"><a href="#cb43-88" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="ot">&lt;-</span> <span class="fu">MCMCsummary</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc, <span class="at">round =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-89"><a href="#cb43-89" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-90"><a href="#cb43-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"var"</span>)</span>
<span id="cb43-91"><a href="#cb43-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-92"><a href="#cb43-92" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var))</span>
<span id="cb43-93"><a href="#cb43-93" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var))</span>
<span id="cb43-94"><a href="#cb43-94" aria-hidden="true" tabindex="-1"></a>  summary_flowByRiver <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlow"</span>, var))</span>
<span id="cb43-95"><a href="#cb43-95" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-96"><a href="#cb43-96" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-97"><a href="#cb43-97" aria-hidden="true" tabindex="-1"></a>  priors <span class="ot">&lt;-</span> <span class="fu">runif</span>(out_flowByRiver<span class="sc">$</span>runData<span class="sc">$</span>nIter <span class="sc">*</span> out_flowByRiver<span class="sc">$</span>runData<span class="sc">$</span>nChains, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb43-98"><a href="#cb43-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">MCMCtrace</span>(<span class="at">object =</span> out_flowByRiver<span class="sc">$</span>mcmc,</span>
<span id="cb43-99"><a href="#cb43-99" aria-hidden="true" tabindex="-1"></a>            <span class="co">#ISB = FALSE,</span></span>
<span id="cb43-100"><a href="#cb43-100" aria-hidden="true" tabindex="-1"></a>            <span class="co">#exact = TRUE, </span></span>
<span id="cb43-101"><a href="#cb43-101" aria-hidden="true" tabindex="-1"></a>            <span class="at">params =</span> <span class="fu">c</span>( <span class="st">"betaIntYOY"</span>, <span class="st">"betaPhiYOY"</span>,<span class="st">"betaFlowYOY"</span>,<span class="st">"betaPYOY"</span> ),</span>
<span id="cb43-102"><a href="#cb43-102" aria-hidden="true" tabindex="-1"></a>            <span class="at">pdf =</span> <span class="cn">FALSE</span>, </span>
<span id="cb43-103"><a href="#cb43-103" aria-hidden="true" tabindex="-1"></a>            <span class="at">priors =</span> priors)</span>
<span id="cb43-104"><a href="#cb43-104" aria-hidden="true" tabindex="-1"></a>  <span class="co"># MCMCtrace(object = out_flowByRiver$mcmc,</span></span>
<span id="cb43-105"><a href="#cb43-105" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           #ISB = FALSE,</span></span>
<span id="cb43-106"><a href="#cb43-106" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           #exact = TRUE, </span></span>
<span id="cb43-107"><a href="#cb43-107" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           params = c("betaInt"),</span></span>
<span id="cb43-108"><a href="#cb43-108" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           pdf = FALSE, </span></span>
<span id="cb43-109"><a href="#cb43-109" aria-hidden="true" tabindex="-1"></a>  <span class="co">#           priors = priors)</span></span>
<span id="cb43-110"><a href="#cb43-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-111"><a href="#cb43-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-112"><a href="#cb43-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-113"><a href="#cb43-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-114"><a href="#cb43-114" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Compare parameter estimates of models with flow and flowByRiver</span></span>
<span id="cb43-117"><a href="#cb43-117" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-118"><a href="#cb43-118" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(summary_flow, summary_flowByRiver) <span class="sc">%&gt;%</span></span>
<span id="cb43-119"><a href="#cb43-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">lo =</span> <span class="st">'2.5%'</span>, <span class="at">hi =</span> <span class="st">'97.5%'</span>)</span>
<span id="cb43-120"><a href="#cb43-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-121"><a href="#cb43-121" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowTop"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb43-122"><a href="#cb43-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-123"><a href="#cb43-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) </span>
<span id="cb43-124"><a href="#cb43-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-125"><a href="#cb43-125" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiTop"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb43-126"><a href="#cb43-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-127"><a href="#cb43-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-128"><a href="#cb43-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb43-129"><a href="#cb43-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-130"><a href="#cb43-130" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaFlowYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb43-131"><a href="#cb43-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-132"><a href="#cb43-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-133"><a href="#cb43-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb43-134"><a href="#cb43-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-135"><a href="#cb43-135" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb43-136"><a href="#cb43-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-137"><a href="#cb43-137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-138"><a href="#cb43-138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb43-139"><a href="#cb43-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-140"><a href="#cb43-140" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaIntYOYSeason"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb43-141"><a href="#cb43-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-142"><a href="#cb43-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-143"><a href="#cb43-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb43-144"><a href="#cb43-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-145"><a href="#cb43-145" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPhiYOYSeason"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb43-146"><a href="#cb43-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-147"><a href="#cb43-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-148"><a href="#cb43-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb43-149"><a href="#cb43-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-150"><a href="#cb43-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-151"><a href="#cb43-151" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaInt"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb43-152"><a href="#cb43-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-153"><a href="#cb43-153" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-154"><a href="#cb43-154" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb43-155"><a href="#cb43-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-156"><a href="#cb43-156" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(both <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">"betaPYOY"</span>, var)), <span class="fu">aes</span>(<span class="at">color =</span> flowData)) <span class="sc">+</span></span>
<span id="cb43-157"><a href="#cb43-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(var, mean), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-158"><a href="#cb43-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>( <span class="fu">aes</span>(var, <span class="at">ymin =</span> lo, <span class="at">ymax =</span> hi), <span class="at">width =</span> <span class="fl">0.4</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb43-159"><a href="#cb43-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust=</span><span class="dv">1</span>))</span>
<span id="cb43-160"><a href="#cb43-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-161"><a href="#cb43-161" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(both %&gt;% filter(grepl("betaPOut", var)), aes(color = flowData)) +</span></span>
<span id="cb43-162"><a href="#cb43-162" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(aes(var, mean), size = 2, position = position_dodge(width = 0.5)) +</span></span>
<span id="cb43-163"><a href="#cb43-163" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_errorbar( aes(var, ymin = lo, ymax = hi), width = 0.4, position = position_dodge(width = 0.5)) +</span></span>
<span id="cb43-164"><a href="#cb43-164" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme(axis.text.x = element_text(angle = 90, vjust = 1, hjust=1))</span></span>
<span id="cb43-165"><a href="#cb43-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-166"><a href="#cb43-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-167"><a href="#cb43-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-170"><a href="#cb43-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-171"><a href="#cb43-171" aria-hidden="true" tabindex="-1"></a>getPredictions_FlowYOYSeasonCohort <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb43-172"><a href="#cb43-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-173"><a href="#cb43-173" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb43-174"><a href="#cb43-174" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaInt</span></span>
<span id="cb43-175"><a href="#cb43-175" aria-hidden="true" tabindex="-1"></a>  predictorsBetaInt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb43-176"><a href="#cb43-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb43-177"><a href="#cb43-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb43-178"><a href="#cb43-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb43-179"><a href="#cb43-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nCohorts</span>
<span id="cb43-180"><a href="#cb43-180" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-181"><a href="#cb43-181" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-182"><a href="#cb43-182" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaInt)){</span>
<span id="cb43-183"><a href="#cb43-183" aria-hidden="true" tabindex="-1"></a>    predictorsBetaInt<span class="sc">$</span>betaInt[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaInt[i, <span class="st">"iter"</span>], </span>
<span id="cb43-184"><a href="#cb43-184" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">paste0</span>(<span class="st">"betaInt["</span>, predictorsBetaInt[i, <span class="st">"isYOY"</span>],</span>
<span id="cb43-185"><a href="#cb43-185" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"season"</span>],</span>
<span id="cb43-186"><a href="#cb43-186" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"cohort"</span>],</span>
<span id="cb43-187"><a href="#cb43-187" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"]"</span>)</span>
<span id="cb43-188"><a href="#cb43-188" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb43-189"><a href="#cb43-189" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-190"><a href="#cb43-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-191"><a href="#cb43-191" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ## betaPhi</span></span>
<span id="cb43-192"><a href="#cb43-192" aria-hidden="true" tabindex="-1"></a>  <span class="co"># predictorsBetaPhi &lt;- expand.grid(</span></span>
<span id="cb43-193"><a href="#cb43-193" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   iter = seq(1, dim(mcmc$chain1)[1], everyNIters),</span></span>
<span id="cb43-194"><a href="#cb43-194" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   isYOY = 1:2,</span></span>
<span id="cb43-195"><a href="#cb43-195" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   season = 1:toSave$myConstants$nSeasons,</span></span>
<span id="cb43-196"><a href="#cb43-196" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb43-197"><a href="#cb43-197" aria-hidden="true" tabindex="-1"></a>  <span class="co"># )</span></span>
<span id="cb43-198"><a href="#cb43-198" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb43-199"><a href="#cb43-199" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for(i in 1:nrow(predictorsBetaPhi)){</span></span>
<span id="cb43-200"><a href="#cb43-200" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   predictorsBetaPhi$betaPhi[i] &lt;- mcmc$chain1[[predictorsBetaPhi[i, "iter"], </span></span>
<span id="cb43-201"><a href="#cb43-201" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                paste0("betaPhi[", predictorsBetaPhi[i, "isYOY"],</span></span>
<span id="cb43-202"><a href="#cb43-202" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       ", ",       predictorsBetaPhi[i, "season"],</span></span>
<span id="cb43-203"><a href="#cb43-203" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       ", ",       predictorsBetaPhi[i, "cohort"],</span></span>
<span id="cb43-204"><a href="#cb43-204" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                                                       "]")</span></span>
<span id="cb43-205"><a href="#cb43-205" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   ]]</span></span>
<span id="cb43-206"><a href="#cb43-206" aria-hidden="true" tabindex="-1"></a>  <span class="co"># }</span></span>
<span id="cb43-207"><a href="#cb43-207" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-208"><a href="#cb43-208" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb43-209"><a href="#cb43-209" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlow <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb43-210"><a href="#cb43-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb43-211"><a href="#cb43-211" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb43-212"><a href="#cb43-212" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb43-213"><a href="#cb43-213" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb43-214"><a href="#cb43-214" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-215"><a href="#cb43-215" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-216"><a href="#cb43-216" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlow)){</span>
<span id="cb43-217"><a href="#cb43-217" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb43-218"><a href="#cb43-218" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[1, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb43-219"><a href="#cb43-219" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb43-220"><a href="#cb43-220" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co">#     ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb43-221"><a href="#cb43-221" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb43-222"><a href="#cb43-222" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb43-223"><a href="#cb43-223" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb43-224"><a href="#cb43-224" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[2, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb43-225"><a href="#cb43-225" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb43-226"><a href="#cb43-226" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb43-227"><a href="#cb43-227" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb43-228"><a href="#cb43-228" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb43-229"><a href="#cb43-229" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-230"><a href="#cb43-230" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb43-231"><a href="#cb43-231" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[3, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb43-232"><a href="#cb43-232" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb43-233"><a href="#cb43-233" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb43-234"><a href="#cb43-234" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb43-235"><a href="#cb43-235" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb43-236"><a href="#cb43-236" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-237"><a href="#cb43-237" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-238"><a href="#cb43-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-239"><a href="#cb43-239" aria-hidden="true" tabindex="-1"></a>  predictorsAll <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb43-240"><a href="#cb43-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb43-241"><a href="#cb43-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb43-242"><a href="#cb43-242" aria-hidden="true" tabindex="-1"></a>    <span class="at">cohort =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nCohorts,</span>
<span id="cb43-243"><a href="#cb43-243" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb43-244"><a href="#cb43-244" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb43-245"><a href="#cb43-245" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb43-246"><a href="#cb43-246" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-247"><a href="#cb43-247" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-248"><a href="#cb43-248" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsAll <span class="sc">%&gt;%</span></span>
<span id="cb43-249"><a href="#cb43-249" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaInt) <span class="sc">%&gt;%</span></span>
<span id="cb43-250"><a href="#cb43-250" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaFlow) <span class="sc">%&gt;%</span></span>
<span id="cb43-251"><a href="#cb43-251" aria-hidden="true" tabindex="-1"></a> <span class="co">#   left_join(predictorsBetaPhi) %&gt;%</span></span>
<span id="cb43-252"><a href="#cb43-252" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaInt <span class="sc">+</span> betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb43-253"><a href="#cb43-253" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-254"><a href="#cb43-254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb43-255"><a href="#cb43-255" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-256"><a href="#cb43-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-257"><a href="#cb43-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-258"><a href="#cb43-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-259"><a href="#cb43-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-262"><a href="#cb43-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-263"><a href="#cb43-263" aria-hidden="true" tabindex="-1"></a>getPredictions_FlowYOYSeason <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb43-264"><a href="#cb43-264" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-265"><a href="#cb43-265" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb43-266"><a href="#cb43-266" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaInt</span></span>
<span id="cb43-267"><a href="#cb43-267" aria-hidden="true" tabindex="-1"></a>  predictorsBetaInt <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb43-268"><a href="#cb43-268" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb43-269"><a href="#cb43-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb43-270"><a href="#cb43-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb43-271"><a href="#cb43-271" aria-hidden="true" tabindex="-1"></a><span class="co">#    cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb43-272"><a href="#cb43-272" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-273"><a href="#cb43-273" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-274"><a href="#cb43-274" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaInt)){</span>
<span id="cb43-275"><a href="#cb43-275" aria-hidden="true" tabindex="-1"></a>    predictorsBetaInt<span class="sc">$</span>betaInt[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaInt[i, <span class="st">"iter"</span>], </span>
<span id="cb43-276"><a href="#cb43-276" aria-hidden="true" tabindex="-1"></a>                                                 <span class="fu">paste0</span>(<span class="st">"betaIntYOYSeason["</span>, predictorsBetaInt[i, <span class="st">"isYOY"</span>],</span>
<span id="cb43-277"><a href="#cb43-277" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">", "</span>,       predictorsBetaInt[i, <span class="st">"season"</span>],</span>
<span id="cb43-278"><a href="#cb43-278" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#      ", ",       predictorsBetaInt[i, "cohort"],</span></span>
<span id="cb43-279"><a href="#cb43-279" aria-hidden="true" tabindex="-1"></a>                                                        <span class="st">"]"</span>)</span>
<span id="cb43-280"><a href="#cb43-280" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb43-281"><a href="#cb43-281" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-282"><a href="#cb43-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-283"><a href="#cb43-283" aria-hidden="true" tabindex="-1"></a><span class="co">#   ## betaPhi</span></span>
<span id="cb43-284"><a href="#cb43-284" aria-hidden="true" tabindex="-1"></a><span class="co">#   predictorsBetaPhi &lt;- expand.grid(</span></span>
<span id="cb43-285"><a href="#cb43-285" aria-hidden="true" tabindex="-1"></a><span class="co">#     iter = seq(1, dim(mcmc$chain1)[1], everyNIters),</span></span>
<span id="cb43-286"><a href="#cb43-286" aria-hidden="true" tabindex="-1"></a><span class="co">#     isYOY = 1:2,</span></span>
<span id="cb43-287"><a href="#cb43-287" aria-hidden="true" tabindex="-1"></a><span class="co">#     season = 1:toSave$myConstants$nSeasons</span></span>
<span id="cb43-288"><a href="#cb43-288" aria-hidden="true" tabindex="-1"></a><span class="co"># #    cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb43-289"><a href="#cb43-289" aria-hidden="true" tabindex="-1"></a><span class="co">#   )</span></span>
<span id="cb43-290"><a href="#cb43-290" aria-hidden="true" tabindex="-1"></a><span class="co">#   </span></span>
<span id="cb43-291"><a href="#cb43-291" aria-hidden="true" tabindex="-1"></a><span class="co">#   for(i in 1:nrow(predictorsBetaPhi)){</span></span>
<span id="cb43-292"><a href="#cb43-292" aria-hidden="true" tabindex="-1"></a><span class="co">#     predictorsBetaPhi$betaPhi[i] &lt;- mcmc$chain1[[predictorsBetaPhi[i, "iter"], </span></span>
<span id="cb43-293"><a href="#cb43-293" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                  paste0("betaPhiYOYSeason[", predictorsBetaPhi[i, "isYOY"],</span></span>
<span id="cb43-294"><a href="#cb43-294" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         ", ",       predictorsBetaPhi[i, "season"],</span></span>
<span id="cb43-295"><a href="#cb43-295" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                   #      ", ",       predictorsBetaPhi[i, "cohort"],</span></span>
<span id="cb43-296"><a href="#cb43-296" aria-hidden="true" tabindex="-1"></a><span class="co">#                                                         "]")</span></span>
<span id="cb43-297"><a href="#cb43-297" aria-hidden="true" tabindex="-1"></a><span class="co">#     ]]</span></span>
<span id="cb43-298"><a href="#cb43-298" aria-hidden="true" tabindex="-1"></a><span class="co">#   }</span></span>
<span id="cb43-299"><a href="#cb43-299" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-300"><a href="#cb43-300" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb43-301"><a href="#cb43-301" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlow <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb43-302"><a href="#cb43-302" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb43-303"><a href="#cb43-303" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb43-304"><a href="#cb43-304" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons</span>
<span id="cb43-305"><a href="#cb43-305" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  cohort = 1:toSave$myConstants$nCohorts</span></span>
<span id="cb43-306"><a href="#cb43-306" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-307"><a href="#cb43-307" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-308"><a href="#cb43-308" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlow)){</span>
<span id="cb43-309"><a href="#cb43-309" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb43-310"><a href="#cb43-310" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[1, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb43-311"><a href="#cb43-311" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb43-312"><a href="#cb43-312" aria-hidden="true" tabindex="-1"></a>                                                      <span class="co">#     ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb43-313"><a href="#cb43-313" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb43-314"><a href="#cb43-314" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb43-315"><a href="#cb43-315" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb43-316"><a href="#cb43-316" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[2, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb43-317"><a href="#cb43-317" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb43-318"><a href="#cb43-318" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb43-319"><a href="#cb43-319" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb43-320"><a href="#cb43-320" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb43-321"><a href="#cb43-321" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb43-322"><a href="#cb43-322" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlow<span class="sc">$</span>betaFlow3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlow[i, <span class="st">"iter"</span>], </span>
<span id="cb43-323"><a href="#cb43-323" aria-hidden="true" tabindex="-1"></a>                                                    <span class="fu">paste0</span>(<span class="st">"betaFlow[3, "</span>, predictorsBetaFlow[i, <span class="st">"isYOY"</span>],</span>
<span id="cb43-324"><a href="#cb43-324" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">", "</span>,           predictorsBetaFlow[i, <span class="st">"season"</span>],</span>
<span id="cb43-325"><a href="#cb43-325" aria-hidden="true" tabindex="-1"></a>                                                  <span class="co">#         ", ",           predictorsBetaFlow[i, "cohort"],</span></span>
<span id="cb43-326"><a href="#cb43-326" aria-hidden="true" tabindex="-1"></a>                                                           <span class="st">"]"</span>)</span>
<span id="cb43-327"><a href="#cb43-327" aria-hidden="true" tabindex="-1"></a>    ]]</span>
<span id="cb43-328"><a href="#cb43-328" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-329"><a href="#cb43-329" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-330"><a href="#cb43-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-331"><a href="#cb43-331" aria-hidden="true" tabindex="-1"></a>  predictorsAll <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb43-332"><a href="#cb43-332" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb43-333"><a href="#cb43-333" aria-hidden="true" tabindex="-1"></a>    <span class="at">isYOY =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb43-334"><a href="#cb43-334" aria-hidden="true" tabindex="-1"></a>   <span class="co"># cohort = 1:toSave$myConstants$nCohorts,</span></span>
<span id="cb43-335"><a href="#cb43-335" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="dv">1</span><span class="sc">:</span>toSave<span class="sc">$</span>myConstants<span class="sc">$</span>nSeasons,</span>
<span id="cb43-336"><a href="#cb43-336" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb43-337"><a href="#cb43-337" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb43-338"><a href="#cb43-338" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-339"><a href="#cb43-339" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-340"><a href="#cb43-340" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsAll <span class="sc">%&gt;%</span></span>
<span id="cb43-341"><a href="#cb43-341" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaInt) <span class="sc">%&gt;%</span></span>
<span id="cb43-342"><a href="#cb43-342" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(predictorsBetaFlow) <span class="sc">%&gt;%</span></span>
<span id="cb43-343"><a href="#cb43-343" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  left_join(predictorsBetaPhi) %&gt;%</span></span>
<span id="cb43-344"><a href="#cb43-344" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaInt <span class="sc">+</span> betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb43-345"><a href="#cb43-345" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-346"><a href="#cb43-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb43-347"><a href="#cb43-347" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-348"><a href="#cb43-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-349"><a href="#cb43-349" aria-hidden="true" tabindex="-1"></a>################################</span>
<span id="cb43-350"><a href="#cb43-350" aria-hidden="true" tabindex="-1"></a><span class="fu">### Flow_YOYSeason predictions</span></span>
<span id="cb43-353"><a href="#cb43-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-354"><a href="#cb43-354" aria-hidden="true" tabindex="-1"></a>predFlowYOYSeason <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeason</span>(out_flow, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-355"><a href="#cb43-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) </span>
<span id="cb43-356"><a href="#cb43-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-357"><a href="#cb43-357" aria-hidden="true" tabindex="-1"></a>predFlowByRiverYOYSeason <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeason</span>(out_flowByRiver, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-358"><a href="#cb43-358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>)</span>
<span id="cb43-359"><a href="#cb43-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-360"><a href="#cb43-360" aria-hidden="true" tabindex="-1"></a>predBoth <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(predFlowYOYSeason, predFlowByRiverYOYSeason)</span>
<span id="cb43-361"><a href="#cb43-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-362"><a href="#cb43-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-363"><a href="#cb43-363" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Graph flow predictions  </span></span>
<span id="cb43-364"><a href="#cb43-364" aria-hidden="true" tabindex="-1"></a>Predictions based on flow from the flow extension curve - original approach</span>
<span id="cb43-367"><a href="#cb43-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-368"><a href="#cb43-368" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb43-369"><a href="#cb43-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-370"><a href="#cb43-370" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb43-371"><a href="#cb43-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb43-372"><a href="#cb43-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb43-373"><a href="#cb43-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span>
<span id="cb43-374"><a href="#cb43-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-375"><a href="#cb43-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-376"><a href="#cb43-376" aria-hidden="true" tabindex="-1"></a>Predictions based on flow from flowByRiver</span>
<span id="cb43-379"><a href="#cb43-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-380"><a href="#cb43-380" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowByRiverYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb43-381"><a href="#cb43-381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb43-382"><a href="#cb43-382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb43-383"><a href="#cb43-383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span>
<span id="cb43-384"><a href="#cb43-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-385"><a href="#cb43-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-386"><a href="#cb43-386" aria-hidden="true" tabindex="-1"></a>Similar format to to the 2015 paper</span>
<span id="cb43-389"><a href="#cb43-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-390"><a href="#cb43-390" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeason <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flow <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(temp, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,flow, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb43-391"><a href="#cb43-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(flow)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb43-392"><a href="#cb43-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb43-393"><a href="#cb43-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span>
<span id="cb43-394"><a href="#cb43-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-395"><a href="#cb43-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-396"><a href="#cb43-396" aria-hidden="true" tabindex="-1"></a>####################################</span>
<span id="cb43-397"><a href="#cb43-397" aria-hidden="true" tabindex="-1"></a><span class="fu">### Flow_YOYSeasonCohort predictions</span></span>
<span id="cb43-400"><a href="#cb43-400" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-401"><a href="#cb43-401" aria-hidden="true" tabindex="-1"></a>predFlowYOYSeasonCohort <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeasonCohort</span>(out_flow, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-402"><a href="#cb43-402" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flow"</span>) </span>
<span id="cb43-403"><a href="#cb43-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-404"><a href="#cb43-404" aria-hidden="true" tabindex="-1"></a>predFlowByRiverYOYSeasonCohort <span class="ot">&lt;-</span> <span class="fu">getPredictions_FlowYOYSeasonCohort</span>(out_flowByRiver, <span class="at">everyNIters =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-405"><a href="#cb43-405" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">flowData =</span> <span class="st">"flowByRiver"</span>)</span>
<span id="cb43-406"><a href="#cb43-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-407"><a href="#cb43-407" aria-hidden="true" tabindex="-1"></a>predBoth <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(predFlowYOYSeasonCohort, predFlowByRiverYOYSeasonCohort)</span>
<span id="cb43-408"><a href="#cb43-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-409"><a href="#cb43-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-410"><a href="#cb43-410" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Graph flow predictions  </span></span>
<span id="cb43-411"><a href="#cb43-411" aria-hidden="true" tabindex="-1"></a>Predictions based on flow from the flow extension curve - original approach</span>
<span id="cb43-414"><a href="#cb43-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-415"><a href="#cb43-415" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>)</span>
<span id="cb43-416"><a href="#cb43-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-417"><a href="#cb43-417" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb43-418"><a href="#cb43-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb43-419"><a href="#cb43-419" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb43-420"><a href="#cb43-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY <span class="sc">+</span> cohort)</span>
<span id="cb43-421"><a href="#cb43-421" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-422"><a href="#cb43-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-423"><a href="#cb43-423" aria-hidden="true" tabindex="-1"></a>Predictions based on flow from flowByRiver</span>
<span id="cb43-426"><a href="#cb43-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-427"><a href="#cb43-427" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowByRiverYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(flow, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,temp,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb43-428"><a href="#cb43-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(temp)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb43-429"><a href="#cb43-429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb43-430"><a href="#cb43-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY <span class="sc">+</span> cohort)</span>
<span id="cb43-431"><a href="#cb43-431" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-432"><a href="#cb43-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-433"><a href="#cb43-433" aria-hidden="true" tabindex="-1"></a>Similar format to to the 2015 paper</span>
<span id="cb43-436"><a href="#cb43-436" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-437"><a href="#cb43-437" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(predFlowYOYSeasonCohort <span class="sc">%&gt;%</span> <span class="fu">filter</span>(flow <span class="sc">%in%</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">aes</span>(temp, predPhi, <span class="at">group =</span> ((<span class="fu">paste0</span>(iter,flow,cohort, <span class="at">sep =</span> <span class="st">"_"</span>))))) <span class="sc">+</span></span>
<span id="cb43-438"><a href="#cb43-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(flow)), <span class="at">alpha =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb43-439"><a href="#cb43-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> colors) <span class="sc">+</span></span>
<span id="cb43-440"><a href="#cb43-440" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(season <span class="sc">~</span> isYOY)</span>
<span id="cb43-441"><a href="#cb43-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-442"><a href="#cb43-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-443"><a href="#cb43-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-444"><a href="#cb43-444" aria-hidden="true" tabindex="-1"></a>#####################################</span>
<span id="cb43-445"><a href="#cb43-445" aria-hidden="true" tabindex="-1"></a><span class="fu">#### FlowTop predictions</span></span>
<span id="cb43-448"><a href="#cb43-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-449"><a href="#cb43-449" aria-hidden="true" tabindex="-1"></a><span class="co"># predFlowTop &lt;- getPredictionsFlowTop(out_flow, everyNIters = 5) %&gt;%</span></span>
<span id="cb43-450"><a href="#cb43-450" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(flowData = "flow") </span></span>
<span id="cb43-451"><a href="#cb43-451" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb43-452"><a href="#cb43-452" aria-hidden="true" tabindex="-1"></a><span class="co"># predFlowByRiverTop &lt;- getPredictionsFlowTop(out_flowByRiver, everyNIters = 5) %&gt;%</span></span>
<span id="cb43-453"><a href="#cb43-453" aria-hidden="true" tabindex="-1"></a><span class="co">#     mutate(flowData = "flowByRiver")</span></span>
<span id="cb43-454"><a href="#cb43-454" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb43-455"><a href="#cb43-455" aria-hidden="true" tabindex="-1"></a><span class="co"># predTopBoth &lt;- bind_rows(predFlowTop, predFlowByRiverTop)</span></span>
<span id="cb43-456"><a href="#cb43-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-457"><a href="#cb43-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-460"><a href="#cb43-460" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-461"><a href="#cb43-461" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(predTopBoth, aes(flow, predPhi, group = iter)) +</span></span>
<span id="cb43-462"><a href="#cb43-462" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb43-463"><a href="#cb43-463" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_wrap(~flowData)</span></span>
<span id="cb43-464"><a href="#cb43-464" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb43-465"><a href="#cb43-465" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(predTopBoth %&gt;% filter(iter &lt; 100), aes(flow, predPhi, group = iter)) +</span></span>
<span id="cb43-466"><a href="#cb43-466" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line() +</span></span>
<span id="cb43-467"><a href="#cb43-467" aria-hidden="true" tabindex="-1"></a><span class="co">#   facet_grid(flowData ~ iter)</span></span>
<span id="cb43-468"><a href="#cb43-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb43-469"><a href="#cb43-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-470"><a href="#cb43-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-473"><a href="#cb43-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb43-474"><a href="#cb43-474" aria-hidden="true" tabindex="-1"></a>getPredictionsFlowTop <span class="ot">&lt;-</span> <span class="cf">function</span>(toSave, <span class="at">everyNIters =</span> <span class="dv">10</span>, <span class="at">flowStep =</span> <span class="fl">0.5</span>){</span>
<span id="cb43-475"><a href="#cb43-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-476"><a href="#cb43-476" aria-hidden="true" tabindex="-1"></a>  mcmc <span class="ot">&lt;-</span> toSave<span class="sc">$</span>mcmc</span>
<span id="cb43-477"><a href="#cb43-477" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-478"><a href="#cb43-478" aria-hidden="true" tabindex="-1"></a>  <span class="do">## betaFlow</span></span>
<span id="cb43-479"><a href="#cb43-479" aria-hidden="true" tabindex="-1"></a>  predictorsBetaFlowTop <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb43-480"><a href="#cb43-480" aria-hidden="true" tabindex="-1"></a>    <span class="at">iter =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">dim</span>(mcmc<span class="sc">$</span>chain1)[<span class="dv">1</span>], everyNIters),</span>
<span id="cb43-481"><a href="#cb43-481" aria-hidden="true" tabindex="-1"></a>    <span class="at">var =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,</span>
<span id="cb43-482"><a href="#cb43-482" aria-hidden="true" tabindex="-1"></a>    <span class="at">flow =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep),</span>
<span id="cb43-483"><a href="#cb43-483" aria-hidden="true" tabindex="-1"></a>    <span class="at">temp =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>, flowStep)</span>
<span id="cb43-484"><a href="#cb43-484" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-485"><a href="#cb43-485" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-486"><a href="#cb43-486" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(predictorsBetaFlowTop)){</span>
<span id="cb43-487"><a href="#cb43-487" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop1[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb43-488"><a href="#cb43-488" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">1</span></span>
<span id="cb43-489"><a href="#cb43-489" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb43-490"><a href="#cb43-490" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop2[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb43-491"><a href="#cb43-491" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">2</span></span>
<span id="cb43-492"><a href="#cb43-492" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb43-493"><a href="#cb43-493" aria-hidden="true" tabindex="-1"></a>    predictorsBetaFlowTop<span class="sc">$</span>betaFlowTop3[i] <span class="ot">&lt;-</span> mcmc<span class="sc">$</span>chain1[[predictorsBetaFlowTop[i, <span class="st">"iter"</span>], </span>
<span id="cb43-494"><a href="#cb43-494" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">3</span></span>
<span id="cb43-495"><a href="#cb43-495" aria-hidden="true" tabindex="-1"></a>                                                        ]]</span>
<span id="cb43-496"><a href="#cb43-496" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb43-497"><a href="#cb43-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-498"><a href="#cb43-498" aria-hidden="true" tabindex="-1"></a>  preds <span class="ot">&lt;-</span> predictorsBetaFlowTop <span class="sc">%&gt;%</span></span>
<span id="cb43-499"><a href="#cb43-499" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">predPhi =</span> <span class="fu">plogis</span>(betaFlow1 <span class="sc">*</span> flow <span class="sc">+</span> betaFlow2 <span class="sc">*</span> temp <span class="sc">+</span> betaFlow3 <span class="sc">*</span> flow <span class="sc">*</span> temp))</span>
<span id="cb43-500"><a href="#cb43-500" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb43-501"><a href="#cb43-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(preds)</span>
<span id="cb43-502"><a href="#cb43-502" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb43-503"><a href="#cb43-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-504"><a href="#cb43-504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>